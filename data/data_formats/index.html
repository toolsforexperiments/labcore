
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://toolsforexperiments.github.io./data/data_formats/">
      
      
        <link rel="prev" href="../../measurement/sweep/">
      
      
        <link rel="next" href="../../examples/Intro%20to%20our%20Holoviz%20apps/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.6">
    
    
      
        <title>Data Formats - Labcore documentation page.</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.35e1ed30.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#data-formats" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Labcore documentation page." class="md-header__button md-logo" aria-label="Labcore documentation page." data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Labcore documentation page.
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Data Formats
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../instruments/instrumentserver/" class="md-tabs__link">
          
  
  Instruments

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../measurement/sweep/" class="md-tabs__link">
          
  
  Measurement

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
  Data

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../examples/Intro%20to%20our%20Holoviz%20apps/" class="md-tabs__link">
          
  
  Examples

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../about/" class="md-tabs__link">
        
  
    
  
  About

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Labcore documentation page." class="md-nav__button md-logo" aria-label="Labcore documentation page." data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Labcore documentation page.
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Instruments
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Instruments
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../instruments/instrumentserver/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Instrumentserver
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../instruments/instrumentmonitoring/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Instrument Monitoring
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../instruments/qcodes_instruments/instruments/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Our QCoDeS drivers
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Measurement
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Measurement
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../measurement/sweep/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sweeping
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Data
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Data
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Data Formats
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Data Formats
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#in-memory-data" class="md-nav__link">
    In-memory Data
  </a>
  
    <nav class="md-nav" aria-label="In-memory Data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-concepts" class="md-nav__link">
    Basic Concepts
  </a>
  
    <nav class="md-nav" aria-label="Basic Concepts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#relevant-data-classes" class="md-nav__link">
    Relevant Data Classes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datadict" class="md-nav__link">
    Datadict
  </a>
  
    <nav class="md-nav" aria-label="Datadict">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-use" class="md-nav__link">
    Basic Use
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure" class="md-nav__link">
    Structure
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#populating-the-datadict" class="md-nav__link">
    Populating the DataDict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#meta-data" class="md-nav__link">
    Meta Data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#meshgrid-datadict" class="md-nav__link">
    Meshgrid DataDict
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datadict-storage" class="md-nav__link">
    DataDict Storage
  </a>
  
    <nav class="md-nav" aria-label="DataDict Storage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description-of-the-hdf5-storage-format" class="md-nav__link">
    Description of the HDF5 Storage Format
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#working-with-ddh5-files" class="md-nav__link">
    Working With DDH5 Files
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ddh5-writer" class="md-nav__link">
    DDH5 Writer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change-file-extension-and-time-format" class="md-nav__link">
    Change File Extension and Time Format
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reference" class="md-nav__link">
    Reference
  </a>
  
    <nav class="md-nav" aria-label="Reference">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datadict_1" class="md-nav__link">
    Datadict
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict" class="md-nav__link">
    datadict
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDict" class="md-nav__link">
    DataDict
  </a>
  
    <nav class="md-nav" aria-label="DataDict">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDict.__add__" class="md-nav__link">
    __add__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDict.add_data" class="md-nav__link">
    add_data()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDict.append" class="md-nav__link">
    append()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDict.expand" class="md-nav__link">
    expand()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDict.is_expandable" class="md-nav__link">
    is_expandable()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDict.is_expanded" class="md-nav__link">
    is_expanded()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDict.nrecords" class="md-nav__link">
    nrecords()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDict.remove_invalid_entries" class="md-nav__link">
    remove_invalid_entries()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDict.sanitize" class="md-nav__link">
    sanitize()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDict.validate" class="md-nav__link">
    validate()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase" class="md-nav__link">
    DataDictBase
  </a>
  
    <nav class="md-nav" aria-label="DataDictBase">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.__eq__" class="md-nav__link">
    __eq__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.add_meta" class="md-nav__link">
    add_meta()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.astype" class="md-nav__link">
    astype()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.axes" class="md-nav__link">
    axes()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.axes_are_compatible" class="md-nav__link">
    axes_are_compatible()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.clear_meta" class="md-nav__link">
    clear_meta()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.copy" class="md-nav__link">
    copy()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.data_items" class="md-nav__link">
    data_items()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.data_vals" class="md-nav__link">
    data_vals()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.delete_meta" class="md-nav__link">
    delete_meta()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.dependents" class="md-nav__link">
    dependents()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.extract" class="md-nav__link">
    extract()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.has_meta" class="md-nav__link">
    has_meta()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.label" class="md-nav__link">
    label()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.mask_invalid" class="md-nav__link">
    mask_invalid()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.meta_items" class="md-nav__link">
    meta_items()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.meta_val" class="md-nav__link">
    meta_val()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.nbytes" class="md-nav__link">
    nbytes()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.remove_unused_axes" class="md-nav__link">
    remove_unused_axes()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.reorder_axes" class="md-nav__link">
    reorder_axes()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.reorder_axes_indices" class="md-nav__link">
    reorder_axes_indices()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.same_structure" class="md-nav__link">
    same_structure()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.sanitize" class="md-nav__link">
    sanitize()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.shapes" class="md-nav__link">
    shapes()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.structure" class="md-nav__link">
    structure()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.to_records" class="md-nav__link">
    to_records()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.validate" class="md-nav__link">
    validate()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict.MeshgridDataDict" class="md-nav__link">
    MeshgridDataDict
  </a>
  
    <nav class="md-nav" aria-label="MeshgridDataDict">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.MeshgridDataDict.mean" class="md-nav__link">
    mean()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.MeshgridDataDict.reorder_axes" class="md-nav__link">
    reorder_axes()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.MeshgridDataDict.shape" class="md-nav__link">
    shape()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.MeshgridDataDict.slice" class="md-nav__link">
    slice()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.MeshgridDataDict.squeeze" class="md-nav__link">
    squeeze()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.MeshgridDataDict.validate" class="md-nav__link">
    validate()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict.combine_datadicts" class="md-nav__link">
    combine_datadicts()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict.datadict_to_meshgrid" class="md-nav__link">
    datadict_to_meshgrid()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict.datasets_are_equal" class="md-nav__link">
    datasets_are_equal()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict.datastructure_from_string" class="md-nav__link">
    datastructure_from_string()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict.dd2df" class="md-nav__link">
    dd2df()
  </a>
  
    <nav class="md-nav" aria-label="dd2df()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.dd2df--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.dd2df--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict.dd2xr" class="md-nav__link">
    dd2xr()
  </a>
  
    <nav class="md-nav" aria-label="dd2xr()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.dd2xr--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.dd2xr--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict.guess_shape_from_datadict" class="md-nav__link">
    guess_shape_from_datadict()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict.is_meta_key" class="md-nav__link">
    is_meta_key()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict.meshgrid_to_datadict" class="md-nav__link">
    meshgrid_to_datadict()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict.meta_key_to_name" class="md-nav__link">
    meta_key_to_name()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict.meta_name_to_key" class="md-nav__link">
    meta_name_to_key()
  </a>
  
    <nav class="md-nav" aria-label="meta_name_to_key()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datadict-storage_1" class="md-nav__link">
    Datadict Storage
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict_storage" class="md-nav__link">
    datadict_storage
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict_storage.AppendMode" class="md-nav__link">
    AppendMode
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict_storage.DDH5Writer" class="md-nav__link">
    DDH5Writer
  </a>
  
    <nav class="md-nav" aria-label="DDH5Writer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict_storage.DDH5Writer.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict_storage.DDH5Writer.add_data" class="md-nav__link">
    add_data()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict_storage.DDH5Writer.data_file_path" class="md-nav__link">
    data_file_path()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict_storage.DDH5Writer.data_folder" class="md-nav__link">
    data_folder()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict_storage.FileOpener" class="md-nav__link">
    FileOpener
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict_storage.add_cur_time_attr" class="md-nav__link">
    add_cur_time_attr()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict_storage.all_datadicts_from_hdf5" class="md-nav__link">
    all_datadicts_from_hdf5()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict_storage.datadict_from_hdf5" class="md-nav__link">
    datadict_from_hdf5()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict_storage.datadict_to_hdf5" class="md-nav__link">
    datadict_to_hdf5()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict_storage.deh5ify" class="md-nav__link">
    deh5ify()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict_storage.h5ify" class="md-nav__link">
    h5ify()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict_storage.load_as_xr" class="md-nav__link">
    load_as_xr()
  </a>
  
    <nav class="md-nav" aria-label="load_as_xr()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict_storage.load_as_xr--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict_storage.load_as_xr--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict_storage.reconstruct_safe_write_data" class="md-nav__link">
    reconstruct_safe_write_data()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict_storage.set_attr" class="md-nav__link">
    set_attr()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict_storage.timestamp_from_path" class="md-nav__link">
    timestamp_from_path()
  </a>
  
    <nav class="md-nav" aria-label="timestamp_from_path()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#extra-tools" class="md-nav__link">
    Extra Tools
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.tools" class="md-nav__link">
    tools
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.tools.Data" class="md-nav__link">
    Data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.tools.split_complex" class="md-nav__link">
    split_complex()
  </a>
  
    <nav class="md-nav" aria-label="split_complex()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#labcore.data.tools.split_complex--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.tools.split_complex--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.tools.split_complex--raises" class="md-nav__link">
    Raises
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/Intro%20to%20our%20Holoviz%20apps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intro to our Holoviz apps
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/Holoviz-based%20plotting%20in%20the%20lab%20-%20Primer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Holoviz-based plotting in the lab - Primer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/hvplot_visualization_guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pretty hvplot and exporting
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#in-memory-data" class="md-nav__link">
    In-memory Data
  </a>
  
    <nav class="md-nav" aria-label="In-memory Data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-concepts" class="md-nav__link">
    Basic Concepts
  </a>
  
    <nav class="md-nav" aria-label="Basic Concepts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#relevant-data-classes" class="md-nav__link">
    Relevant Data Classes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datadict" class="md-nav__link">
    Datadict
  </a>
  
    <nav class="md-nav" aria-label="Datadict">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-use" class="md-nav__link">
    Basic Use
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure" class="md-nav__link">
    Structure
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#populating-the-datadict" class="md-nav__link">
    Populating the DataDict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#meta-data" class="md-nav__link">
    Meta Data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#meshgrid-datadict" class="md-nav__link">
    Meshgrid DataDict
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datadict-storage" class="md-nav__link">
    DataDict Storage
  </a>
  
    <nav class="md-nav" aria-label="DataDict Storage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description-of-the-hdf5-storage-format" class="md-nav__link">
    Description of the HDF5 Storage Format
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#working-with-ddh5-files" class="md-nav__link">
    Working With DDH5 Files
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ddh5-writer" class="md-nav__link">
    DDH5 Writer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change-file-extension-and-time-format" class="md-nav__link">
    Change File Extension and Time Format
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reference" class="md-nav__link">
    Reference
  </a>
  
    <nav class="md-nav" aria-label="Reference">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datadict_1" class="md-nav__link">
    Datadict
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict" class="md-nav__link">
    datadict
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDict" class="md-nav__link">
    DataDict
  </a>
  
    <nav class="md-nav" aria-label="DataDict">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDict.__add__" class="md-nav__link">
    __add__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDict.add_data" class="md-nav__link">
    add_data()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDict.append" class="md-nav__link">
    append()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDict.expand" class="md-nav__link">
    expand()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDict.is_expandable" class="md-nav__link">
    is_expandable()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDict.is_expanded" class="md-nav__link">
    is_expanded()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDict.nrecords" class="md-nav__link">
    nrecords()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDict.remove_invalid_entries" class="md-nav__link">
    remove_invalid_entries()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDict.sanitize" class="md-nav__link">
    sanitize()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDict.validate" class="md-nav__link">
    validate()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase" class="md-nav__link">
    DataDictBase
  </a>
  
    <nav class="md-nav" aria-label="DataDictBase">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.__eq__" class="md-nav__link">
    __eq__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.add_meta" class="md-nav__link">
    add_meta()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.astype" class="md-nav__link">
    astype()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.axes" class="md-nav__link">
    axes()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.axes_are_compatible" class="md-nav__link">
    axes_are_compatible()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.clear_meta" class="md-nav__link">
    clear_meta()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.copy" class="md-nav__link">
    copy()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.data_items" class="md-nav__link">
    data_items()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.data_vals" class="md-nav__link">
    data_vals()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.delete_meta" class="md-nav__link">
    delete_meta()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.dependents" class="md-nav__link">
    dependents()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.extract" class="md-nav__link">
    extract()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.has_meta" class="md-nav__link">
    has_meta()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.label" class="md-nav__link">
    label()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.mask_invalid" class="md-nav__link">
    mask_invalid()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.meta_items" class="md-nav__link">
    meta_items()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.meta_val" class="md-nav__link">
    meta_val()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.nbytes" class="md-nav__link">
    nbytes()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.remove_unused_axes" class="md-nav__link">
    remove_unused_axes()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.reorder_axes" class="md-nav__link">
    reorder_axes()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.reorder_axes_indices" class="md-nav__link">
    reorder_axes_indices()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.same_structure" class="md-nav__link">
    same_structure()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.sanitize" class="md-nav__link">
    sanitize()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.shapes" class="md-nav__link">
    shapes()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.structure" class="md-nav__link">
    structure()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.to_records" class="md-nav__link">
    to_records()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.DataDictBase.validate" class="md-nav__link">
    validate()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict.MeshgridDataDict" class="md-nav__link">
    MeshgridDataDict
  </a>
  
    <nav class="md-nav" aria-label="MeshgridDataDict">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.MeshgridDataDict.mean" class="md-nav__link">
    mean()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.MeshgridDataDict.reorder_axes" class="md-nav__link">
    reorder_axes()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.MeshgridDataDict.shape" class="md-nav__link">
    shape()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.MeshgridDataDict.slice" class="md-nav__link">
    slice()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.MeshgridDataDict.squeeze" class="md-nav__link">
    squeeze()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.MeshgridDataDict.validate" class="md-nav__link">
    validate()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict.combine_datadicts" class="md-nav__link">
    combine_datadicts()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict.datadict_to_meshgrid" class="md-nav__link">
    datadict_to_meshgrid()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict.datasets_are_equal" class="md-nav__link">
    datasets_are_equal()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict.datastructure_from_string" class="md-nav__link">
    datastructure_from_string()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict.dd2df" class="md-nav__link">
    dd2df()
  </a>
  
    <nav class="md-nav" aria-label="dd2df()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.dd2df--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.dd2df--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict.dd2xr" class="md-nav__link">
    dd2xr()
  </a>
  
    <nav class="md-nav" aria-label="dd2xr()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.dd2xr--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict.dd2xr--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict.guess_shape_from_datadict" class="md-nav__link">
    guess_shape_from_datadict()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict.is_meta_key" class="md-nav__link">
    is_meta_key()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict.meshgrid_to_datadict" class="md-nav__link">
    meshgrid_to_datadict()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict.meta_key_to_name" class="md-nav__link">
    meta_key_to_name()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict.meta_name_to_key" class="md-nav__link">
    meta_name_to_key()
  </a>
  
    <nav class="md-nav" aria-label="meta_name_to_key()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datadict-storage_1" class="md-nav__link">
    Datadict Storage
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict_storage" class="md-nav__link">
    datadict_storage
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict_storage.AppendMode" class="md-nav__link">
    AppendMode
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict_storage.DDH5Writer" class="md-nav__link">
    DDH5Writer
  </a>
  
    <nav class="md-nav" aria-label="DDH5Writer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict_storage.DDH5Writer.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict_storage.DDH5Writer.add_data" class="md-nav__link">
    add_data()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict_storage.DDH5Writer.data_file_path" class="md-nav__link">
    data_file_path()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict_storage.DDH5Writer.data_folder" class="md-nav__link">
    data_folder()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict_storage.FileOpener" class="md-nav__link">
    FileOpener
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict_storage.add_cur_time_attr" class="md-nav__link">
    add_cur_time_attr()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict_storage.all_datadicts_from_hdf5" class="md-nav__link">
    all_datadicts_from_hdf5()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict_storage.datadict_from_hdf5" class="md-nav__link">
    datadict_from_hdf5()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict_storage.datadict_to_hdf5" class="md-nav__link">
    datadict_to_hdf5()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict_storage.deh5ify" class="md-nav__link">
    deh5ify()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict_storage.h5ify" class="md-nav__link">
    h5ify()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict_storage.load_as_xr" class="md-nav__link">
    load_as_xr()
  </a>
  
    <nav class="md-nav" aria-label="load_as_xr()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict_storage.load_as_xr--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.datadict_storage.load_as_xr--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict_storage.reconstruct_safe_write_data" class="md-nav__link">
    reconstruct_safe_write_data()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict_storage.set_attr" class="md-nav__link">
    set_attr()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.datadict_storage.timestamp_from_path" class="md-nav__link">
    timestamp_from_path()
  </a>
  
    <nav class="md-nav" aria-label="timestamp_from_path()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#extra-tools" class="md-nav__link">
    Extra Tools
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.tools" class="md-nav__link">
    tools
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.tools.Data" class="md-nav__link">
    Data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labcore.data.tools.split_complex" class="md-nav__link">
    split_complex()
  </a>
  
    <nav class="md-nav" aria-label="split_complex()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#labcore.data.tools.split_complex--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.tools.split_complex--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#labcore.data.tools.split_complex--raises" class="md-nav__link">
    Raises
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="data-formats">Data Formats</h1>
<h2 id="in-memory-data">In-memory Data</h2>
<h3 id="basic-concepts">Basic Concepts</h3>
<p>The main format we're using within plottr is the <a href="#labcore.data.datadict.DataDict"><code>DataDict</code></a>. While most of the actual numeric data will typically live in numpy arrays (or lists, or similar), they don't typically capture easily arbitrary metadata and relationships between arrays. Say, for example, we have some data <code>z</code> that depends on two other variables, <code>x</code> and <code>y</code>. This information has be stored somewhere, and numpy doesn't offer readily a solution here. There are various extensions, for example <a href="http://xarray.pydata.org">xarray</a> or the <a href="https://scipy-cookbook.readthedocs.io/items/MetaArray.html">MetaArray class</a>. Those however typically have a grid format in mind, which we do not want to impose. Instead, we use a wrapper around the python dictionary that contains all the required meta information to infer the relevant relationships, and that uses numpy arrays internally to store the numeric data. Additionally we can store any other arbitrary meta data.</p>
<p>A DataDict container (a <code>dataset</code>) can contain multiple <code>data fields</code> (or variables), that have values and can contain their own meta information. Importantly, we distinct between independent fields (the <code>axes</code>) and dependent fields (the <code>data</code>).</p>
<p>Despite the naming, <code>axes</code> is not meant to imply that the <code>data</code> have to have a certain shape (but the degree to which this is true depends on the class used). A list of classes for different shapes of data can be found below.</p>
<p>The basic structure of data conceptually looks like this (we inherit from <code>dict</code>):</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>{
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    &#39;data_1&#39; : {
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>        &#39;axes&#39; : [&#39;ax1&#39;, &#39;ax2&#39;],
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>        &#39;unit&#39; : &#39;some unit&#39;,
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>        &#39;values&#39; : [ ... ],
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>        &#39;__meta__&#39; : &#39;This is very important data&#39;,
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>        ...
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    },
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    &#39;ax1&#39; : {
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>        &#39;axes&#39; : [],
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>        &#39;unit&#39; : &#39;some other unit&#39;,
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>        &#39;values&#39; : [ ... ],
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>        ...,
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>    },
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>    &#39;ax2&#39; : {
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>        &#39;axes&#39; : [],
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>        &#39;unit&#39; : &#39;a third unit&#39;,
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>        &#39;values&#39; : [ ... ],
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>        ...,
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>    },
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>    &#39;__globalmeta__&#39; : &#39;some information about this data set&#39;,
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>    &#39;__moremeta__&#39; : 1234,
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>    ...
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>}
</code></pre></div>
<p>In this case we have one dependent variable, <code>data_1</code>, that depends on two axes, <code>ax1</code> and <code>ax2</code>. This concept is restricted only in the following way:</p>
<ul>
<li>A dependent can depend on any number of independents.</li>
<li>An independent cannot depend on other fields itself.</li>
<li>Any field that does not depend on another, is treated as an axis.</li>
</ul>
<p>Note that meta information is contained in entries whose keys start and end with double underscores. Both the DataDict itself, as well as each field can contain meta information.</p>
<p>In the most basic implementation, the only restriction on the data values is that they need to be contained in a sequence (typically as list, or numpy array), and that the length of all values in the data set (the number of <code>records</code>) must be equal. Note that this does not preclude nested sequences!</p>
<h4 id="relevant-data-classes">Relevant Data Classes</h4>
<p><strong>DataDictBase:</strong> 
The main base class. Only checks for correct dependencies. Any requirements on data structure is left to the inheriting classes. The class contains methods for easy access to data and metadata.</p>
<p><strong>DataDict:</strong>
The only requirement for valid data is that the number of records is the same for all data fields. Contains some tools for expansion of data.</p>
<p><strong>MeshgridDataDict:</strong> For data that lives on a grid (not necessarily regular).</p>
<h2 id="datadict">Datadict</h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Because DataDicts are <a href="https://docs.python.org/3/tutorial/datastructures.html#dictionaries">python dictionaries</a> , we highly recommend becoming familiar with them before utilizing DataDicts.</p>
</div>
<h3 id="basic-use">Basic Use</h3>
<p>We can start by creating an empty DataDict like any other python object:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">data_dict</span> <span class="o">=</span> <span class="n">DataDict</span><span class="p">()</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">data_dict</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="p">{}</span>
</code></pre></div>
<p>We can create the structure of the data_dict by creating dictionary items and populating them like a normal python dictionary:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">)</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">data_dict</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;m&#39;</span><span class="p">}}</span>
</code></pre></div>
<p>We can also start by creating a DataDict that has the structure of the data we are going to record:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">data_dict</span> <span class="o">=</span> <span class="n">DataDict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">),</span> <span class="n">z</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">]))</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">data_dict</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;m&#39;</span><span class="p">},</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;m&#39;</span><span class="p">},</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;axes&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">]}}</span>
</code></pre></div>
<p>The DataDict that we just created contains no data yet, only the structure and relationship of the data fields. We have also specified the unit of <code>x</code> and <code>y</code> and which variables are independent variables (<code>x</code>, <code>y</code>), or how we will call them from now on, <code>axes</code> and dependent variables (<code>z</code>), or, <code>dependents</code>.</p>
<h3 id="structure">Structure</h3>
<p>From the basic and empty DataDict we can already start to inspect its structure. To see the entire structure of a DataDict we can use the <a href="#labcore.data.datadict.DataDictBase.structure"><code>structure()</code></a> method:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">data_dict</span> <span class="o">=</span> <span class="n">DataDict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">),</span> <span class="n">z</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">]))</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">structure</span><span class="p">()</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;axes&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">},</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;axes&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">},</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;axes&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">}}</span>
</code></pre></div>
<p>We can check for specific things inside the DataDict. We can look at the axes:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">]</span>
</code></pre></div>
<p>We can look at all the dependents:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">dependents</span><span class="p">()</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">]</span>
</code></pre></div>
<p>We can also see the shape of a DataDict by using the <a href="#labcore.data.datadict.DataDictBase.shapes"><code>shapes()</code></a> method:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">shapes</span><span class="p">()</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,),</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,),</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,)}</span>
</code></pre></div>
<h3 id="populating-the-datadict">Populating the DataDict</h3>
<p>One of the only "restrictions" that DataDict implements is that every data field must have the same number of records (items). However, restrictions is in quotes because there is nothing that is stopping you from having different data fields have different number of records, this will only make the DataDict invalid. We will explore what his means later.</p>
<p>There are 2 different ways of safely populating a DataDict, adding data to it or appending 2 different DataDict to each other.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can always manually update the item <code>values</code> any data field like any other item of a python dictionary, however, populating the DataDict this way can result in an invalid DataDict if you are not being careful. Both population methods presented below contains checks to make sure that the new data being added will not create an invalid DataDict.</p>
</div>
<p>We can add data to an existing DataDict with the [<code>add_data()</code>(#labcore.data.datadict.DataDict.add_data) method:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">data_dict</span> <span class="o">=</span> <span class="n">DataDict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">),</span> <span class="n">z</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">]))</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">z</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">data_dict</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;axes&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])},</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;axes&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])},</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;axes&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">],</span>  <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>  <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>  <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">])}}</span>
</code></pre></div>
<p>We now have a populated DataDict. It is important to notice that this method will also add any of the missing special keys that a data field doesn't have (<code>values</code>, <code>axes</code>, <code>unit</code>, and <code>label</code>). Populating the DataDict with this method will also ensure that every item has the same number of records and the correct shape, either by adding <code>nan</code> to the other data fields or by nesting the data arrays so that the outer most dimension of every data field has the same number of records.</p>
<p>We can see this in action if we add a single record to a data field with items but no the rest:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="mi">9</span><span class="p">])</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">data_dict</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;axes&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">])},</span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;axes&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">,</span> <span class="n">nan</span><span class="p">])},</span>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;axes&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">4.</span><span class="p">,</span> <span class="n">nan</span><span class="p">])}}</span>
</code></pre></div>
<p>As we can see, both <code>y</code> and <code>z</code> have an extra <code>nan</code> record in them. We can observe the change of dimension if we do not add the same number of records to all data fields:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">data_dict</span> <span class="o">=</span> <span class="n">DataDict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">),</span> <span class="n">z</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">]))</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">z</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">data_dict</span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;axes&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])},</span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;axes&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])},</span>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;axes&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">])}}</span>
</code></pre></div>
<p>If we want to expand our DataDict by appending another one, we need to make sure that both of our DataDicts have the same inner structure. We can check that by utilizing the static method <a href="#labcore.data.datadict.DataDictBase.same_structure"><code>same_structure()</code></a>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">data_dict_1</span> <span class="o">=</span> <span class="n">DataDict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">),</span> <span class="n">z</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">]))</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">data_dict_2</span> <span class="o">=</span> <span class="n">DataDict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">),</span> <span class="n">z</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">]))</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">data_dict_1</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">z</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">data_dict_2</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="n">z</span><span class="o">=</span><span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="mi">16</span><span class="p">])</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">DataDict</span><span class="o">.</span><span class="n">same_structure</span><span class="p">(</span><span class="n">data_dict_1</span><span class="p">,</span> <span class="n">data_dict_2</span><span class="p">)</span>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="kc">True</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Make sure that both DataDicts have the exact same structure. This means that every item of every data field that appears when using the method <a href="#labcore.data.datadict.DataDictBase.same_structure"><code>same_structure()</code></a> (<code>unit</code>, <code>axes</code>, and <code>label</code>) are identical to one another, except for <code>values</code>. Any slight difference will make this method fail due to conflicting structures.    </p>
</div>
<p>The <a href="#labcore.data.datadict.DataDict.append"><code>append()</code></a> method will do this check before appending the 2 DataDict, and will only append them if the check returns <code>True</code>. Once we know that the structure is the same we can append them:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">data_dict_1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data_dict_2</span><span class="p">)</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">data_dict_1</span>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;axes&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])},</span>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;axes&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])},</span>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;axes&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">16</span><span class="p">])}}</span>
</code></pre></div>
<h3 id="meta-data">Meta Data</h3>
<p>One of the advantages DataDicts have over regular python dictionaries is their ability to contain meta data. Meta data can be added to the entire DataDict or to individual data fields. Any object inside a <code>DataDict</code> whose key starts and ends with two underscores is considered meta data.</p>
<p>We can simply add meta data manually by adding an item with the proper notation:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;__metadata__&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;important meta data&#39;</span>
</code></pre></div>
<p>Or we can use the <a href="#labcore.data.datadict.DataDictBase.add_meta"><code>add_meta()</code></a> method:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">add_meta</span><span class="p">(</span><span class="s1">&#39;sample_temperature&#39;</span><span class="p">,</span> <span class="s1">&#39;10mK&#39;</span><span class="p">)</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">data_dict</span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;axes&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])},</span>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;axes&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])},</span>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;axes&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">])},</span>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a> <span class="s1">&#39;__metadata__&#39;</span><span class="p">:</span> <span class="s1">&#39;important meta data&#39;</span><span class="p">,</span>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a> <span class="s1">&#39;__sample_temperature__&#39;</span><span class="p">:</span> <span class="s1">&#39;10mK&#39;</span><span class="p">}</span>
</code></pre></div>
<p>We can also add meta data to a specific data field by passing its name as the last argument:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">has_meta</span><span class="p">(</span><span class="s1">&#39;sample_temperature&#39;</span><span class="p">)</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="kc">True</span>
</code></pre></div>
<p>We can retrieve the meta data with the <a href="#labcore.data.datadict.DataDictBase.meta_val"><code>meta_val()</code></a> method:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">meta_val</span><span class="p">(</span><span class="s1">&#39;sample_temperature&#39;</span><span class="p">)</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="s1">&#39;10mK&#39;</span>
</code></pre></div>
<p>We can also ask for a meta value from a specific data field by passing the data field as the second argument:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">meta_val</span><span class="p">(</span><span class="s1">&#39;extra_metadata&#39;</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="s1">&#39;important meta data&#39;</span>
</code></pre></div>
<p>We can delete a specific meta field by using the <a href="#labcore.data.datadict.DataDictBase.delete_meta"><code>delete_meta()</code></a> method:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">delete_meta</span><span class="p">(</span><span class="s1">&#39;metadata&#39;</span><span class="p">)</span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">has_meta</span><span class="p">(</span><span class="s1">&#39;metadata&#39;</span><span class="p">)</span>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="kc">False</span>
</code></pre></div>
<p>This also work for meta data in data fields by passing the data field as the last argument:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">delete_meta</span><span class="p">(</span><span class="s1">&#39;extra_metadata&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="p">{</span><span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;axes&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])}</span>
</code></pre></div>
<p>We can delete all the meta data present in the DataDict with the <a href="#labcore.data.datadict.DataDictBase.clear_meta"><code>clear_meta()</code></a> method:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">add_meta</span><span class="p">(</span><span class="s1">&#39;metadata&#39;</span><span class="p">,</span> <span class="s1">&#39;important meta data&#39;</span><span class="p">)</span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">add_meta</span><span class="p">(</span><span class="s1">&#39;extra_metadata&#39;</span><span class="p">,</span> <span class="s1">&#39;important meta data&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">clear_meta</span><span class="p">()</span>
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">data_dict</span>
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;axes&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])},</span>
<a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;axes&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])},</span>
<a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;axes&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">])}}</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There are 3 helper functions in the datadict module that help converting from meta data name to key. These are: </p>
<ul>
<li><a href="#labcore.data.datadict.is_meta_key"><code>is_meta_key()</code></a>,</li>
<li><a href="#labcore.data.datadict.meta_key_to_name"><code>meta_key_to_name()</code></a></li>
<li><a href="#labcore.data.datadict.meta_name_to_key"><code>meta_name_to_key()</code></a></li>
</ul>
</div>
<h3 id="meshgrid-datadict">Meshgrid DataDict</h3>
<p>A dataset where the axes form a grid on which the dependent values reside.</p>
<p>This is a more special case than DataDict, but a very common scenario. To support flexible grids, this class requires that all axes specify values for each datapoint, rather than a single row/column/dimension.</p>
<p>For example, if we want to specify a 3-dimensional grid with axes <code>x</code>, <code>y</code>, <code>z</code>, the values of <code>x</code>, <code>y</code>, <code>z</code> all need to be 3-dimensional arrays; the same goes for all dependents that live on that grid. Then, say, <code>x[i,j,k]</code> is the x-coordinate of point <code>i</code>,<code>j</code>,<code>k</code> of the grid.</p>
<p>This implies that a MeshgridDataDict can only have a single shape, i.e., all data values share the exact same nesting structure.</p>
<p>For grids where the axes do not depend on each other, the correct values for the axes can be obtained from <a href="https://numpy.org/doc/stable/reference/generated/numpy.meshgrid.html">np.meshgrid</a> (hence the name of the class).</p>
<p>Example: a simple uniform 3x2 grid might look like this; x and y are the coordinates of the grid, and z is a function of the two:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>    x = [[0, 0],
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>         [1, 1],
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>         [2, 2]]
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a>
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a>    y = [[0, 1],
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>         [0, 1],
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a>         [0, 1]]
<a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a>
<a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a>    z = x * y =
<a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a>        [[0, 0],
<a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a>         [0, 1],
<a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a>         [0, 2]]
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Internally we will typically assume that the nested axes are ordered from slow to fast, i.e., dimension 1 is the most outer axis, and dimension N of an N-dimensional array the most inner (i.e., the fastest changing one). This guarantees, for example, that the default implementation of <code>np.reshape</code> has the expected outcome. If, for some reason, the specified axes are not in that order (e.g., we might have <code>z</code> with <code>axes = ['x', 'y']</code>, but <code>x</code> is the fast axis in the data). In such a case, the guideline is that at creation of the meshgrid, the data should be transposed such that it conforms correctly to the order as given in the <code>axis = [...]</code> specification of the data. The function <a href="#labcore.data.datadict.datadict_to_meshgrid"><code>datadict_to_meshgrid()</code></a> provides options for that.</p>
</div>
<p>This implementation of <a href="#labcore.data.datadict.DataDictBase"><code>DataDictBase</code></a> consists only of three extra methods:</p>
<ul>
<li><a href="#labcore.data.datadict.MeshgridDataDict.shape"><code>MeshgridDataDict.shape</code></a></li>
<li><a href="#labcore.data.datadict.MeshgridDataDict.validate"><code>MeshgridDataDict.validate</code></a></li>
<li><a href="#labcore.data.datadict.MeshgridDataDict.reorder_axes"><code>MeshgridDataDict.reorder_axis</code></a></li>
</ul>
<p>So the only way of populating it is by manually modifying the <code>values</code> object of each data field since the tools for populating the DataDict are specific to the <a href="#labcore.data.datadict.DataDict"><code>DataDict</code></a> implementation.</p>
<h2 id="datadict-storage">DataDict Storage</h2>
<p>The datadict_storage.py module offers tools to help with saving DataDicts into disk by storing them in DDH5 files (<a href="https://en.wikipedia.org/wiki/Hierarchical_Data_Format">HDF5 files</a> that contains DataDicts inside).</p>
<h3 id="description-of-the-hdf5-storage-format">Description of the HDF5 Storage Format</h3>
<p>We use a simple mapping from DataDict to the HDF5 file. Within the file, a single DataDict is stored in a (top-level) group of the file.
The data fields are datasets within that group.</p>
<p>Global meta data of the DataDict are attributes of the group; field meta data are attributes of the dataset (incl., the <code>unit</code> and <code>axes</code> values). The meta data keys are given exactly like in the DataDict, i.e., includes the double underscore pre- and suffix.</p>
<p>For more specific information on how HDF5 works please read the <a href="https://docs.hdfgroup.org/hdf5/v1_14/_h5_d_m__u_g.html#subsec_data_model_intro">following documentation</a></p>
<h3 id="working-with-ddh5-files">Working With DDH5 Files</h3>
<p>When we are working with data, the first thing we usually want to do is to save it in disk. We can directly save an already existing DataDict into disk by calling the function <a href="#labcore.data.datadict_storage.datadict_to_hdf5"><code>datadict_to_hdf5()</code></a>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">data_dict</span> <span class="o">=</span> <span class="n">DataDict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="n">axes</span><span class="o">=</span><span class="p">[],</span> <span class="n">__unit__</span><span class="o">=</span><span class="s1">&#39;cm&#39;</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]),</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]))</span>
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">data_dict</span>
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span> <span class="s1">&#39;axes&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;__unit__&#39;</span><span class="p">:</span> <span class="s1">&#39;cm&#39;</span><span class="p">},</span>
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span> <span class="s1">&#39;axes&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]}}</span>
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">datadict_to_hdf5</span><span class="p">(</span><span class="n">data_dict</span><span class="p">,</span> <span class="s1">&#39;folder\data.ddh5&#39;</span><span class="p">)</span>
</code></pre></div>
<p><a href="#labcore.data.datadict_storage.datadict_to_hdf5"><code>datadict_to_hdf5()</code></a> will save data_dict in a file named 'data.ddh5' in whatever directory is passed to it, creating new folders if they don't already exists. The file will contain all of the data fields as well as all the metadata,
with some more metadata generated to specify when the DataDict was created.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Meta data is only written during initial writing of the dataset. If we're appending to existing datasets, we're not setting meta data anymore.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>For this method to properly work the objects that are being saved in the <code>values</code> key of a data field must by a numpy array, or numpy array like.</p>
</div>
<p>Data saved on disk is useless however if we do not have a way of accessing it. To do this we use the <a href="#labcore.data.datadict_storage.datadict_from_hdf5"><code>datadict_from_hdf5()</code></a>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">loaded_data_dict</span> <span class="o">=</span> <span class="n">datadict_from_hdf5</span><span class="p">(</span><span class="s1">&#39;folder\data.ddh5&#39;</span><span class="p">)</span>
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">loaded_data_dict</span>
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="p">{</span><span class="s1">&#39;__creation_time_sec__&#39;</span><span class="p">:</span> <span class="mf">1651159636.0</span><span class="p">,</span>
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a> <span class="s1">&#39;__creation_time_str__&#39;</span><span class="p">:</span> <span class="s1">&#39;2022-04-28 10:27:16&#39;</span><span class="p">,</span>
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span>
<a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a>  <span class="s1">&#39;axes&#39;</span><span class="p">:</span> <span class="p">[],</span>
<a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a>  <span class="s1">&#39;__shape__&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">3</span><span class="p">,),</span>
<a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a>  <span class="s1">&#39;__creation_time_sec__&#39;</span><span class="p">:</span> <span class="mf">1651159636.0</span><span class="p">,</span>
<a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a>  <span class="s1">&#39;__creation_time_str__&#39;</span><span class="p">:</span> <span class="s1">&#39;2022-04-28 10:27:16&#39;</span><span class="p">,</span>
<a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a>  <span class="s1">&#39;__unit__&#39;</span><span class="p">:</span> <span class="s1">&#39;cm&#39;</span><span class="p">,</span>
<a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a>  <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<a id="__codelineno-23-12" name="__codelineno-23-12" href="#__codelineno-23-12"></a>  <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">},</span>
<a id="__codelineno-23-13" name="__codelineno-23-13" href="#__codelineno-23-13"></a> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span>
<a id="__codelineno-23-14" name="__codelineno-23-14" href="#__codelineno-23-14"></a>  <span class="s1">&#39;axes&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span>
<a id="__codelineno-23-15" name="__codelineno-23-15" href="#__codelineno-23-15"></a>  <span class="s1">&#39;__shape__&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">3</span><span class="p">,),</span>
<a id="__codelineno-23-16" name="__codelineno-23-16" href="#__codelineno-23-16"></a>  <span class="s1">&#39;__creation_time_sec__&#39;</span><span class="p">:</span> <span class="mf">1651159636.0</span><span class="p">,</span>
<a id="__codelineno-23-17" name="__codelineno-23-17" href="#__codelineno-23-17"></a>  <span class="s1">&#39;__creation_time_str__&#39;</span><span class="p">:</span> <span class="s1">&#39;2022-04-28 10:27:16&#39;</span><span class="p">,</span>
<a id="__codelineno-23-18" name="__codelineno-23-18" href="#__codelineno-23-18"></a>  <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<a id="__codelineno-23-19" name="__codelineno-23-19" href="#__codelineno-23-19"></a>  <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">}}</span>
</code></pre></div>
<p>We can see that the DataDict is the same one we saved earlier with the added metadata that indicates the time it was created.</p>
<p>By default both <a href="#labcore.data.datadict_storage.datadict_to_hdf5"><code>datadict_to_hdf5()</code></a> and <a href="#labcore.data.datadict_storage.datadict_from_hdf5"><code>datadict_from_hdf5()</code></a> save and load the datadict in the 'data' group of the DDH5. Both of these can by changed by passing another group to the argument 'groupname'. We can see this if we manually create a second group and save a new DataDict there:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">data_dict2</span> <span class="o">=</span> <span class="n">DataDict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="n">axes</span><span class="o">=</span><span class="p">[],</span> <span class="n">__unit__</span><span class="o">=</span><span class="s1">&#39;cm&#39;</span><span class="p">),</span> <span class="n">b</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]),</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]))</span>
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="k">with</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="s1">&#39;folder\data.ddh5&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="o">&gt;&gt;&gt;</span>    <span class="n">file</span><span class="o">.</span><span class="n">create_group</span><span class="p">(</span><span class="s1">&#39;other_data&#39;</span><span class="p">)</span>
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">datadict_to_hdf5</span><span class="p">(</span><span class="n">data_dict2</span><span class="p">,</span> <span class="s1">&#39;folder\data.ddh5&#39;</span><span class="p">,</span> <span class="n">groupname</span><span class="o">=</span><span class="s1">&#39;other_data&#39;</span><span class="p">)</span>
</code></pre></div>
<p>If we then load the DDH5 file like before we only see the first DataDict:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">loaded_data_dict</span> <span class="o">=</span> <span class="n">datadict_from_hdf5</span><span class="p">(</span><span class="s1">&#39;folder\data.ddh5&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">)</span>
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">loaded_data_dict</span>
<a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="p">{</span><span class="s1">&#39;__creation_time_sec__&#39;</span><span class="p">:</span> <span class="mf">1651159636.0</span><span class="p">,</span>
<a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a> <span class="s1">&#39;__creation_time_str__&#39;</span><span class="p">:</span> <span class="s1">&#39;2022-04-28 10:27:16&#39;</span><span class="p">,</span>
<a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span>
<a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a>  <span class="s1">&#39;axes&#39;</span><span class="p">:</span> <span class="p">[],</span>
<a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a>  <span class="s1">&#39;__shape__&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">3</span><span class="p">,),</span>
<a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a>  <span class="s1">&#39;__creation_time_sec__&#39;</span><span class="p">:</span> <span class="mf">1651159636.0</span><span class="p">,</span>
<a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a>  <span class="s1">&#39;__creation_time_str__&#39;</span><span class="p">:</span> <span class="s1">&#39;2022-04-28 10:27:16&#39;</span><span class="p">,</span>
<a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a>  <span class="s1">&#39;__unit__&#39;</span><span class="p">:</span> <span class="s1">&#39;cm&#39;</span><span class="p">,</span>
<a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a>  <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<a id="__codelineno-25-12" name="__codelineno-25-12" href="#__codelineno-25-12"></a>  <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">},</span>
<a id="__codelineno-25-13" name="__codelineno-25-13" href="#__codelineno-25-13"></a> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span>
<a id="__codelineno-25-14" name="__codelineno-25-14" href="#__codelineno-25-14"></a>  <span class="s1">&#39;axes&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span>
<a id="__codelineno-25-15" name="__codelineno-25-15" href="#__codelineno-25-15"></a>  <span class="s1">&#39;__shape__&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">3</span><span class="p">,),</span>
<a id="__codelineno-25-16" name="__codelineno-25-16" href="#__codelineno-25-16"></a>  <span class="s1">&#39;__creation_time_sec__&#39;</span><span class="p">:</span> <span class="mf">1651159636.0</span><span class="p">,</span>
<a id="__codelineno-25-17" name="__codelineno-25-17" href="#__codelineno-25-17"></a>  <span class="s1">&#39;__creation_time_str__&#39;</span><span class="p">:</span> <span class="s1">&#39;2022-04-28 10:27:16&#39;</span><span class="p">,</span>
<a id="__codelineno-25-18" name="__codelineno-25-18" href="#__codelineno-25-18"></a>  <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<a id="__codelineno-25-19" name="__codelineno-25-19" href="#__codelineno-25-19"></a>  <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">}}</span>
</code></pre></div>
<p>To see the other DataDict we can specify the group in the argument 'groupname':</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">loaded_data_dict</span> <span class="o">=</span> <span class="n">datadict_from_hdf5</span><span class="p">(</span><span class="s1">&#39;folder\data.ddh5&#39;</span><span class="p">,</span> <span class="s1">&#39;other_data&#39;</span><span class="p">)</span>
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">loaded_data_dict</span>
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span>
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a>  <span class="s1">&#39;axes&#39;</span><span class="p">:</span> <span class="p">[],</span>
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a>  <span class="s1">&#39;__shape__&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">3</span><span class="p">,),</span>
<a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a>  <span class="s1">&#39;__creation_time_sec__&#39;</span><span class="p">:</span> <span class="mf">1651159636.0</span><span class="p">,</span>
<a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a>  <span class="s1">&#39;__creation_time_str__&#39;</span><span class="p">:</span> <span class="s1">&#39;2022-04-28 10:27:16&#39;</span><span class="p">,</span>
<a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a>  <span class="s1">&#39;__unit__&#39;</span><span class="p">:</span> <span class="s1">&#39;cm&#39;</span><span class="p">,</span>
<a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a>  <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a>  <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">},</span>
<a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span>
<a id="__codelineno-26-12" name="__codelineno-26-12" href="#__codelineno-26-12"></a>  <span class="s1">&#39;axes&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">],</span>
<a id="__codelineno-26-13" name="__codelineno-26-13" href="#__codelineno-26-13"></a>  <span class="s1">&#39;__shape__&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">3</span><span class="p">,),</span>
<a id="__codelineno-26-14" name="__codelineno-26-14" href="#__codelineno-26-14"></a>  <span class="s1">&#39;__creation_time_sec__&#39;</span><span class="p">:</span> <span class="mf">1651159636.0</span><span class="p">,</span>
<a id="__codelineno-26-15" name="__codelineno-26-15" href="#__codelineno-26-15"></a>  <span class="s1">&#39;__creation_time_str__&#39;</span><span class="p">:</span> <span class="s1">&#39;2022-04-28 10:27:16&#39;</span><span class="p">,</span>
<a id="__codelineno-26-16" name="__codelineno-26-16" href="#__codelineno-26-16"></a>  <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<a id="__codelineno-26-17" name="__codelineno-26-17" href="#__codelineno-26-17"></a>  <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">}}</span>
</code></pre></div>
<p>We can also use <a href="#labcore.data.datadict_storage.all_datadicts_from_hdf5"><code>all_datadicts_from_hdf5()</code></a> to get a dictionary with all DataDicts in every group inside:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">all_datadicts</span> <span class="o">=</span> <span class="n">all_datadicts_from_hdf5</span><span class="p">(</span><span class="s1">&#39;folder\data.ddh5&#39;</span><span class="p">)</span>
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">all_datadicts</span>
<a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;__creation_time_sec__&#39;</span><span class="p">:</span> <span class="mf">1651159636.0</span><span class="p">,</span>
<a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a>  <span class="s1">&#39;__creation_time_str__&#39;</span><span class="p">:</span> <span class="s1">&#39;2022-04-28 10:27:16&#39;</span><span class="p">,</span>
<a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a>  <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span>
<a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a>   <span class="s1">&#39;axes&#39;</span><span class="p">:</span> <span class="p">[],</span>
<a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a>   <span class="s1">&#39;__shape__&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">3</span><span class="p">,),</span>
<a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a>   <span class="s1">&#39;__creation_time_sec__&#39;</span><span class="p">:</span> <span class="mf">1651159636.0</span><span class="p">,</span>
<a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a>   <span class="s1">&#39;__creation_time_str__&#39;</span><span class="p">:</span> <span class="s1">&#39;2022-04-28 10:27:16&#39;</span><span class="p">,</span>
<a id="__codelineno-27-10" name="__codelineno-27-10" href="#__codelineno-27-10"></a>   <span class="s1">&#39;__unit__&#39;</span><span class="p">:</span> <span class="s1">&#39;cm&#39;</span><span class="p">,</span>
<a id="__codelineno-27-11" name="__codelineno-27-11" href="#__codelineno-27-11"></a>   <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<a id="__codelineno-27-12" name="__codelineno-27-12" href="#__codelineno-27-12"></a>   <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">},</span>
<a id="__codelineno-27-13" name="__codelineno-27-13" href="#__codelineno-27-13"></a>  <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span>
<a id="__codelineno-27-14" name="__codelineno-27-14" href="#__codelineno-27-14"></a>   <span class="s1">&#39;axes&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span>
<a id="__codelineno-27-15" name="__codelineno-27-15" href="#__codelineno-27-15"></a>   <span class="s1">&#39;__shape__&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">3</span><span class="p">,),</span>
<a id="__codelineno-27-16" name="__codelineno-27-16" href="#__codelineno-27-16"></a>   <span class="s1">&#39;__creation_time_sec__&#39;</span><span class="p">:</span> <span class="mf">1651159636.0</span><span class="p">,</span>
<a id="__codelineno-27-17" name="__codelineno-27-17" href="#__codelineno-27-17"></a>   <span class="s1">&#39;__creation_time_str__&#39;</span><span class="p">:</span> <span class="s1">&#39;2022-04-28 10:27:16&#39;</span><span class="p">,</span>
<a id="__codelineno-27-18" name="__codelineno-27-18" href="#__codelineno-27-18"></a>   <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<a id="__codelineno-27-19" name="__codelineno-27-19" href="#__codelineno-27-19"></a>   <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">}},</span>
<a id="__codelineno-27-20" name="__codelineno-27-20" href="#__codelineno-27-20"></a> <span class="s1">&#39;other_data&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span>
<a id="__codelineno-27-21" name="__codelineno-27-21" href="#__codelineno-27-21"></a>   <span class="s1">&#39;axes&#39;</span><span class="p">:</span> <span class="p">[],</span>
<a id="__codelineno-27-22" name="__codelineno-27-22" href="#__codelineno-27-22"></a>   <span class="s1">&#39;__shape__&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">3</span><span class="p">,),</span>
<a id="__codelineno-27-23" name="__codelineno-27-23" href="#__codelineno-27-23"></a>   <span class="s1">&#39;__creation_time_sec__&#39;</span><span class="p">:</span> <span class="mf">1651159636.0</span><span class="p">,</span>
<a id="__codelineno-27-24" name="__codelineno-27-24" href="#__codelineno-27-24"></a>   <span class="s1">&#39;__creation_time_str__&#39;</span><span class="p">:</span> <span class="s1">&#39;2022-04-28 10:27:16&#39;</span><span class="p">,</span>
<a id="__codelineno-27-25" name="__codelineno-27-25" href="#__codelineno-27-25"></a>   <span class="s1">&#39;__unit__&#39;</span><span class="p">:</span> <span class="s1">&#39;cm&#39;</span><span class="p">,</span>
<a id="__codelineno-27-26" name="__codelineno-27-26" href="#__codelineno-27-26"></a>   <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<a id="__codelineno-27-27" name="__codelineno-27-27" href="#__codelineno-27-27"></a>   <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">},</span>
<a id="__codelineno-27-28" name="__codelineno-27-28" href="#__codelineno-27-28"></a>  <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span>
<a id="__codelineno-27-29" name="__codelineno-27-29" href="#__codelineno-27-29"></a>   <span class="s1">&#39;axes&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">],</span>
<a id="__codelineno-27-30" name="__codelineno-27-30" href="#__codelineno-27-30"></a>   <span class="s1">&#39;__shape__&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">3</span><span class="p">,),</span>
<a id="__codelineno-27-31" name="__codelineno-27-31" href="#__codelineno-27-31"></a>   <span class="s1">&#39;__creation_time_sec__&#39;</span><span class="p">:</span> <span class="mf">1651159636.0</span><span class="p">,</span>
<a id="__codelineno-27-32" name="__codelineno-27-32" href="#__codelineno-27-32"></a>   <span class="s1">&#39;__creation_time_str__&#39;</span><span class="p">:</span> <span class="s1">&#39;2022-04-28 10:27:16&#39;</span><span class="p">,</span>
<a id="__codelineno-27-33" name="__codelineno-27-33" href="#__codelineno-27-33"></a>   <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<a id="__codelineno-27-34" name="__codelineno-27-34" href="#__codelineno-27-34"></a>   <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">}}}</span>
</code></pre></div>
<h3 id="ddh5-writer">DDH5 Writer</h3>
<p>Most times we want to be saving data to disk as soon as it is generated by an experiment (or iteration), instead of waiting to have a complete DataDict. To do this, Datadict_storage also offers a <a href="https://docs.python.org/3/library/stdtypes.html#context-manager-types">context manager</a> with which we can safely save our incoming data.</p>
<p>To use it we first need to create an empty DataDict that contains the structure of how the data is going to look like:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">data_dict</span> <span class="o">=</span> <span class="n">DataDict</span><span class="p">(</span>
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="s1">&#39;x_unit&#39;</span><span class="p">),</span>
<a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">y</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="s1">&#39;y_unit&#39;</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]))</span>
</code></pre></div>
<p>With our created DataDict, we can start the <a href="#labcore.data.datadict_storage.DDH5Writer"><code>DDH5Writer</code></a> context manager and add data to our DataDict utilizing the <a href="#plottr.data.datadict_storage.DDH5Writer.add_data"><code>add_data()</code></a></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="k">with</span> <span class="n">DDH5Writer</span><span class="p">(</span><span class="n">datadict</span><span class="o">=</span><span class="n">data_dict</span><span class="p">,</span> <span class="n">basedir</span><span class="o">=</span><span class="s1">&#39;./data/&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Test&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">writer</span><span class="p">:</span>
<a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="o">&gt;&gt;&gt;</span>    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
<a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a><span class="o">&gt;&gt;&gt;</span>        <span class="n">writer</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a><span class="n">Data</span> <span class="n">location</span><span class="p">:</span>  <span class="n">data</span>\<span class="mi">2022</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">27</span>\<span class="mi">2022</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">27</span><span class="n">T145308_a986867c</span><span class="o">-</span><span class="n">Test</span>\<span class="n">data</span><span class="o">.</span><span class="n">ddh5</span>
</code></pre></div>
<p>The writer created the folder 'data' (because it did not exist before) and inside that folder,
created another new folder for the current day and another new folder inside of it day folder for the the DataDict that we saved with the naming structure of <code>YYYY-mm-dd_THHMMSS_&lt;ID&gt;-&lt;name&gt;/&lt;filename&gt;.ddh5</code>,
where name is the name parameter passed to the writer.
The writer creates this structure such that when we run the writer again with new data, it will create another folder following the naming structure inside the current date folder.
This way each new DataDict will be saved in the date it was generated with a time stamp in the name of the folder containing it.</p>
<h3 id="change-file-extension-and-time-format">Change File Extension and Time Format</h3>
<p>Finally, datadict_storage contains 2 module variables, 'DATAFILEXT' and 'TIMESTRFORMAT'.</p>
<p>'DATAFILEXT' by default is 'ddh5', and it is used to specify the extension file of all of the module saving functions. Change this variable if you want your HDF5 to have a different extension by default, instead of passing it everytime.</p>
<p>'TIMESTRFORMAT' specifies how the time is formated in the new metadata created when saving a DataDict. The default is: <code>"%Y-%m-%d %H:%M:%S"</code>, and it follows the structure of <a href="https://docs.python.org/3/library/time.html#time.strftime&gt;">strftime</a>.</p>
<h2 id="reference">Reference</h2>
<h3 id="datadict_1">Datadict</h3>


<div class="doc doc-object doc-module">



<a id="labcore.data.datadict"></a>
  <div class="doc doc-contents first">
  
      <p>datadict.py :</p>
<p>Data classes we use throughout the plottr package, and tools to work on them.</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h2 id="labcore.data.datadict.DataDict" class="doc doc-heading">
          <code>DataDict</code>


</h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="labcore.data.datadict.DataDictBase" href="#labcore.data.datadict.DataDictBase">DataDictBase</a></code></p>

  
      <p>The most basic implementation of the DataDict class.</p>
<p>It only enforces that the number of <code>records</code> per data field must be
equal for all fields. This refers to the most outer dimension in case
of nested arrays.</p>
<p>The class further implements simple appending of datadicts through the
<code>DataDict.append</code> method, as well as allowing addition of DataDict
instances.</p>

            <details class="quote">
              <summary>Source code in <code>labcore/data/datadict.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-772"> 772</a></span>
<span class="normal"><a href="#__codelineno-0-773"> 773</a></span>
<span class="normal"><a href="#__codelineno-0-774"> 774</a></span>
<span class="normal"><a href="#__codelineno-0-775"> 775</a></span>
<span class="normal"><a href="#__codelineno-0-776"> 776</a></span>
<span class="normal"><a href="#__codelineno-0-777"> 777</a></span>
<span class="normal"><a href="#__codelineno-0-778"> 778</a></span>
<span class="normal"><a href="#__codelineno-0-779"> 779</a></span>
<span class="normal"><a href="#__codelineno-0-780"> 780</a></span>
<span class="normal"><a href="#__codelineno-0-781"> 781</a></span>
<span class="normal"><a href="#__codelineno-0-782"> 782</a></span>
<span class="normal"><a href="#__codelineno-0-783"> 783</a></span>
<span class="normal"><a href="#__codelineno-0-784"> 784</a></span>
<span class="normal"><a href="#__codelineno-0-785"> 785</a></span>
<span class="normal"><a href="#__codelineno-0-786"> 786</a></span>
<span class="normal"><a href="#__codelineno-0-787"> 787</a></span>
<span class="normal"><a href="#__codelineno-0-788"> 788</a></span>
<span class="normal"><a href="#__codelineno-0-789"> 789</a></span>
<span class="normal"><a href="#__codelineno-0-790"> 790</a></span>
<span class="normal"><a href="#__codelineno-0-791"> 791</a></span>
<span class="normal"><a href="#__codelineno-0-792"> 792</a></span>
<span class="normal"><a href="#__codelineno-0-793"> 793</a></span>
<span class="normal"><a href="#__codelineno-0-794"> 794</a></span>
<span class="normal"><a href="#__codelineno-0-795"> 795</a></span>
<span class="normal"><a href="#__codelineno-0-796"> 796</a></span>
<span class="normal"><a href="#__codelineno-0-797"> 797</a></span>
<span class="normal"><a href="#__codelineno-0-798"> 798</a></span>
<span class="normal"><a href="#__codelineno-0-799"> 799</a></span>
<span class="normal"><a href="#__codelineno-0-800"> 800</a></span>
<span class="normal"><a href="#__codelineno-0-801"> 801</a></span>
<span class="normal"><a href="#__codelineno-0-802"> 802</a></span>
<span class="normal"><a href="#__codelineno-0-803"> 803</a></span>
<span class="normal"><a href="#__codelineno-0-804"> 804</a></span>
<span class="normal"><a href="#__codelineno-0-805"> 805</a></span>
<span class="normal"><a href="#__codelineno-0-806"> 806</a></span>
<span class="normal"><a href="#__codelineno-0-807"> 807</a></span>
<span class="normal"><a href="#__codelineno-0-808"> 808</a></span>
<span class="normal"><a href="#__codelineno-0-809"> 809</a></span>
<span class="normal"><a href="#__codelineno-0-810"> 810</a></span>
<span class="normal"><a href="#__codelineno-0-811"> 811</a></span>
<span class="normal"><a href="#__codelineno-0-812"> 812</a></span>
<span class="normal"><a href="#__codelineno-0-813"> 813</a></span>
<span class="normal"><a href="#__codelineno-0-814"> 814</a></span>
<span class="normal"><a href="#__codelineno-0-815"> 815</a></span>
<span class="normal"><a href="#__codelineno-0-816"> 816</a></span>
<span class="normal"><a href="#__codelineno-0-817"> 817</a></span>
<span class="normal"><a href="#__codelineno-0-818"> 818</a></span>
<span class="normal"><a href="#__codelineno-0-819"> 819</a></span>
<span class="normal"><a href="#__codelineno-0-820"> 820</a></span>
<span class="normal"><a href="#__codelineno-0-821"> 821</a></span>
<span class="normal"><a href="#__codelineno-0-822"> 822</a></span>
<span class="normal"><a href="#__codelineno-0-823"> 823</a></span>
<span class="normal"><a href="#__codelineno-0-824"> 824</a></span>
<span class="normal"><a href="#__codelineno-0-825"> 825</a></span>
<span class="normal"><a href="#__codelineno-0-826"> 826</a></span>
<span class="normal"><a href="#__codelineno-0-827"> 827</a></span>
<span class="normal"><a href="#__codelineno-0-828"> 828</a></span>
<span class="normal"><a href="#__codelineno-0-829"> 829</a></span>
<span class="normal"><a href="#__codelineno-0-830"> 830</a></span>
<span class="normal"><a href="#__codelineno-0-831"> 831</a></span>
<span class="normal"><a href="#__codelineno-0-832"> 832</a></span>
<span class="normal"><a href="#__codelineno-0-833"> 833</a></span>
<span class="normal"><a href="#__codelineno-0-834"> 834</a></span>
<span class="normal"><a href="#__codelineno-0-835"> 835</a></span>
<span class="normal"><a href="#__codelineno-0-836"> 836</a></span>
<span class="normal"><a href="#__codelineno-0-837"> 837</a></span>
<span class="normal"><a href="#__codelineno-0-838"> 838</a></span>
<span class="normal"><a href="#__codelineno-0-839"> 839</a></span>
<span class="normal"><a href="#__codelineno-0-840"> 840</a></span>
<span class="normal"><a href="#__codelineno-0-841"> 841</a></span>
<span class="normal"><a href="#__codelineno-0-842"> 842</a></span>
<span class="normal"><a href="#__codelineno-0-843"> 843</a></span>
<span class="normal"><a href="#__codelineno-0-844"> 844</a></span>
<span class="normal"><a href="#__codelineno-0-845"> 845</a></span>
<span class="normal"><a href="#__codelineno-0-846"> 846</a></span>
<span class="normal"><a href="#__codelineno-0-847"> 847</a></span>
<span class="normal"><a href="#__codelineno-0-848"> 848</a></span>
<span class="normal"><a href="#__codelineno-0-849"> 849</a></span>
<span class="normal"><a href="#__codelineno-0-850"> 850</a></span>
<span class="normal"><a href="#__codelineno-0-851"> 851</a></span>
<span class="normal"><a href="#__codelineno-0-852"> 852</a></span>
<span class="normal"><a href="#__codelineno-0-853"> 853</a></span>
<span class="normal"><a href="#__codelineno-0-854"> 854</a></span>
<span class="normal"><a href="#__codelineno-0-855"> 855</a></span>
<span class="normal"><a href="#__codelineno-0-856"> 856</a></span>
<span class="normal"><a href="#__codelineno-0-857"> 857</a></span>
<span class="normal"><a href="#__codelineno-0-858"> 858</a></span>
<span class="normal"><a href="#__codelineno-0-859"> 859</a></span>
<span class="normal"><a href="#__codelineno-0-860"> 860</a></span>
<span class="normal"><a href="#__codelineno-0-861"> 861</a></span>
<span class="normal"><a href="#__codelineno-0-862"> 862</a></span>
<span class="normal"><a href="#__codelineno-0-863"> 863</a></span>
<span class="normal"><a href="#__codelineno-0-864"> 864</a></span>
<span class="normal"><a href="#__codelineno-0-865"> 865</a></span>
<span class="normal"><a href="#__codelineno-0-866"> 866</a></span>
<span class="normal"><a href="#__codelineno-0-867"> 867</a></span>
<span class="normal"><a href="#__codelineno-0-868"> 868</a></span>
<span class="normal"><a href="#__codelineno-0-869"> 869</a></span>
<span class="normal"><a href="#__codelineno-0-870"> 870</a></span>
<span class="normal"><a href="#__codelineno-0-871"> 871</a></span>
<span class="normal"><a href="#__codelineno-0-872"> 872</a></span>
<span class="normal"><a href="#__codelineno-0-873"> 873</a></span>
<span class="normal"><a href="#__codelineno-0-874"> 874</a></span>
<span class="normal"><a href="#__codelineno-0-875"> 875</a></span>
<span class="normal"><a href="#__codelineno-0-876"> 876</a></span>
<span class="normal"><a href="#__codelineno-0-877"> 877</a></span>
<span class="normal"><a href="#__codelineno-0-878"> 878</a></span>
<span class="normal"><a href="#__codelineno-0-879"> 879</a></span>
<span class="normal"><a href="#__codelineno-0-880"> 880</a></span>
<span class="normal"><a href="#__codelineno-0-881"> 881</a></span>
<span class="normal"><a href="#__codelineno-0-882"> 882</a></span>
<span class="normal"><a href="#__codelineno-0-883"> 883</a></span>
<span class="normal"><a href="#__codelineno-0-884"> 884</a></span>
<span class="normal"><a href="#__codelineno-0-885"> 885</a></span>
<span class="normal"><a href="#__codelineno-0-886"> 886</a></span>
<span class="normal"><a href="#__codelineno-0-887"> 887</a></span>
<span class="normal"><a href="#__codelineno-0-888"> 888</a></span>
<span class="normal"><a href="#__codelineno-0-889"> 889</a></span>
<span class="normal"><a href="#__codelineno-0-890"> 890</a></span>
<span class="normal"><a href="#__codelineno-0-891"> 891</a></span>
<span class="normal"><a href="#__codelineno-0-892"> 892</a></span>
<span class="normal"><a href="#__codelineno-0-893"> 893</a></span>
<span class="normal"><a href="#__codelineno-0-894"> 894</a></span>
<span class="normal"><a href="#__codelineno-0-895"> 895</a></span>
<span class="normal"><a href="#__codelineno-0-896"> 896</a></span>
<span class="normal"><a href="#__codelineno-0-897"> 897</a></span>
<span class="normal"><a href="#__codelineno-0-898"> 898</a></span>
<span class="normal"><a href="#__codelineno-0-899"> 899</a></span>
<span class="normal"><a href="#__codelineno-0-900"> 900</a></span>
<span class="normal"><a href="#__codelineno-0-901"> 901</a></span>
<span class="normal"><a href="#__codelineno-0-902"> 902</a></span>
<span class="normal"><a href="#__codelineno-0-903"> 903</a></span>
<span class="normal"><a href="#__codelineno-0-904"> 904</a></span>
<span class="normal"><a href="#__codelineno-0-905"> 905</a></span>
<span class="normal"><a href="#__codelineno-0-906"> 906</a></span>
<span class="normal"><a href="#__codelineno-0-907"> 907</a></span>
<span class="normal"><a href="#__codelineno-0-908"> 908</a></span>
<span class="normal"><a href="#__codelineno-0-909"> 909</a></span>
<span class="normal"><a href="#__codelineno-0-910"> 910</a></span>
<span class="normal"><a href="#__codelineno-0-911"> 911</a></span>
<span class="normal"><a href="#__codelineno-0-912"> 912</a></span>
<span class="normal"><a href="#__codelineno-0-913"> 913</a></span>
<span class="normal"><a href="#__codelineno-0-914"> 914</a></span>
<span class="normal"><a href="#__codelineno-0-915"> 915</a></span>
<span class="normal"><a href="#__codelineno-0-916"> 916</a></span>
<span class="normal"><a href="#__codelineno-0-917"> 917</a></span>
<span class="normal"><a href="#__codelineno-0-918"> 918</a></span>
<span class="normal"><a href="#__codelineno-0-919"> 919</a></span>
<span class="normal"><a href="#__codelineno-0-920"> 920</a></span>
<span class="normal"><a href="#__codelineno-0-921"> 921</a></span>
<span class="normal"><a href="#__codelineno-0-922"> 922</a></span>
<span class="normal"><a href="#__codelineno-0-923"> 923</a></span>
<span class="normal"><a href="#__codelineno-0-924"> 924</a></span>
<span class="normal"><a href="#__codelineno-0-925"> 925</a></span>
<span class="normal"><a href="#__codelineno-0-926"> 926</a></span>
<span class="normal"><a href="#__codelineno-0-927"> 927</a></span>
<span class="normal"><a href="#__codelineno-0-928"> 928</a></span>
<span class="normal"><a href="#__codelineno-0-929"> 929</a></span>
<span class="normal"><a href="#__codelineno-0-930"> 930</a></span>
<span class="normal"><a href="#__codelineno-0-931"> 931</a></span>
<span class="normal"><a href="#__codelineno-0-932"> 932</a></span>
<span class="normal"><a href="#__codelineno-0-933"> 933</a></span>
<span class="normal"><a href="#__codelineno-0-934"> 934</a></span>
<span class="normal"><a href="#__codelineno-0-935"> 935</a></span>
<span class="normal"><a href="#__codelineno-0-936"> 936</a></span>
<span class="normal"><a href="#__codelineno-0-937"> 937</a></span>
<span class="normal"><a href="#__codelineno-0-938"> 938</a></span>
<span class="normal"><a href="#__codelineno-0-939"> 939</a></span>
<span class="normal"><a href="#__codelineno-0-940"> 940</a></span>
<span class="normal"><a href="#__codelineno-0-941"> 941</a></span>
<span class="normal"><a href="#__codelineno-0-942"> 942</a></span>
<span class="normal"><a href="#__codelineno-0-943"> 943</a></span>
<span class="normal"><a href="#__codelineno-0-944"> 944</a></span>
<span class="normal"><a href="#__codelineno-0-945"> 945</a></span>
<span class="normal"><a href="#__codelineno-0-946"> 946</a></span>
<span class="normal"><a href="#__codelineno-0-947"> 947</a></span>
<span class="normal"><a href="#__codelineno-0-948"> 948</a></span>
<span class="normal"><a href="#__codelineno-0-949"> 949</a></span>
<span class="normal"><a href="#__codelineno-0-950"> 950</a></span>
<span class="normal"><a href="#__codelineno-0-951"> 951</a></span>
<span class="normal"><a href="#__codelineno-0-952"> 952</a></span>
<span class="normal"><a href="#__codelineno-0-953"> 953</a></span>
<span class="normal"><a href="#__codelineno-0-954"> 954</a></span>
<span class="normal"><a href="#__codelineno-0-955"> 955</a></span>
<span class="normal"><a href="#__codelineno-0-956"> 956</a></span>
<span class="normal"><a href="#__codelineno-0-957"> 957</a></span>
<span class="normal"><a href="#__codelineno-0-958"> 958</a></span>
<span class="normal"><a href="#__codelineno-0-959"> 959</a></span>
<span class="normal"><a href="#__codelineno-0-960"> 960</a></span>
<span class="normal"><a href="#__codelineno-0-961"> 961</a></span>
<span class="normal"><a href="#__codelineno-0-962"> 962</a></span>
<span class="normal"><a href="#__codelineno-0-963"> 963</a></span>
<span class="normal"><a href="#__codelineno-0-964"> 964</a></span>
<span class="normal"><a href="#__codelineno-0-965"> 965</a></span>
<span class="normal"><a href="#__codelineno-0-966"> 966</a></span>
<span class="normal"><a href="#__codelineno-0-967"> 967</a></span>
<span class="normal"><a href="#__codelineno-0-968"> 968</a></span>
<span class="normal"><a href="#__codelineno-0-969"> 969</a></span>
<span class="normal"><a href="#__codelineno-0-970"> 970</a></span>
<span class="normal"><a href="#__codelineno-0-971"> 971</a></span>
<span class="normal"><a href="#__codelineno-0-972"> 972</a></span>
<span class="normal"><a href="#__codelineno-0-973"> 973</a></span>
<span class="normal"><a href="#__codelineno-0-974"> 974</a></span>
<span class="normal"><a href="#__codelineno-0-975"> 975</a></span>
<span class="normal"><a href="#__codelineno-0-976"> 976</a></span>
<span class="normal"><a href="#__codelineno-0-977"> 977</a></span>
<span class="normal"><a href="#__codelineno-0-978"> 978</a></span>
<span class="normal"><a href="#__codelineno-0-979"> 979</a></span>
<span class="normal"><a href="#__codelineno-0-980"> 980</a></span>
<span class="normal"><a href="#__codelineno-0-981"> 981</a></span>
<span class="normal"><a href="#__codelineno-0-982"> 982</a></span>
<span class="normal"><a href="#__codelineno-0-983"> 983</a></span>
<span class="normal"><a href="#__codelineno-0-984"> 984</a></span>
<span class="normal"><a href="#__codelineno-0-985"> 985</a></span>
<span class="normal"><a href="#__codelineno-0-986"> 986</a></span>
<span class="normal"><a href="#__codelineno-0-987"> 987</a></span>
<span class="normal"><a href="#__codelineno-0-988"> 988</a></span>
<span class="normal"><a href="#__codelineno-0-989"> 989</a></span>
<span class="normal"><a href="#__codelineno-0-990"> 990</a></span>
<span class="normal"><a href="#__codelineno-0-991"> 991</a></span>
<span class="normal"><a href="#__codelineno-0-992"> 992</a></span>
<span class="normal"><a href="#__codelineno-0-993"> 993</a></span>
<span class="normal"><a href="#__codelineno-0-994"> 994</a></span>
<span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span>
<span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span>
<span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span>
<span class="normal"><a href="#__codelineno-0-1016">1016</a></span>
<span class="normal"><a href="#__codelineno-0-1017">1017</a></span>
<span class="normal"><a href="#__codelineno-0-1018">1018</a></span>
<span class="normal"><a href="#__codelineno-0-1019">1019</a></span>
<span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span>
<span class="normal"><a href="#__codelineno-0-1035">1035</a></span>
<span class="normal"><a href="#__codelineno-0-1036">1036</a></span>
<span class="normal"><a href="#__codelineno-0-1037">1037</a></span>
<span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span>
<span class="normal"><a href="#__codelineno-0-1040">1040</a></span>
<span class="normal"><a href="#__codelineno-0-1041">1041</a></span>
<span class="normal"><a href="#__codelineno-0-1042">1042</a></span>
<span class="normal"><a href="#__codelineno-0-1043">1043</a></span>
<span class="normal"><a href="#__codelineno-0-1044">1044</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-772" name="__codelineno-0-772"></a><span class="k">class</span><span class="w"> </span><span class="nc">DataDict</span><span class="p">(</span><span class="n">DataDictBase</span><span class="p">):</span>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a><span class="sd">    The most basic implementation of the DataDict class.</span>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a><span class="sd">    It only enforces that the number of `records` per data field must be</span>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a><span class="sd">    equal for all fields. This refers to the most outer dimension in case</span>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a><span class="sd">    of nested arrays.</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a><span class="sd">    The class further implements simple appending of datadicts through the</span>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a><span class="sd">    ``DataDict.append`` method, as well as allowing addition of DataDict</span>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a><span class="sd">    instances.</span>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">newdata</span><span class="p">:</span> <span class="s1">&#39;DataDict&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DataDict&#39;</span><span class="p">:</span>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a><span class="sd">        Adding two datadicts by appending each data array.</span>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a><span class="sd">        Requires that the datadicts have the same structure.</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a><span class="sd">        Retains the meta information of the first array.</span>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a><span class="sd">        :param newdata: DataDict to be added.</span>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a><span class="sd">        :returns: combined DataDict.</span>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a><span class="sd">        :raises: ``ValueError`` if the structures are incompatible.</span>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a>        <span class="c1"># FIXME: remove shape</span>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">misc</span><span class="o">.</span><span class="n">unwrap_optional</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="p">(</span><span class="n">add_shape</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a>        <span class="k">if</span> <span class="n">DataDictBase</span><span class="o">.</span><span class="n">same_structure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">newdata</span><span class="p">):</span>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a>            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a>                <span class="n">val0</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a>                <span class="n">val1</span> <span class="o">=</span> <span class="n">newdata</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span>
<a id="__codelineno-0-803" name="__codelineno-0-803"></a>                <span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-804" name="__codelineno-0-804"></a>                    <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">],</span>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a>                    <span class="n">newdata</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">],</span>
<a id="__codelineno-0-806" name="__codelineno-0-806"></a>                    <span class="n">axis</span><span class="o">=</span><span class="mi">0</span>
<a id="__codelineno-0-807" name="__codelineno-0-807"></a>                <span class="p">)</span>
<a id="__codelineno-0-808" name="__codelineno-0-808"></a>            <span class="k">return</span> <span class="n">s</span>
<a id="__codelineno-0-809" name="__codelineno-0-809"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Incompatible data structures.&#39;</span><span class="p">)</span>
<a id="__codelineno-0-811" name="__codelineno-0-811"></a>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">newdata</span><span class="p">:</span> <span class="s2">&quot;DataDict&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a><span class="sd">        Append a datadict to this one by appending data values.</span>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a><span class="sd">        :param newdata: DataDict to append.</span>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a><span class="sd">        :raises: ``ValueError``, if the structures are incompatible.</span>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">DataDictBase</span><span class="o">.</span><span class="n">same_structure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">newdata</span><span class="p">):</span>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Incompatible data structures.&#39;</span><span class="p">)</span>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a>        <span class="n">newvals</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">newdata</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">],</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a>                    <span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a>                <span class="n">newvals</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">]</span>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a>                <span class="n">newvals</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a>                    <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">],</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a>                    <span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">],</span>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a>                    <span class="n">axis</span><span class="o">=</span><span class="mi">0</span>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a>                <span class="p">)</span>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a>        <span class="c1"># only actually</span>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">newvals</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a>            <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a>        <span class="c1"># TODO: fill non-given data with nan or none</span>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a><span class="sd">        Add data to all values. new data must be valid in itself.</span>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a><span class="sd">        This method is useful to easily add data without needing to specify</span>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a><span class="sd">        meta data or dependencies, etc.</span>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a><span class="sd">        :param kw: one array per data field (none can be omitted).</span>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a>        <span class="n">dd</span> <span class="o">=</span> <span class="n">misc</span><span class="o">.</span><span class="n">unwrap_optional</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="p">(</span><span class="n">same_type</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a>        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">dd</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a>            <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">:</span>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a>                <span class="n">kw</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-852" name="__codelineno-0-852"></a>
<a id="__codelineno-0-853" name="__codelineno-0-853"></a>        <span class="n">records</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_records</span><span class="p">(</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span>
<a id="__codelineno-0-854" name="__codelineno-0-854"></a>        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">datavals</span> <span class="ow">in</span> <span class="n">records</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a>            <span class="n">dd</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datavals</span>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a>
<a id="__codelineno-0-857" name="__codelineno-0-857"></a>        <span class="k">if</span> <span class="n">dd</span><span class="o">.</span><span class="n">validate</span><span class="p">():</span>
<a id="__codelineno-0-858" name="__codelineno-0-858"></a>            <span class="n">nrecords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrecords</span><span class="p">()</span>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a>            <span class="k">if</span> <span class="n">nrecords</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">nrecords</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dd</span><span class="p">)</span>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a>                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">dd</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a>                    <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">]</span>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a>    <span class="c1"># shape information and expansion</span>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">nrecords</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a><span class="sd">        Gets the number of records in the dataset.</span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a><span class="sd">        :return: The number of records in the dataset.</span>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a>        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a>            <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">])</span>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a>        <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_inner_shapes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]]:</span>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a>        <span class="n">shapes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shapes</span><span class="p">()</span>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a>        <span class="k">return</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">shapes</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_expanded</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a><span class="sd">        Determine if the DataDict is expanded.</span>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a><span class="sd">        :return: ``True`` if expanded. ``False`` if not.</span>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a>        <span class="n">ishp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inner_shapes</span><span class="p">()</span>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a>        <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">ishp</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">==</span> <span class="p">{</span><span class="nb">tuple</span><span class="p">()}:</span>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a>            <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-893" name="__codelineno-0-893"></a>            <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-894" name="__codelineno-0-894"></a>
<a id="__codelineno-0-895" name="__codelineno-0-895"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_expandable</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a><span class="sd">        Determine if the DataDict can be expanded.</span>
<a id="__codelineno-0-898" name="__codelineno-0-898"></a>
<a id="__codelineno-0-899" name="__codelineno-0-899"></a><span class="sd">        Expansion flattens all nested data values to a 1D array. For doing so,</span>
<a id="__codelineno-0-900" name="__codelineno-0-900"></a><span class="sd">        we require that all data fields that have nested/inner dimensions (i.e,</span>
<a id="__codelineno-0-901" name="__codelineno-0-901"></a><span class="sd">        inside the `records` level) shape the inner shape.</span>
<a id="__codelineno-0-902" name="__codelineno-0-902"></a><span class="sd">        In other words, all data fields must be of shape (N,) or (N, (shape)),</span>
<a id="__codelineno-0-903" name="__codelineno-0-903"></a><span class="sd">        where shape is common to all that have a shape not equal to (N,).</span>
<a id="__codelineno-0-904" name="__codelineno-0-904"></a>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a><span class="sd">        :return: ``True`` if expandable. ``False`` otherwise.</span>
<a id="__codelineno-0-906" name="__codelineno-0-906"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-907" name="__codelineno-0-907"></a>        <span class="n">shp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inner_shapes</span><span class="p">()</span>
<a id="__codelineno-0-908" name="__codelineno-0-908"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">shp</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-909" name="__codelineno-0-909"></a>            <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-910" name="__codelineno-0-910"></a>        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">shp</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="nb">tuple</span><span class="p">()</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">shp</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
<a id="__codelineno-0-911" name="__codelineno-0-911"></a>            <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-912" name="__codelineno-0-912"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-913" name="__codelineno-0-913"></a>            <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-914" name="__codelineno-0-914"></a>
<a id="__codelineno-0-915" name="__codelineno-0-915"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">expand</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DataDict&#39;</span><span class="p">:</span>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-917" name="__codelineno-0-917"></a><span class="sd">        Expand nested values in the data fields.</span>
<a id="__codelineno-0-918" name="__codelineno-0-918"></a>
<a id="__codelineno-0-919" name="__codelineno-0-919"></a><span class="sd">        Flattens all value arrays. If nested dimensions</span>
<a id="__codelineno-0-920" name="__codelineno-0-920"></a><span class="sd">        are present, all data with non-nested dims will be repeated</span>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a><span class="sd">        accordingly -- each record is repeated to match the size of</span>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a><span class="sd">        the nested dims.</span>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a><span class="sd">        :return: The flattened dataset.</span>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a><span class="sd">        :raises: ``ValueError`` if data is not expandable.</span>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_expandable</span><span class="p">():</span>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Data cannot be expanded.&#39;</span><span class="p">)</span>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a>        <span class="n">struct</span> <span class="o">=</span> <span class="n">misc</span><span class="o">.</span><span class="n">unwrap_optional</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="p">(</span><span class="n">add_shape</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a>        <span class="n">ret</span> <span class="o">=</span> <span class="n">DataDict</span><span class="p">(</span><span class="o">**</span><span class="n">struct</span><span class="p">)</span>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_expanded</span><span class="p">():</span>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a>            <span class="k">return</span> <span class="bp">self</span>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a>        <span class="n">ishp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inner_shapes</span><span class="p">()</span>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a>        <span class="n">size</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">ishp</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-940" name="__codelineno-0-940"></a>            <span class="n">reps</span> <span class="o">=</span> <span class="n">size</span> <span class="o">//</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">ishp</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a>            <span class="k">if</span> <span class="n">reps</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a>                <span class="n">ret</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span> <span class="o">=</span> \
<a id="__codelineno-0-943" name="__codelineno-0-943"></a>                    <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">reps</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-945" name="__codelineno-0-945"></a>                <span class="n">ret</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a>        <span class="k">return</span> <span class="n">ret</span>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a>    <span class="c1"># validation and sanitizing</span>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-953" name="__codelineno-0-953"></a><span class="sd">        Check dataset validity.</span>
<a id="__codelineno-0-954" name="__codelineno-0-954"></a>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a><span class="sd">        Beyond the checks performed in the base class ``DataDictBase``,</span>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a><span class="sd">        check whether the number of records is the same for all data fields.</span>
<a id="__codelineno-0-957" name="__codelineno-0-957"></a>
<a id="__codelineno-0-958" name="__codelineno-0-958"></a><span class="sd">        :return: ``True`` if valid.</span>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a><span class="sd">        :raises: ``ValueError`` if invalid.</span>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-961" name="__codelineno-0-961"></a>        <span class="k">if</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">validate</span><span class="p">():</span>
<a id="__codelineno-0-962" name="__codelineno-0-962"></a>            <span class="n">nvals</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-963" name="__codelineno-0-963"></a>            <span class="n">nvalsrc</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-964" name="__codelineno-0-964"></a>            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-965" name="__codelineno-0-965"></a>
<a id="__codelineno-0-966" name="__codelineno-0-966"></a>            <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-967" name="__codelineno-0-967"></a>                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">])</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<a id="__codelineno-0-968" name="__codelineno-0-968"></a>                                             <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">MaskedArray</span><span class="p">]:</span>
<a id="__codelineno-0-969" name="__codelineno-0-969"></a>                    <span class="bp">self</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">])</span>
<a id="__codelineno-0-970" name="__codelineno-0-970"></a>
<a id="__codelineno-0-971" name="__codelineno-0-971"></a>                <span class="k">if</span> <span class="n">nvals</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-972" name="__codelineno-0-972"></a>                    <span class="n">nvals</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">])</span>
<a id="__codelineno-0-973" name="__codelineno-0-973"></a>                    <span class="n">nvalsrc</span> <span class="o">=</span> <span class="n">n</span>
<a id="__codelineno-0-974" name="__codelineno-0-974"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-975" name="__codelineno-0-975"></a>                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">])</span> <span class="o">!=</span> <span class="n">nvals</span><span class="p">:</span>
<a id="__codelineno-0-976" name="__codelineno-0-976"></a>                        <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot; * &#39;</span><span class="si">{}</span><span class="s2">&#39; has length </span><span class="si">{}</span><span class="s2">, but have found </span><span class="si">{}</span><span class="s2"> in &quot;</span> \
<a id="__codelineno-0-977" name="__codelineno-0-977"></a>                               <span class="s2">&quot;&#39;</span><span class="si">{}</span><span class="s2">&#39;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-978" name="__codelineno-0-978"></a>                            <span class="n">n</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">]),</span> <span class="n">nvals</span><span class="p">,</span> <span class="n">nvalsrc</span><span class="p">)</span>
<a id="__codelineno-0-979" name="__codelineno-0-979"></a>
<a id="__codelineno-0-980" name="__codelineno-0-980"></a>            <span class="k">if</span> <span class="n">msg</span> <span class="o">!=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span>
<a id="__codelineno-0-981" name="__codelineno-0-981"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<a id="__codelineno-0-982" name="__codelineno-0-982"></a>
<a id="__codelineno-0-983" name="__codelineno-0-983"></a>        <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-984" name="__codelineno-0-984"></a>
<a id="__codelineno-0-985" name="__codelineno-0-985"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">sanitize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DataDict&quot;</span><span class="p">:</span>
<a id="__codelineno-0-986" name="__codelineno-0-986"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-987" name="__codelineno-0-987"></a><span class="sd">        Clean-up.</span>
<a id="__codelineno-0-988" name="__codelineno-0-988"></a>
<a id="__codelineno-0-989" name="__codelineno-0-989"></a><span class="sd">        Beyond the tasks of the base class ``DataDictBase``:</span>
<a id="__codelineno-0-990" name="__codelineno-0-990"></a><span class="sd">            * remove invalid entries as far as reasonable.</span>
<a id="__codelineno-0-991" name="__codelineno-0-991"></a>
<a id="__codelineno-0-992" name="__codelineno-0-992"></a><span class="sd">        :return: sanitized DataDict.</span>
<a id="__codelineno-0-993" name="__codelineno-0-993"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-994" name="__codelineno-0-994"></a>        <span class="n">ret</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">sanitize</span><span class="p">()</span>
<a id="__codelineno-0-995" name="__codelineno-0-995"></a>        <span class="k">return</span> <span class="n">ret</span><span class="o">.</span><span class="n">remove_invalid_entries</span><span class="p">()</span>
<a id="__codelineno-0-996" name="__codelineno-0-996"></a>
<a id="__codelineno-0-997" name="__codelineno-0-997"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">remove_invalid_entries</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DataDict&#39;</span><span class="p">:</span>
<a id="__codelineno-0-998" name="__codelineno-0-998"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-999" name="__codelineno-0-999"></a><span class="sd">        Remove all rows that are ``None`` or ``np.nan`` in *all* dependents.</span>
<a id="__codelineno-0-1000" name="__codelineno-0-1000"></a>
<a id="__codelineno-0-1001" name="__codelineno-0-1001"></a><span class="sd">        :return: The cleaned DataDict.</span>
<a id="__codelineno-0-1002" name="__codelineno-0-1002"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1003" name="__codelineno-0-1003"></a>        <span class="n">ishp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inner_shapes</span><span class="p">()</span>
<a id="__codelineno-0-1004" name="__codelineno-0-1004"></a>        <span class="n">idxs</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1005" name="__codelineno-0-1005"></a>
<a id="__codelineno-0-1006" name="__codelineno-0-1006"></a>        <span class="c1"># collect rows that are completely invalid</span>
<a id="__codelineno-0-1007" name="__codelineno-0-1007"></a>        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dependents</span><span class="p">():</span>
<a id="__codelineno-0-1008" name="__codelineno-0-1008"></a>
<a id="__codelineno-0-1009" name="__codelineno-0-1009"></a>            <span class="c1">#  need to discriminate whether there are nested dims or not</span>
<a id="__codelineno-0-1010" name="__codelineno-0-1010"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ishp</span><span class="p">[</span><span class="n">d</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1011" name="__codelineno-0-1011"></a>                <span class="n">rows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_vals</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<a id="__codelineno-0-1012" name="__codelineno-0-1012"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1013" name="__codelineno-0-1013"></a>                <span class="n">datavals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_vals</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<a id="__codelineno-0-1014" name="__codelineno-0-1014"></a>                <span class="n">rows</span> <span class="o">=</span> <span class="n">datavals</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">ishp</span><span class="p">[</span><span class="n">d</span><span class="p">])))</span>
<a id="__codelineno-0-1015" name="__codelineno-0-1015"></a>
<a id="__codelineno-0-1016" name="__codelineno-0-1016"></a>            <span class="n">_idxs</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<a id="__codelineno-0-1017" name="__codelineno-0-1017"></a>
<a id="__codelineno-0-1018" name="__codelineno-0-1018"></a>            <span class="c1"># get indices of all rows that are fully None</span>
<a id="__codelineno-0-1019" name="__codelineno-0-1019"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ishp</span><span class="p">[</span><span class="n">d</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1020" name="__codelineno-0-1020"></a>                <span class="n">_newidxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">rows</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">))</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1021" name="__codelineno-0-1021"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1022" name="__codelineno-0-1022"></a>                <span class="n">_newidxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">rows</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)))</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1023" name="__codelineno-0-1023"></a>            <span class="n">_idxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_idxs</span><span class="p">,</span> <span class="n">_newidxs</span><span class="p">)</span>
<a id="__codelineno-0-1024" name="__codelineno-0-1024"></a>
<a id="__codelineno-0-1025" name="__codelineno-0-1025"></a>            <span class="c1"># get indices for all rows that are fully NaN. works only</span>
<a id="__codelineno-0-1026" name="__codelineno-0-1026"></a>            <span class="c1"># for some dtypes, so except TypeErrors.</span>
<a id="__codelineno-0-1027" name="__codelineno-0-1027"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-1028" name="__codelineno-0-1028"></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ishp</span><span class="p">[</span><span class="n">d</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1029" name="__codelineno-0-1029"></a>                    <span class="n">_newidxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">rows</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1030" name="__codelineno-0-1030"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1031" name="__codelineno-0-1031"></a>                    <span class="n">_newidxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">rows</span><span class="p">),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1032" name="__codelineno-0-1032"></a>                <span class="n">_idxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_idxs</span><span class="p">,</span> <span class="n">_newidxs</span><span class="p">)</span>
<a id="__codelineno-0-1033" name="__codelineno-0-1033"></a>            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
<a id="__codelineno-0-1034" name="__codelineno-0-1034"></a>                <span class="k">pass</span>
<a id="__codelineno-0-1035" name="__codelineno-0-1035"></a>
<a id="__codelineno-0-1036" name="__codelineno-0-1036"></a>            <span class="n">idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_idxs</span><span class="p">)</span>
<a id="__codelineno-0-1037" name="__codelineno-0-1037"></a>
<a id="__codelineno-0-1038" name="__codelineno-0-1038"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">idxs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1039" name="__codelineno-0-1039"></a>            <span class="n">remove_idxs</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">intersect1d</span><span class="p">,</span>
<a id="__codelineno-0-1040" name="__codelineno-0-1040"></a>                                 <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">idxs</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)))</span>
<a id="__codelineno-0-1041" name="__codelineno-0-1041"></a>            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-1042" name="__codelineno-0-1042"></a>                <span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">],</span> <span class="n">remove_idxs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-1043" name="__codelineno-0-1043"></a>
<a id="__codelineno-0-1044" name="__codelineno-0-1044"></a>        <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict.DataDict.__add__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__add__</span><span class="p">(</span><span class="n">newdata</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Adding two datadicts by appending each data array.</p>
<p>Requires that the datadicts have the same structure.
Retains the meta information of the first array.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>newdata</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="labcore.data.datadict.DataDict" href="#labcore.data.datadict.DataDict">DataDict</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>DataDict to be added.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="labcore.data.datadict.DataDict" href="#labcore.data.datadict.DataDict">DataDict</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>combined DataDict.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-785">785</a></span>
<span class="normal"><a href="#__codelineno-0-786">786</a></span>
<span class="normal"><a href="#__codelineno-0-787">787</a></span>
<span class="normal"><a href="#__codelineno-0-788">788</a></span>
<span class="normal"><a href="#__codelineno-0-789">789</a></span>
<span class="normal"><a href="#__codelineno-0-790">790</a></span>
<span class="normal"><a href="#__codelineno-0-791">791</a></span>
<span class="normal"><a href="#__codelineno-0-792">792</a></span>
<span class="normal"><a href="#__codelineno-0-793">793</a></span>
<span class="normal"><a href="#__codelineno-0-794">794</a></span>
<span class="normal"><a href="#__codelineno-0-795">795</a></span>
<span class="normal"><a href="#__codelineno-0-796">796</a></span>
<span class="normal"><a href="#__codelineno-0-797">797</a></span>
<span class="normal"><a href="#__codelineno-0-798">798</a></span>
<span class="normal"><a href="#__codelineno-0-799">799</a></span>
<span class="normal"><a href="#__codelineno-0-800">800</a></span>
<span class="normal"><a href="#__codelineno-0-801">801</a></span>
<span class="normal"><a href="#__codelineno-0-802">802</a></span>
<span class="normal"><a href="#__codelineno-0-803">803</a></span>
<span class="normal"><a href="#__codelineno-0-804">804</a></span>
<span class="normal"><a href="#__codelineno-0-805">805</a></span>
<span class="normal"><a href="#__codelineno-0-806">806</a></span>
<span class="normal"><a href="#__codelineno-0-807">807</a></span>
<span class="normal"><a href="#__codelineno-0-808">808</a></span>
<span class="normal"><a href="#__codelineno-0-809">809</a></span>
<span class="normal"><a href="#__codelineno-0-810">810</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-785" name="__codelineno-0-785"></a><span class="k">def</span><span class="w"> </span><span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">newdata</span><span class="p">:</span> <span class="s1">&#39;DataDict&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DataDict&#39;</span><span class="p">:</span>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a><span class="sd">    Adding two datadicts by appending each data array.</span>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a><span class="sd">    Requires that the datadicts have the same structure.</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a><span class="sd">    Retains the meta information of the first array.</span>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a><span class="sd">    :param newdata: DataDict to be added.</span>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a><span class="sd">    :returns: combined DataDict.</span>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a><span class="sd">    :raises: ``ValueError`` if the structures are incompatible.</span>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a>    <span class="c1"># FIXME: remove shape</span>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a>    <span class="n">s</span> <span class="o">=</span> <span class="n">misc</span><span class="o">.</span><span class="n">unwrap_optional</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="p">(</span><span class="n">add_shape</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a>    <span class="k">if</span> <span class="n">DataDictBase</span><span class="o">.</span><span class="n">same_structure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">newdata</span><span class="p">):</span>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a>            <span class="n">val0</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a>            <span class="n">val1</span> <span class="o">=</span> <span class="n">newdata</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span>
<a id="__codelineno-0-803" name="__codelineno-0-803"></a>            <span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-804" name="__codelineno-0-804"></a>                <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">],</span>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a>                <span class="n">newdata</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">],</span>
<a id="__codelineno-0-806" name="__codelineno-0-806"></a>                <span class="n">axis</span><span class="o">=</span><span class="mi">0</span>
<a id="__codelineno-0-807" name="__codelineno-0-807"></a>            <span class="p">)</span>
<a id="__codelineno-0-808" name="__codelineno-0-808"></a>        <span class="k">return</span> <span class="n">s</span>
<a id="__codelineno-0-809" name="__codelineno-0-809"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Incompatible data structures.&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict.DataDict.add_data" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">add_data</span><span class="p">(</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Add data to all values. new data must be valid in itself.</p>
<p>This method is useful to easily add data without needing to specify
meta data or dependencies, etc.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>kw</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>one array per data field (none can be omitted).</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-838">838</a></span>
<span class="normal"><a href="#__codelineno-0-839">839</a></span>
<span class="normal"><a href="#__codelineno-0-840">840</a></span>
<span class="normal"><a href="#__codelineno-0-841">841</a></span>
<span class="normal"><a href="#__codelineno-0-842">842</a></span>
<span class="normal"><a href="#__codelineno-0-843">843</a></span>
<span class="normal"><a href="#__codelineno-0-844">844</a></span>
<span class="normal"><a href="#__codelineno-0-845">845</a></span>
<span class="normal"><a href="#__codelineno-0-846">846</a></span>
<span class="normal"><a href="#__codelineno-0-847">847</a></span>
<span class="normal"><a href="#__codelineno-0-848">848</a></span>
<span class="normal"><a href="#__codelineno-0-849">849</a></span>
<span class="normal"><a href="#__codelineno-0-850">850</a></span>
<span class="normal"><a href="#__codelineno-0-851">851</a></span>
<span class="normal"><a href="#__codelineno-0-852">852</a></span>
<span class="normal"><a href="#__codelineno-0-853">853</a></span>
<span class="normal"><a href="#__codelineno-0-854">854</a></span>
<span class="normal"><a href="#__codelineno-0-855">855</a></span>
<span class="normal"><a href="#__codelineno-0-856">856</a></span>
<span class="normal"><a href="#__codelineno-0-857">857</a></span>
<span class="normal"><a href="#__codelineno-0-858">858</a></span>
<span class="normal"><a href="#__codelineno-0-859">859</a></span>
<span class="normal"><a href="#__codelineno-0-860">860</a></span>
<span class="normal"><a href="#__codelineno-0-861">861</a></span>
<span class="normal"><a href="#__codelineno-0-862">862</a></span>
<span class="normal"><a href="#__codelineno-0-863">863</a></span>
<span class="normal"><a href="#__codelineno-0-864">864</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-838" name="__codelineno-0-838"></a><span class="k">def</span><span class="w"> </span><span class="nf">add_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a>    <span class="c1"># TODO: fill non-given data with nan or none</span>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a><span class="sd">    Add data to all values. new data must be valid in itself.</span>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a><span class="sd">    This method is useful to easily add data without needing to specify</span>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a><span class="sd">    meta data or dependencies, etc.</span>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a><span class="sd">    :param kw: one array per data field (none can be omitted).</span>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a>    <span class="n">dd</span> <span class="o">=</span> <span class="n">misc</span><span class="o">.</span><span class="n">unwrap_optional</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="p">(</span><span class="n">same_type</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a>    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">dd</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a>        <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">:</span>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a>            <span class="n">kw</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-852" name="__codelineno-0-852"></a>
<a id="__codelineno-0-853" name="__codelineno-0-853"></a>    <span class="n">records</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_records</span><span class="p">(</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span>
<a id="__codelineno-0-854" name="__codelineno-0-854"></a>    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">datavals</span> <span class="ow">in</span> <span class="n">records</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a>        <span class="n">dd</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datavals</span>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a>
<a id="__codelineno-0-857" name="__codelineno-0-857"></a>    <span class="k">if</span> <span class="n">dd</span><span class="o">.</span><span class="n">validate</span><span class="p">():</span>
<a id="__codelineno-0-858" name="__codelineno-0-858"></a>        <span class="n">nrecords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrecords</span><span class="p">()</span>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a>        <span class="k">if</span> <span class="n">nrecords</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">nrecords</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dd</span><span class="p">)</span>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a>            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">dd</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a>                <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">]</span>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict.DataDict.append" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">append</span><span class="p">(</span><span class="n">newdata</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Append a datadict to this one by appending data values.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>newdata</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="labcore.data.datadict.DataDict" href="#labcore.data.datadict.DataDict">DataDict</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>DataDict to append.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-812">812</a></span>
<span class="normal"><a href="#__codelineno-0-813">813</a></span>
<span class="normal"><a href="#__codelineno-0-814">814</a></span>
<span class="normal"><a href="#__codelineno-0-815">815</a></span>
<span class="normal"><a href="#__codelineno-0-816">816</a></span>
<span class="normal"><a href="#__codelineno-0-817">817</a></span>
<span class="normal"><a href="#__codelineno-0-818">818</a></span>
<span class="normal"><a href="#__codelineno-0-819">819</a></span>
<span class="normal"><a href="#__codelineno-0-820">820</a></span>
<span class="normal"><a href="#__codelineno-0-821">821</a></span>
<span class="normal"><a href="#__codelineno-0-822">822</a></span>
<span class="normal"><a href="#__codelineno-0-823">823</a></span>
<span class="normal"><a href="#__codelineno-0-824">824</a></span>
<span class="normal"><a href="#__codelineno-0-825">825</a></span>
<span class="normal"><a href="#__codelineno-0-826">826</a></span>
<span class="normal"><a href="#__codelineno-0-827">827</a></span>
<span class="normal"><a href="#__codelineno-0-828">828</a></span>
<span class="normal"><a href="#__codelineno-0-829">829</a></span>
<span class="normal"><a href="#__codelineno-0-830">830</a></span>
<span class="normal"><a href="#__codelineno-0-831">831</a></span>
<span class="normal"><a href="#__codelineno-0-832">832</a></span>
<span class="normal"><a href="#__codelineno-0-833">833</a></span>
<span class="normal"><a href="#__codelineno-0-834">834</a></span>
<span class="normal"><a href="#__codelineno-0-835">835</a></span>
<span class="normal"><a href="#__codelineno-0-836">836</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-812" name="__codelineno-0-812"></a><span class="k">def</span><span class="w"> </span><span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">newdata</span><span class="p">:</span> <span class="s2">&quot;DataDict&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a><span class="sd">    Append a datadict to this one by appending data values.</span>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a><span class="sd">    :param newdata: DataDict to append.</span>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a><span class="sd">    :raises: ``ValueError``, if the structures are incompatible.</span>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">DataDictBase</span><span class="o">.</span><span class="n">same_structure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">newdata</span><span class="p">):</span>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Incompatible data structures.&#39;</span><span class="p">)</span>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a>    <span class="n">newvals</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a>    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">newdata</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">],</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a>                <span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a>            <span class="n">newvals</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">]</span>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a>            <span class="n">newvals</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a>                <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">],</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a>                <span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">],</span>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a>                <span class="n">axis</span><span class="o">=</span><span class="mi">0</span>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a>            <span class="p">)</span>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a>    <span class="c1"># only actually</span>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a>    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">newvals</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a>        <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict.DataDict.expand" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">expand</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Expand nested values in the data fields.</p>
<p>Flattens all value arrays. If nested dimensions
are present, all data with non-nested dims will be repeated
accordingly -- each record is repeated to match the size of
the nested dims.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="labcore.data.datadict.DataDict" href="#labcore.data.datadict.DataDict">DataDict</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The flattened dataset.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-915">915</a></span>
<span class="normal"><a href="#__codelineno-0-916">916</a></span>
<span class="normal"><a href="#__codelineno-0-917">917</a></span>
<span class="normal"><a href="#__codelineno-0-918">918</a></span>
<span class="normal"><a href="#__codelineno-0-919">919</a></span>
<span class="normal"><a href="#__codelineno-0-920">920</a></span>
<span class="normal"><a href="#__codelineno-0-921">921</a></span>
<span class="normal"><a href="#__codelineno-0-922">922</a></span>
<span class="normal"><a href="#__codelineno-0-923">923</a></span>
<span class="normal"><a href="#__codelineno-0-924">924</a></span>
<span class="normal"><a href="#__codelineno-0-925">925</a></span>
<span class="normal"><a href="#__codelineno-0-926">926</a></span>
<span class="normal"><a href="#__codelineno-0-927">927</a></span>
<span class="normal"><a href="#__codelineno-0-928">928</a></span>
<span class="normal"><a href="#__codelineno-0-929">929</a></span>
<span class="normal"><a href="#__codelineno-0-930">930</a></span>
<span class="normal"><a href="#__codelineno-0-931">931</a></span>
<span class="normal"><a href="#__codelineno-0-932">932</a></span>
<span class="normal"><a href="#__codelineno-0-933">933</a></span>
<span class="normal"><a href="#__codelineno-0-934">934</a></span>
<span class="normal"><a href="#__codelineno-0-935">935</a></span>
<span class="normal"><a href="#__codelineno-0-936">936</a></span>
<span class="normal"><a href="#__codelineno-0-937">937</a></span>
<span class="normal"><a href="#__codelineno-0-938">938</a></span>
<span class="normal"><a href="#__codelineno-0-939">939</a></span>
<span class="normal"><a href="#__codelineno-0-940">940</a></span>
<span class="normal"><a href="#__codelineno-0-941">941</a></span>
<span class="normal"><a href="#__codelineno-0-942">942</a></span>
<span class="normal"><a href="#__codelineno-0-943">943</a></span>
<span class="normal"><a href="#__codelineno-0-944">944</a></span>
<span class="normal"><a href="#__codelineno-0-945">945</a></span>
<span class="normal"><a href="#__codelineno-0-946">946</a></span>
<span class="normal"><a href="#__codelineno-0-947">947</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-915" name="__codelineno-0-915"></a><span class="k">def</span><span class="w"> </span><span class="nf">expand</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DataDict&#39;</span><span class="p">:</span>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-917" name="__codelineno-0-917"></a><span class="sd">    Expand nested values in the data fields.</span>
<a id="__codelineno-0-918" name="__codelineno-0-918"></a>
<a id="__codelineno-0-919" name="__codelineno-0-919"></a><span class="sd">    Flattens all value arrays. If nested dimensions</span>
<a id="__codelineno-0-920" name="__codelineno-0-920"></a><span class="sd">    are present, all data with non-nested dims will be repeated</span>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a><span class="sd">    accordingly -- each record is repeated to match the size of</span>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a><span class="sd">    the nested dims.</span>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a><span class="sd">    :return: The flattened dataset.</span>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a><span class="sd">    :raises: ``ValueError`` if data is not expandable.</span>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_expandable</span><span class="p">():</span>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Data cannot be expanded.&#39;</span><span class="p">)</span>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a>    <span class="n">struct</span> <span class="o">=</span> <span class="n">misc</span><span class="o">.</span><span class="n">unwrap_optional</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="p">(</span><span class="n">add_shape</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a>    <span class="n">ret</span> <span class="o">=</span> <span class="n">DataDict</span><span class="p">(</span><span class="o">**</span><span class="n">struct</span><span class="p">)</span>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_expanded</span><span class="p">():</span>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a>        <span class="k">return</span> <span class="bp">self</span>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a>    <span class="n">ishp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inner_shapes</span><span class="p">()</span>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a>    <span class="n">size</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">ishp</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a>    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-940" name="__codelineno-0-940"></a>        <span class="n">reps</span> <span class="o">=</span> <span class="n">size</span> <span class="o">//</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">ishp</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a>        <span class="k">if</span> <span class="n">reps</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a>            <span class="n">ret</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span> <span class="o">=</span> \
<a id="__codelineno-0-943" name="__codelineno-0-943"></a>                <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">reps</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-945" name="__codelineno-0-945"></a>            <span class="n">ret</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a>    <span class="k">return</span> <span class="n">ret</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict.DataDict.is_expandable" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">is_expandable</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Determine if the DataDict can be expanded.</p>
<p>Expansion flattens all nested data values to a 1D array. For doing so,
we require that all data fields that have nested/inner dimensions (i.e,
inside the <code>records</code> level) shape the inner shape.
In other words, all data fields must be of shape (N,) or (N, (shape)),
where shape is common to all that have a shape not equal to (N,).</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p><code>True</code> if expandable. <code>False</code> otherwise.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-895">895</a></span>
<span class="normal"><a href="#__codelineno-0-896">896</a></span>
<span class="normal"><a href="#__codelineno-0-897">897</a></span>
<span class="normal"><a href="#__codelineno-0-898">898</a></span>
<span class="normal"><a href="#__codelineno-0-899">899</a></span>
<span class="normal"><a href="#__codelineno-0-900">900</a></span>
<span class="normal"><a href="#__codelineno-0-901">901</a></span>
<span class="normal"><a href="#__codelineno-0-902">902</a></span>
<span class="normal"><a href="#__codelineno-0-903">903</a></span>
<span class="normal"><a href="#__codelineno-0-904">904</a></span>
<span class="normal"><a href="#__codelineno-0-905">905</a></span>
<span class="normal"><a href="#__codelineno-0-906">906</a></span>
<span class="normal"><a href="#__codelineno-0-907">907</a></span>
<span class="normal"><a href="#__codelineno-0-908">908</a></span>
<span class="normal"><a href="#__codelineno-0-909">909</a></span>
<span class="normal"><a href="#__codelineno-0-910">910</a></span>
<span class="normal"><a href="#__codelineno-0-911">911</a></span>
<span class="normal"><a href="#__codelineno-0-912">912</a></span>
<span class="normal"><a href="#__codelineno-0-913">913</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-895" name="__codelineno-0-895"></a><span class="k">def</span><span class="w"> </span><span class="nf">is_expandable</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a><span class="sd">    Determine if the DataDict can be expanded.</span>
<a id="__codelineno-0-898" name="__codelineno-0-898"></a>
<a id="__codelineno-0-899" name="__codelineno-0-899"></a><span class="sd">    Expansion flattens all nested data values to a 1D array. For doing so,</span>
<a id="__codelineno-0-900" name="__codelineno-0-900"></a><span class="sd">    we require that all data fields that have nested/inner dimensions (i.e,</span>
<a id="__codelineno-0-901" name="__codelineno-0-901"></a><span class="sd">    inside the `records` level) shape the inner shape.</span>
<a id="__codelineno-0-902" name="__codelineno-0-902"></a><span class="sd">    In other words, all data fields must be of shape (N,) or (N, (shape)),</span>
<a id="__codelineno-0-903" name="__codelineno-0-903"></a><span class="sd">    where shape is common to all that have a shape not equal to (N,).</span>
<a id="__codelineno-0-904" name="__codelineno-0-904"></a>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a><span class="sd">    :return: ``True`` if expandable. ``False`` otherwise.</span>
<a id="__codelineno-0-906" name="__codelineno-0-906"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-907" name="__codelineno-0-907"></a>    <span class="n">shp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inner_shapes</span><span class="p">()</span>
<a id="__codelineno-0-908" name="__codelineno-0-908"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">shp</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-909" name="__codelineno-0-909"></a>        <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-910" name="__codelineno-0-910"></a>    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">shp</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="nb">tuple</span><span class="p">()</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">shp</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
<a id="__codelineno-0-911" name="__codelineno-0-911"></a>        <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-912" name="__codelineno-0-912"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-913" name="__codelineno-0-913"></a>        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict.DataDict.is_expanded" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">is_expanded</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Determine if the DataDict is expanded.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p><code>True</code> if expanded. <code>False</code> if not.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-883">883</a></span>
<span class="normal"><a href="#__codelineno-0-884">884</a></span>
<span class="normal"><a href="#__codelineno-0-885">885</a></span>
<span class="normal"><a href="#__codelineno-0-886">886</a></span>
<span class="normal"><a href="#__codelineno-0-887">887</a></span>
<span class="normal"><a href="#__codelineno-0-888">888</a></span>
<span class="normal"><a href="#__codelineno-0-889">889</a></span>
<span class="normal"><a href="#__codelineno-0-890">890</a></span>
<span class="normal"><a href="#__codelineno-0-891">891</a></span>
<span class="normal"><a href="#__codelineno-0-892">892</a></span>
<span class="normal"><a href="#__codelineno-0-893">893</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-883" name="__codelineno-0-883"></a><span class="k">def</span><span class="w"> </span><span class="nf">is_expanded</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a><span class="sd">    Determine if the DataDict is expanded.</span>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a><span class="sd">    :return: ``True`` if expanded. ``False`` if not.</span>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a>    <span class="n">ishp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inner_shapes</span><span class="p">()</span>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a>    <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">ishp</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">==</span> <span class="p">{</span><span class="nb">tuple</span><span class="p">()}:</span>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a>        <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-893" name="__codelineno-0-893"></a>        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict.DataDict.nrecords" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">nrecords</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Gets the number of records in the dataset.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Optional">Optional</span>[int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of records in the dataset.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-868">868</a></span>
<span class="normal"><a href="#__codelineno-0-869">869</a></span>
<span class="normal"><a href="#__codelineno-0-870">870</a></span>
<span class="normal"><a href="#__codelineno-0-871">871</a></span>
<span class="normal"><a href="#__codelineno-0-872">872</a></span>
<span class="normal"><a href="#__codelineno-0-873">873</a></span>
<span class="normal"><a href="#__codelineno-0-874">874</a></span>
<span class="normal"><a href="#__codelineno-0-875">875</a></span>
<span class="normal"><a href="#__codelineno-0-876">876</a></span>
<span class="normal"><a href="#__codelineno-0-877">877</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-868" name="__codelineno-0-868"></a><span class="k">def</span><span class="w"> </span><span class="nf">nrecords</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a><span class="sd">    Gets the number of records in the dataset.</span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a><span class="sd">    :return: The number of records in the dataset.</span>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a>    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">])</span>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a>    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict.DataDict.remove_invalid_entries" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">remove_invalid_entries</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Remove all rows that are <code>None</code> or <code>np.nan</code> in <em>all</em> dependents.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="labcore.data.datadict.DataDict" href="#labcore.data.datadict.DataDict">DataDict</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The cleaned DataDict.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span>
<span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span>
<span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span>
<span class="normal"><a href="#__codelineno-0-1016">1016</a></span>
<span class="normal"><a href="#__codelineno-0-1017">1017</a></span>
<span class="normal"><a href="#__codelineno-0-1018">1018</a></span>
<span class="normal"><a href="#__codelineno-0-1019">1019</a></span>
<span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span>
<span class="normal"><a href="#__codelineno-0-1035">1035</a></span>
<span class="normal"><a href="#__codelineno-0-1036">1036</a></span>
<span class="normal"><a href="#__codelineno-0-1037">1037</a></span>
<span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span>
<span class="normal"><a href="#__codelineno-0-1040">1040</a></span>
<span class="normal"><a href="#__codelineno-0-1041">1041</a></span>
<span class="normal"><a href="#__codelineno-0-1042">1042</a></span>
<span class="normal"><a href="#__codelineno-0-1043">1043</a></span>
<span class="normal"><a href="#__codelineno-0-1044">1044</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-997" name="__codelineno-0-997"></a><span class="k">def</span><span class="w"> </span><span class="nf">remove_invalid_entries</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DataDict&#39;</span><span class="p">:</span>
<a id="__codelineno-0-998" name="__codelineno-0-998"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-999" name="__codelineno-0-999"></a><span class="sd">    Remove all rows that are ``None`` or ``np.nan`` in *all* dependents.</span>
<a id="__codelineno-0-1000" name="__codelineno-0-1000"></a>
<a id="__codelineno-0-1001" name="__codelineno-0-1001"></a><span class="sd">    :return: The cleaned DataDict.</span>
<a id="__codelineno-0-1002" name="__codelineno-0-1002"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1003" name="__codelineno-0-1003"></a>    <span class="n">ishp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inner_shapes</span><span class="p">()</span>
<a id="__codelineno-0-1004" name="__codelineno-0-1004"></a>    <span class="n">idxs</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1005" name="__codelineno-0-1005"></a>
<a id="__codelineno-0-1006" name="__codelineno-0-1006"></a>    <span class="c1"># collect rows that are completely invalid</span>
<a id="__codelineno-0-1007" name="__codelineno-0-1007"></a>    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dependents</span><span class="p">():</span>
<a id="__codelineno-0-1008" name="__codelineno-0-1008"></a>
<a id="__codelineno-0-1009" name="__codelineno-0-1009"></a>        <span class="c1">#  need to discriminate whether there are nested dims or not</span>
<a id="__codelineno-0-1010" name="__codelineno-0-1010"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ishp</span><span class="p">[</span><span class="n">d</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1011" name="__codelineno-0-1011"></a>            <span class="n">rows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_vals</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<a id="__codelineno-0-1012" name="__codelineno-0-1012"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1013" name="__codelineno-0-1013"></a>            <span class="n">datavals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_vals</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<a id="__codelineno-0-1014" name="__codelineno-0-1014"></a>            <span class="n">rows</span> <span class="o">=</span> <span class="n">datavals</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">ishp</span><span class="p">[</span><span class="n">d</span><span class="p">])))</span>
<a id="__codelineno-0-1015" name="__codelineno-0-1015"></a>
<a id="__codelineno-0-1016" name="__codelineno-0-1016"></a>        <span class="n">_idxs</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<a id="__codelineno-0-1017" name="__codelineno-0-1017"></a>
<a id="__codelineno-0-1018" name="__codelineno-0-1018"></a>        <span class="c1"># get indices of all rows that are fully None</span>
<a id="__codelineno-0-1019" name="__codelineno-0-1019"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ishp</span><span class="p">[</span><span class="n">d</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1020" name="__codelineno-0-1020"></a>            <span class="n">_newidxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">rows</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">))</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1021" name="__codelineno-0-1021"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1022" name="__codelineno-0-1022"></a>            <span class="n">_newidxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">rows</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)))</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1023" name="__codelineno-0-1023"></a>        <span class="n">_idxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_idxs</span><span class="p">,</span> <span class="n">_newidxs</span><span class="p">)</span>
<a id="__codelineno-0-1024" name="__codelineno-0-1024"></a>
<a id="__codelineno-0-1025" name="__codelineno-0-1025"></a>        <span class="c1"># get indices for all rows that are fully NaN. works only</span>
<a id="__codelineno-0-1026" name="__codelineno-0-1026"></a>        <span class="c1"># for some dtypes, so except TypeErrors.</span>
<a id="__codelineno-0-1027" name="__codelineno-0-1027"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-1028" name="__codelineno-0-1028"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ishp</span><span class="p">[</span><span class="n">d</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1029" name="__codelineno-0-1029"></a>                <span class="n">_newidxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">rows</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1030" name="__codelineno-0-1030"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1031" name="__codelineno-0-1031"></a>                <span class="n">_newidxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">rows</span><span class="p">),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1032" name="__codelineno-0-1032"></a>            <span class="n">_idxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_idxs</span><span class="p">,</span> <span class="n">_newidxs</span><span class="p">)</span>
<a id="__codelineno-0-1033" name="__codelineno-0-1033"></a>        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
<a id="__codelineno-0-1034" name="__codelineno-0-1034"></a>            <span class="k">pass</span>
<a id="__codelineno-0-1035" name="__codelineno-0-1035"></a>
<a id="__codelineno-0-1036" name="__codelineno-0-1036"></a>        <span class="n">idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_idxs</span><span class="p">)</span>
<a id="__codelineno-0-1037" name="__codelineno-0-1037"></a>
<a id="__codelineno-0-1038" name="__codelineno-0-1038"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">idxs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1039" name="__codelineno-0-1039"></a>        <span class="n">remove_idxs</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">intersect1d</span><span class="p">,</span>
<a id="__codelineno-0-1040" name="__codelineno-0-1040"></a>                             <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">idxs</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)))</span>
<a id="__codelineno-0-1041" name="__codelineno-0-1041"></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-1042" name="__codelineno-0-1042"></a>            <span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">],</span> <span class="n">remove_idxs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-1043" name="__codelineno-0-1043"></a>
<a id="__codelineno-0-1044" name="__codelineno-0-1044"></a>    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict.DataDict.sanitize" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">sanitize</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Clean-up.</p>
<p>Beyond the tasks of the base class <code>DataDictBase</code>:
    * remove invalid entries as far as reasonable.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="labcore.data.datadict.DataDict" href="#labcore.data.datadict.DataDict">DataDict</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>sanitized DataDict.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-985">985</a></span>
<span class="normal"><a href="#__codelineno-0-986">986</a></span>
<span class="normal"><a href="#__codelineno-0-987">987</a></span>
<span class="normal"><a href="#__codelineno-0-988">988</a></span>
<span class="normal"><a href="#__codelineno-0-989">989</a></span>
<span class="normal"><a href="#__codelineno-0-990">990</a></span>
<span class="normal"><a href="#__codelineno-0-991">991</a></span>
<span class="normal"><a href="#__codelineno-0-992">992</a></span>
<span class="normal"><a href="#__codelineno-0-993">993</a></span>
<span class="normal"><a href="#__codelineno-0-994">994</a></span>
<span class="normal"><a href="#__codelineno-0-995">995</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-985" name="__codelineno-0-985"></a><span class="k">def</span><span class="w"> </span><span class="nf">sanitize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DataDict&quot;</span><span class="p">:</span>
<a id="__codelineno-0-986" name="__codelineno-0-986"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-987" name="__codelineno-0-987"></a><span class="sd">    Clean-up.</span>
<a id="__codelineno-0-988" name="__codelineno-0-988"></a>
<a id="__codelineno-0-989" name="__codelineno-0-989"></a><span class="sd">    Beyond the tasks of the base class ``DataDictBase``:</span>
<a id="__codelineno-0-990" name="__codelineno-0-990"></a><span class="sd">        * remove invalid entries as far as reasonable.</span>
<a id="__codelineno-0-991" name="__codelineno-0-991"></a>
<a id="__codelineno-0-992" name="__codelineno-0-992"></a><span class="sd">    :return: sanitized DataDict.</span>
<a id="__codelineno-0-993" name="__codelineno-0-993"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-994" name="__codelineno-0-994"></a>    <span class="n">ret</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">sanitize</span><span class="p">()</span>
<a id="__codelineno-0-995" name="__codelineno-0-995"></a>    <span class="k">return</span> <span class="n">ret</span><span class="o">.</span><span class="n">remove_invalid_entries</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict.DataDict.validate" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">validate</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Check dataset validity.</p>
<p>Beyond the checks performed in the base class <code>DataDictBase</code>,
check whether the number of records is the same for all data fields.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p><code>True</code> if valid.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-951">951</a></span>
<span class="normal"><a href="#__codelineno-0-952">952</a></span>
<span class="normal"><a href="#__codelineno-0-953">953</a></span>
<span class="normal"><a href="#__codelineno-0-954">954</a></span>
<span class="normal"><a href="#__codelineno-0-955">955</a></span>
<span class="normal"><a href="#__codelineno-0-956">956</a></span>
<span class="normal"><a href="#__codelineno-0-957">957</a></span>
<span class="normal"><a href="#__codelineno-0-958">958</a></span>
<span class="normal"><a href="#__codelineno-0-959">959</a></span>
<span class="normal"><a href="#__codelineno-0-960">960</a></span>
<span class="normal"><a href="#__codelineno-0-961">961</a></span>
<span class="normal"><a href="#__codelineno-0-962">962</a></span>
<span class="normal"><a href="#__codelineno-0-963">963</a></span>
<span class="normal"><a href="#__codelineno-0-964">964</a></span>
<span class="normal"><a href="#__codelineno-0-965">965</a></span>
<span class="normal"><a href="#__codelineno-0-966">966</a></span>
<span class="normal"><a href="#__codelineno-0-967">967</a></span>
<span class="normal"><a href="#__codelineno-0-968">968</a></span>
<span class="normal"><a href="#__codelineno-0-969">969</a></span>
<span class="normal"><a href="#__codelineno-0-970">970</a></span>
<span class="normal"><a href="#__codelineno-0-971">971</a></span>
<span class="normal"><a href="#__codelineno-0-972">972</a></span>
<span class="normal"><a href="#__codelineno-0-973">973</a></span>
<span class="normal"><a href="#__codelineno-0-974">974</a></span>
<span class="normal"><a href="#__codelineno-0-975">975</a></span>
<span class="normal"><a href="#__codelineno-0-976">976</a></span>
<span class="normal"><a href="#__codelineno-0-977">977</a></span>
<span class="normal"><a href="#__codelineno-0-978">978</a></span>
<span class="normal"><a href="#__codelineno-0-979">979</a></span>
<span class="normal"><a href="#__codelineno-0-980">980</a></span>
<span class="normal"><a href="#__codelineno-0-981">981</a></span>
<span class="normal"><a href="#__codelineno-0-982">982</a></span>
<span class="normal"><a href="#__codelineno-0-983">983</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-951" name="__codelineno-0-951"></a><span class="k">def</span><span class="w"> </span><span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-953" name="__codelineno-0-953"></a><span class="sd">    Check dataset validity.</span>
<a id="__codelineno-0-954" name="__codelineno-0-954"></a>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a><span class="sd">    Beyond the checks performed in the base class ``DataDictBase``,</span>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a><span class="sd">    check whether the number of records is the same for all data fields.</span>
<a id="__codelineno-0-957" name="__codelineno-0-957"></a>
<a id="__codelineno-0-958" name="__codelineno-0-958"></a><span class="sd">    :return: ``True`` if valid.</span>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a><span class="sd">    :raises: ``ValueError`` if invalid.</span>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-961" name="__codelineno-0-961"></a>    <span class="k">if</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">validate</span><span class="p">():</span>
<a id="__codelineno-0-962" name="__codelineno-0-962"></a>        <span class="n">nvals</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-963" name="__codelineno-0-963"></a>        <span class="n">nvalsrc</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-964" name="__codelineno-0-964"></a>        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-965" name="__codelineno-0-965"></a>
<a id="__codelineno-0-966" name="__codelineno-0-966"></a>        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-967" name="__codelineno-0-967"></a>            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">])</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<a id="__codelineno-0-968" name="__codelineno-0-968"></a>                                         <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">MaskedArray</span><span class="p">]:</span>
<a id="__codelineno-0-969" name="__codelineno-0-969"></a>                <span class="bp">self</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">])</span>
<a id="__codelineno-0-970" name="__codelineno-0-970"></a>
<a id="__codelineno-0-971" name="__codelineno-0-971"></a>            <span class="k">if</span> <span class="n">nvals</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-972" name="__codelineno-0-972"></a>                <span class="n">nvals</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">])</span>
<a id="__codelineno-0-973" name="__codelineno-0-973"></a>                <span class="n">nvalsrc</span> <span class="o">=</span> <span class="n">n</span>
<a id="__codelineno-0-974" name="__codelineno-0-974"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-975" name="__codelineno-0-975"></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">])</span> <span class="o">!=</span> <span class="n">nvals</span><span class="p">:</span>
<a id="__codelineno-0-976" name="__codelineno-0-976"></a>                    <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot; * &#39;</span><span class="si">{}</span><span class="s2">&#39; has length </span><span class="si">{}</span><span class="s2">, but have found </span><span class="si">{}</span><span class="s2"> in &quot;</span> \
<a id="__codelineno-0-977" name="__codelineno-0-977"></a>                           <span class="s2">&quot;&#39;</span><span class="si">{}</span><span class="s2">&#39;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-978" name="__codelineno-0-978"></a>                        <span class="n">n</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">]),</span> <span class="n">nvals</span><span class="p">,</span> <span class="n">nvalsrc</span><span class="p">)</span>
<a id="__codelineno-0-979" name="__codelineno-0-979"></a>
<a id="__codelineno-0-980" name="__codelineno-0-980"></a>        <span class="k">if</span> <span class="n">msg</span> <span class="o">!=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span>
<a id="__codelineno-0-981" name="__codelineno-0-981"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<a id="__codelineno-0-982" name="__codelineno-0-982"></a>
<a id="__codelineno-0-983" name="__codelineno-0-983"></a>    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="labcore.data.datadict.DataDictBase" class="doc doc-heading">
          <code>DataDictBase</code>


</h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code>dict</code></p>

  
      <p>Simple data storage class that is based on a regular dictionary.</p>
<p>This base class does not make assumptions about the structure of the
values. This is implemented in inheriting classes.</p>

            <details class="quote">
              <summary>Source code in <code>labcore/data/datadict.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span>
<span class="normal"><a href="#__codelineno-0-688">688</a></span>
<span class="normal"><a href="#__codelineno-0-689">689</a></span>
<span class="normal"><a href="#__codelineno-0-690">690</a></span>
<span class="normal"><a href="#__codelineno-0-691">691</a></span>
<span class="normal"><a href="#__codelineno-0-692">692</a></span>
<span class="normal"><a href="#__codelineno-0-693">693</a></span>
<span class="normal"><a href="#__codelineno-0-694">694</a></span>
<span class="normal"><a href="#__codelineno-0-695">695</a></span>
<span class="normal"><a href="#__codelineno-0-696">696</a></span>
<span class="normal"><a href="#__codelineno-0-697">697</a></span>
<span class="normal"><a href="#__codelineno-0-698">698</a></span>
<span class="normal"><a href="#__codelineno-0-699">699</a></span>
<span class="normal"><a href="#__codelineno-0-700">700</a></span>
<span class="normal"><a href="#__codelineno-0-701">701</a></span>
<span class="normal"><a href="#__codelineno-0-702">702</a></span>
<span class="normal"><a href="#__codelineno-0-703">703</a></span>
<span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span>
<span class="normal"><a href="#__codelineno-0-709">709</a></span>
<span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span>
<span class="normal"><a href="#__codelineno-0-716">716</a></span>
<span class="normal"><a href="#__codelineno-0-717">717</a></span>
<span class="normal"><a href="#__codelineno-0-718">718</a></span>
<span class="normal"><a href="#__codelineno-0-719">719</a></span>
<span class="normal"><a href="#__codelineno-0-720">720</a></span>
<span class="normal"><a href="#__codelineno-0-721">721</a></span>
<span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span>
<span class="normal"><a href="#__codelineno-0-725">725</a></span>
<span class="normal"><a href="#__codelineno-0-726">726</a></span>
<span class="normal"><a href="#__codelineno-0-727">727</a></span>
<span class="normal"><a href="#__codelineno-0-728">728</a></span>
<span class="normal"><a href="#__codelineno-0-729">729</a></span>
<span class="normal"><a href="#__codelineno-0-730">730</a></span>
<span class="normal"><a href="#__codelineno-0-731">731</a></span>
<span class="normal"><a href="#__codelineno-0-732">732</a></span>
<span class="normal"><a href="#__codelineno-0-733">733</a></span>
<span class="normal"><a href="#__codelineno-0-734">734</a></span>
<span class="normal"><a href="#__codelineno-0-735">735</a></span>
<span class="normal"><a href="#__codelineno-0-736">736</a></span>
<span class="normal"><a href="#__codelineno-0-737">737</a></span>
<span class="normal"><a href="#__codelineno-0-738">738</a></span>
<span class="normal"><a href="#__codelineno-0-739">739</a></span>
<span class="normal"><a href="#__codelineno-0-740">740</a></span>
<span class="normal"><a href="#__codelineno-0-741">741</a></span>
<span class="normal"><a href="#__codelineno-0-742">742</a></span>
<span class="normal"><a href="#__codelineno-0-743">743</a></span>
<span class="normal"><a href="#__codelineno-0-744">744</a></span>
<span class="normal"><a href="#__codelineno-0-745">745</a></span>
<span class="normal"><a href="#__codelineno-0-746">746</a></span>
<span class="normal"><a href="#__codelineno-0-747">747</a></span>
<span class="normal"><a href="#__codelineno-0-748">748</a></span>
<span class="normal"><a href="#__codelineno-0-749">749</a></span>
<span class="normal"><a href="#__codelineno-0-750">750</a></span>
<span class="normal"><a href="#__codelineno-0-751">751</a></span>
<span class="normal"><a href="#__codelineno-0-752">752</a></span>
<span class="normal"><a href="#__codelineno-0-753">753</a></span>
<span class="normal"><a href="#__codelineno-0-754">754</a></span>
<span class="normal"><a href="#__codelineno-0-755">755</a></span>
<span class="normal"><a href="#__codelineno-0-756">756</a></span>
<span class="normal"><a href="#__codelineno-0-757">757</a></span>
<span class="normal"><a href="#__codelineno-0-758">758</a></span>
<span class="normal"><a href="#__codelineno-0-759">759</a></span>
<span class="normal"><a href="#__codelineno-0-760">760</a></span>
<span class="normal"><a href="#__codelineno-0-761">761</a></span>
<span class="normal"><a href="#__codelineno-0-762">762</a></span>
<span class="normal"><a href="#__codelineno-0-763">763</a></span>
<span class="normal"><a href="#__codelineno-0-764">764</a></span>
<span class="normal"><a href="#__codelineno-0-765">765</a></span>
<span class="normal"><a href="#__codelineno-0-766">766</a></span>
<span class="normal"><a href="#__codelineno-0-767">767</a></span>
<span class="normal"><a href="#__codelineno-0-768">768</a></span>
<span class="normal"><a href="#__codelineno-0-769">769</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="k">class</span><span class="w"> </span><span class="nc">DataDictBase</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">    Simple data storage class that is based on a regular dictionary.</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">    This base class does not make assumptions about the structure of the</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">    values. This is implemented in inheriting classes.</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">d_</span> <span class="o">=</span> <span class="n">DataDictBase</span><span class="o">.</span><span class="n">_DataAccess</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> 
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check for content equality of two datadicts.&quot;&quot;&quot;</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">DataDictBase</span><span class="p">):</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>            <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>            <span class="k">return</span> <span class="n">datasets_are_equal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>        <span class="n">ret</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">dn</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dependents</span><span class="p">()):</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>            <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>                <span class="n">ret</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>            <span class="n">ret</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="n">dn</span><span class="p">)</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="bp">self</span><span class="p">[</span><span class="n">dn</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>            <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">dn</span><span class="p">):</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>                <span class="n">ret</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  </span><span class="se">\u2319</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="bp">self</span><span class="p">[</span><span class="n">ax</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>        <span class="k">return</span> <span class="n">ret</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>    <span class="c1"># Assignment and retrieval of data and meta data</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_is_meta_key</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>        <span class="k">return</span> <span class="n">is_meta_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_meta_key_to_name</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="k">return</span> <span class="n">meta_key_to_name</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_meta_name_to_key</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>        <span class="k">return</span> <span class="n">meta_name_to_key</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_records</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert data to records that can be added to the ``DataDict``.</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">        All data is converted to np.array, and reshaped such that the first dimension of all resulting</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">        arrays have the same length (chosen to be the smallest possible number</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">        that does not alter any shapes beyond adding a length-1 dimension as</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">        first dimension, if necessary).</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">        If a data field is given as ``None``, it will be converted to ``numpy.array([numpy.nan])``.</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">        :param data: keyword arguments for each data field followed by data.</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">        :returns: Dictionary with properly shaped data.</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>        <span class="n">records</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>        <span class="n">seqtypes</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>        <span class="n">nantypes</span> <span class="o">=</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span> <span class="p">)</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">seqtypes</span><span class="p">):</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>                <span class="n">records</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">nantypes</span><span class="p">):</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>                <span class="n">records</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>                <span class="n">records</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">v</span><span class="p">])</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>        <span class="n">possible_nrecords</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">records</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>            <span class="n">possible_nrecords</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>        <span class="n">commons</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">possible_nrecords</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>                <span class="k">if</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">commons</span><span class="p">:</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>                    <span class="k">continue</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>                <span class="n">is_common</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>                <span class="k">for</span> <span class="n">kk</span><span class="p">,</span> <span class="n">vv</span> <span class="ow">in</span> <span class="n">possible_nrecords</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>                    <span class="k">if</span> <span class="n">n</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">vv</span><span class="p">:</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>                        <span class="n">is_common</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>                <span class="k">if</span> <span class="n">is_common</span><span class="p">:</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>                    <span class="n">commons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>        <span class="n">nrecs</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">commons</span><span class="p">)</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">records</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>            <span class="n">shp</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>            <span class="k">if</span> <span class="n">nrecs</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">shp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>                <span class="n">newshp</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">shp</span><span class="p">))</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>                <span class="n">records</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">newshp</span><span class="p">)</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>        <span class="k">return</span> <span class="n">records</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">data_items</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]:</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">        Generator for data field items.</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">        Like dict.items(), but ignores meta data.</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">        :return: Generator yielding first the key of the data field and second its value.</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_meta_key</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>                <span class="k">yield</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">meta_items</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>                   <span class="n">clean_keys</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]:</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">        Generator for meta items.</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">        Like dict.items(), but yields `only` meta entries.</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">        The keys returned do not contain the underscores used internally.</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">        :param data: If ``None`` iterate over global meta data.</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">                     If it&#39;s the name of a data field, iterate over the meta</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">                     information of that field.</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">        :param clean_keys: If `True`, remove the underscore pre/suffix.</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">        :return: Generator yielding first the key of the data field and second its value.</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_meta_key</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>                    <span class="k">if</span> <span class="n">clean_keys</span><span class="p">:</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>                        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta_key_to_name</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>                    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>                        <span class="n">n</span> <span class="o">=</span> <span class="n">k</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>                    <span class="k">yield</span> <span class="n">n</span><span class="p">,</span> <span class="n">v</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">[</span><span class="n">data</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_meta_key</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>                    <span class="k">if</span> <span class="n">clean_keys</span><span class="p">:</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>                        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta_key_to_name</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>                    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>                        <span class="n">n</span> <span class="o">=</span> <span class="n">k</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>                    <span class="k">yield</span> <span class="n">n</span><span class="p">,</span> <span class="n">v</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">data_vals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">        Return the data values of field ``key``.</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">        Equivalent to ``DataDict[&#39;key&#39;].values``.</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">        :param key: Name of the data field.</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="sd">        :return: Values of the data field.</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_meta_key</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> is a meta key.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;values&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]))</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">has_meta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check whether meta field exists in the dataset.</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">        :return: ``True`` if it exists, ``False`` if it doesn&#39;t.</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>        <span class="n">k</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta_name_to_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>        <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>            <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">field_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>                <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">field_dict</span><span class="p">:</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>                    <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>            <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">meta_val</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">        Return the value of meta field ``key`` (given without underscore).</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">        :param key: Name of the meta field.</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">        :param data: ``None`` for global meta; name of data field for data meta.</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">        :return: The value of the meta information.</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>        <span class="n">k</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta_name_to_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>            <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>            <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">data</span><span class="p">][</span><span class="n">k</span><span class="p">]</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_meta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">        Add meta info to the dataset.</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">        If the key already exists, meta info will be overwritten.</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">        :param key: Name of the meta field (without underscores).</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">        :param value: Value of the meta information.</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="sd">        :param data: If ``None``, meta will be global; otherwise assigned to</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="sd">                     data field ``data``.</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>        <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta_name_to_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>            <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>            <span class="bp">self</span><span class="p">[</span><span class="n">data</span><span class="p">][</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>    <span class="n">set_meta</span> <span class="o">=</span> <span class="n">add_meta</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">delete_meta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">        Deletes specific meta data.</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">        :param key: Name of the meta field to remove.</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="sd">        :param data: If ``None``, this affects global meta; otherwise remove</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">                     from data field ``data``.</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>        <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta_name_to_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>            <span class="k">del</span> <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>            <span class="k">del</span> <span class="bp">self</span><span class="p">[</span><span class="n">data</span><span class="p">][</span><span class="n">key</span><span class="p">]</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">clear_meta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="sd">        Deletes all meta data.</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">        :param data: If not ``None``, delete all meta only from specified data field ``data``.</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">                     Else, deletes all top-level meta, as well as meta for all data fields.</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>            <span class="n">meta_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta_items</span><span class="p">()]</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>            <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">meta_list</span><span class="p">:</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">delete_meta</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>            <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>                <span class="n">data_meta_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta_items</span><span class="p">(</span><span class="n">d</span><span class="p">)]</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>                <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">data_meta_list</span><span class="p">:</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">delete_meta</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>            <span class="n">data_meta_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta_items</span><span class="p">(</span><span class="n">data</span><span class="p">)]</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>            <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">data_meta_list</span><span class="p">:</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">delete_meta</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">extract</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">T</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">include_meta</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>                <span class="n">copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">sanitize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">        Extract data from a dataset.</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">        Return a new datadict with all fields specified in ``data`` included.</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">        Will also take any axes fields along that have not been explicitly</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">        specified. Will return empty if ``data`` consists of only axes fields.</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">        :param data: Data field or list of data fields to be extracted.</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">        :param include_meta: If ``True``, include the global meta data.</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">                             data meta will always be included.</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a><span class="sd">        :param copy: If ``True``, data fields will be `deep copies &lt;https://docs.python.org/3/library/copy.html&gt;`__</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">                     of the original.</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">        :param sanitize: If ``True``, will run DataDictBase.sanitize before</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">                         returning.</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="sd">        :return: New DataDictBase containing only requested fields.</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>            <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="p">]</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>        <span class="c1"># include all the axes used by the data.</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>            <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>                <span class="k">if</span> <span class="n">a</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>                    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>        <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>            <span class="k">if</span> <span class="n">copy</span><span class="p">:</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>                <span class="n">ret</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">d</span><span class="p">])</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>                <span class="n">ret</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">d</span><span class="p">]</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>        <span class="k">if</span> <span class="n">include_meta</span><span class="p">:</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta_items</span><span class="p">():</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>                <span class="k">if</span> <span class="n">copy</span><span class="p">:</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>                    <span class="n">ret</span><span class="o">.</span><span class="n">add_meta</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>                    <span class="n">ret</span><span class="o">.</span><span class="n">add_meta</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>        <span class="k">if</span> <span class="n">sanitize</span><span class="p">:</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>            <span class="n">ret</span> <span class="o">=</span> <span class="n">ret</span><span class="o">.</span><span class="n">sanitize</span><span class="p">()</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>        <span class="n">ret</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>        <span class="k">return</span> <span class="n">ret</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>    <span class="c1"># info about structure</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">same_structure</span><span class="p">(</span><span class="o">*</span><span class="n">data</span><span class="p">:</span> <span class="n">T</span><span class="p">,</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>                       <span class="n">check_shape</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a><span class="sd">        Check if all supplied DataDicts share the same data structure</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="sd">        (i.e., dependents and axes).</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a><span class="sd">        Ignores meta data and values. Checks also for matching shapes if</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a><span class="sd">        `check_shape` is `True`.</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a><span class="sd">        :param data: The data sets to compare.</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a><span class="sd">        :param check_shape: Whether to include shape check in the comparison.</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a><span class="sd">        :return: ``True`` if the structure matches for all, else ``False``.</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>            <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">empty_structure</span><span class="p">(</span><span class="n">d</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>            <span class="n">s</span> <span class="o">=</span> <span class="n">misc</span><span class="o">.</span><span class="n">unwrap_optional</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">structure</span><span class="p">(</span><span class="n">include_meta</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">add_shape</span><span class="o">=</span><span class="n">check_shape</span><span class="p">))</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>                <span class="k">if</span> <span class="s1">&#39;values&#39;</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>                    <span class="k">del</span> <span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>            <span class="k">return</span> <span class="n">s</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>        <span class="n">s0</span> <span class="o">=</span> <span class="n">empty_structure</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>            <span class="k">if</span> <span class="n">d</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>                <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>            <span class="k">if</span> <span class="n">s0</span> <span class="o">!=</span> <span class="n">empty_structure</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>                <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>        <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">structure</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">T</span><span class="p">,</span> <span class="n">add_shape</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>                  <span class="n">include_meta</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>                  <span class="n">same_type</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>                  <span class="n">remove_data</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="sd">        Get the structure of the DataDict.</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a><span class="sd">        Return the datadict without values (`value` omitted in the dict).</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a><span class="sd">        :param add_shape: Deprecated -- ignored.</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a><span class="sd">        :param include_meta: If `True`, include the meta information in</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a><span class="sd">                             the returned dict.</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a><span class="sd">        :param same_type: If `True`, return type will be the one of the</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a><span class="sd">                          object this is called on. Else, DataDictBase.</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a><span class="sd">        :param remove_data: any data fields listed will be removed from</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a><span class="sd">                            the result, also when listed in any axes.</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a><span class="sd">        :return: The DataDict containing the structure only. The exact type</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a><span class="sd">                     is the same as the type of ``self``.</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>        <span class="k">if</span> <span class="n">add_shape</span><span class="p">:</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;&#39;add_shape&#39; is deprecated and will be ignored&quot;</span><span class="p">,</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>                          <span class="ne">DeprecationWarning</span><span class="p">)</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>        <span class="n">add_shape</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>        <span class="k">if</span> <span class="n">remove_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>            <span class="n">remove_data</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">():</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>            <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>            <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>                <span class="k">if</span> <span class="n">n</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">remove_data</span><span class="p">:</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>                    <span class="n">v2</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>                    <span class="n">v2</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>                    <span class="n">s</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">v2</span><span class="p">)</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>                    <span class="k">if</span> <span class="s1">&#39;axes&#39;</span> <span class="ow">in</span> <span class="n">s</span><span class="p">[</span><span class="n">n</span><span class="p">]:</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>                        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">remove_data</span><span class="p">:</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>                            <span class="k">if</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">s</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">&#39;axes&#39;</span><span class="p">]:</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>                                <span class="n">i</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">&#39;axes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>                                <span class="n">s</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">&#39;axes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>            <span class="k">if</span> <span class="n">include_meta</span><span class="p">:</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>                <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta_items</span><span class="p">():</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>                    <span class="n">s</span><span class="o">.</span><span class="n">add_meta</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>                <span class="n">s</span><span class="o">.</span><span class="n">clear_meta</span><span class="p">()</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>            <span class="k">if</span> <span class="n">same_type</span><span class="p">:</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>                <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="o">**</span><span class="n">s</span><span class="p">)</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>            <span class="k">return</span> <span class="n">s</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>        <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">nbytes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the size of data.</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a><span class="sd">        :param name: Name of the data field. if none, return size of </span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a><span class="sd">            entire datadict.</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a><span class="sd">        :return: size in bytes.</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">():</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>            <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>                <span class="k">return</span> <span class="nb">sum</span><span class="p">([</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">itemsize</span> 
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>                            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_items</span><span class="p">()])</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_vals</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_vals</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">itemsize</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>        <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a><span class="sd">        Get the label for a data field. If no label is present returns the</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a><span class="sd">        name of the data field as the label. If a unit is present, it will</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a><span class="sd">        be appended at the end in brackets: &quot;label (unit)&quot;.</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="sd">        :param name: Name of the data field.</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a><span class="sd">        :return: Labelled name.</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">():</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>            <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No field &#39;</span><span class="si">{}</span><span class="s2">&#39; present.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>            <span class="k">if</span> <span class="bp">self</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>                <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;label&#39;</span><span class="p">]</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>                <span class="n">n</span> <span class="o">=</span> <span class="n">name</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>            <span class="k">if</span> <span class="bp">self</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;unit&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>                <span class="n">n</span> <span class="o">+=</span> <span class="s1">&#39; (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;unit&#39;</span><span class="p">])</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>            <span class="k">return</span> <span class="n">n</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>        <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">axes_are_compatible</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a><span class="sd">        Check if all dependent data fields have the same axes.</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a><span class="sd">        This includes axes order.</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a><span class="sd">        :return: ``True`` or ``False``.</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>        <span class="n">axes</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dependents</span><span class="p">()):</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>                <span class="n">axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">!=</span> <span class="n">axes</span><span class="p">:</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>                    <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>        <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">axes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a><span class="sd">        Return a list of axes.</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a><span class="sd">        :param data: if ``None``, return all axes present in the dataset,</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a><span class="sd">                     otherwise only the axes of the dependent ``data``.</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a><span class="sd">        :return: The list of axes.</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>        <span class="n">lst</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>                <span class="k">if</span> <span class="s1">&#39;axes&#39;</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>                    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;axes&#39;</span><span class="p">]:</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>                        <span class="k">if</span> <span class="n">n</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">lst</span> <span class="ow">and</span> <span class="bp">self</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="p">[])</span> <span class="o">==</span> <span class="p">[]:</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>                            <span class="n">lst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>                <span class="n">dataseq</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">,)</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>                <span class="n">dataseq</span> <span class="o">=</span> <span class="n">data</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">dataseq</span><span class="p">:</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>                <span class="k">if</span> <span class="s1">&#39;axes&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">[</span><span class="n">n</span><span class="p">]:</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>                    <span class="k">continue</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>                <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">&#39;axes&#39;</span><span class="p">]:</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>                    <span class="k">if</span> <span class="n">m</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">lst</span> <span class="ow">and</span> <span class="bp">self</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="p">[])</span> <span class="o">==</span> <span class="p">[]:</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>                        <span class="n">lst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>        <span class="k">return</span> <span class="n">lst</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">dependents</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a><span class="sd">        Get all dependents in the dataset.</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a><span class="sd">        :return: A list of the names of dependents.</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>        <span class="n">ret</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="p">[]))</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>                <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>        <span class="k">return</span> <span class="n">ret</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">shapes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]]:</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a><span class="sd">        Get the shapes of all data fields.</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a><span class="sd">        :return: A dictionary of the form ``{key : shape}``, where shape is the</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a><span class="sd">                 np.shape-tuple of the data with name ``key``.</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>        <span class="n">shapes</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>            <span class="n">shapes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_vals</span><span class="p">(</span><span class="n">k</span><span class="p">))</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>        <span class="k">return</span> <span class="n">shapes</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>    <span class="c1"># validation and sanitizing</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a><span class="sd">        Check the validity of the dataset.</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a><span class="sd">        Checks performed:</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a><span class="sd">            * All axes specified with dependents must exist as data fields.</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a><span class="sd">        Other tasks performed:</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a><span class="sd">            * ``unit`` keys are created if omitted.</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a><span class="sd">            * ``label`` keys are created if omitted.</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a><span class="sd">            * ``shape`` meta information is updated with the correct values</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a><span class="sd">              (only if present already).</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a><span class="sd">        :return: ``True`` if valid, ``False`` if invalid.</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a><span class="sd">        :raises: ``ValueError`` if invalid.</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_update_data_access</span><span class="p">()</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a>        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a>        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>            <span class="k">if</span> <span class="s1">&#39;axes&#39;</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>                <span class="k">for</span> <span class="n">na</span> <span class="ow">in</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;axes&#39;</span><span class="p">]:</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a>                    <span class="k">if</span> <span class="n">na</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>                        <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot; * &#39;</span><span class="si">{}</span><span class="s2">&#39; has axis &#39;</span><span class="si">{}</span><span class="s2">&#39;, but no field &quot;</span> \
<a id="__codelineno-0-596" name="__codelineno-0-596"></a>                               <span class="s2">&quot;with name &#39;</span><span class="si">{}</span><span class="s2">&#39; registered.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a>                            <span class="n">n</span><span class="p">,</span> <span class="n">na</span><span class="p">,</span> <span class="n">na</span><span class="p">)</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>                    <span class="k">elif</span> <span class="n">na</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">():</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a>                        <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot; * &#39;</span><span class="si">{}</span><span class="s2">&#39; has axis &#39;</span><span class="si">{}</span><span class="s2">&#39;, but no independent &quot;</span> \
<a id="__codelineno-0-600" name="__codelineno-0-600"></a>                               <span class="s2">&quot;with name &#39;</span><span class="si">{}</span><span class="s2">&#39; registered.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a>                            <span class="n">n</span><span class="p">,</span> <span class="n">na</span><span class="p">,</span> <span class="n">na</span><span class="p">)</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a>                <span class="n">v</span><span class="p">[</span><span class="s1">&#39;axes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a>            <span class="k">if</span> <span class="s1">&#39;unit&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a>                <span class="n">v</span><span class="p">[</span><span class="s1">&#39;unit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a>            <span class="k">if</span> <span class="s1">&#39;label&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a>                <span class="n">v</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a>            <span class="n">vals</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;values&#39;</span><span class="p">,</span> <span class="p">[])</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a>            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">MaskedArray</span><span class="p">]:</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a>                <span class="n">vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>            <span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vals</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a>        <span class="k">if</span> <span class="n">msg</span> <span class="o">!=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a>        <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">remove_unused_axes</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a><span class="sd">        Removes axes not associated with dependents.</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a><span class="sd">        :return: Cleaned dataset.</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a>        <span class="n">dependents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dependents</span><span class="p">()</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a>        <span class="n">unused</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a>        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a>            <span class="n">used</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a>            <span class="k">if</span> <span class="n">n</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dependents</span><span class="p">:</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a>                <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">dependents</span><span class="p">:</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a>                    <span class="k">if</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">[</span><span class="n">m</span><span class="p">][</span><span class="s1">&#39;axes&#39;</span><span class="p">]:</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a>                        <span class="n">used</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a>                <span class="n">used</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">used</span><span class="p">:</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a>                <span class="n">unused</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a>        <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">unused</span><span class="p">:</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a>            <span class="k">del</span> <span class="bp">self</span><span class="p">[</span><span class="n">u</span><span class="p">]</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a>        <span class="k">return</span> <span class="bp">self</span>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">sanitize</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a><span class="sd">        Clean-up tasks:</span>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a><span class="sd">            * Removes unused axes.</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a><span class="sd">        :return: Sanitized dataset.</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">remove_unused_axes</span><span class="p">()</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a>    <span class="c1"># axes order tools</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">reorder_axes_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a>                             <span class="o">**</span><span class="n">pos</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a><span class="sd">        Get the indices that can reorder axes in a given way.</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a><span class="sd">        :param name: Name of the data field of which we want to reorder axes.</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a><span class="sd">        :param pos: New axes position in the form ``axis_name = new_position``.</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a><span class="sd">                    Non-specified axes positions are adjusted automatically.</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a><span class="sd">        :return: The tuple of new indices, and the list of axes names in the</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a><span class="sd">                 new order.</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>        <span class="n">axlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>        <span class="n">order</span> <span class="o">=</span> <span class="n">misc</span><span class="o">.</span><span class="n">reorder_indices_from_new_positions</span><span class="p">(</span><span class="n">axlist</span><span class="p">,</span> <span class="o">**</span><span class="n">pos</span><span class="p">)</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a>        <span class="k">return</span> <span class="n">order</span><span class="p">,</span> <span class="p">[</span><span class="n">axlist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">order</span><span class="p">]</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">reorder_axes</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">T</span><span class="p">,</span> <span class="n">data_names</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a>                     <span class="o">**</span><span class="n">pos</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a><span class="sd">        Reorder data axes.</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a><span class="sd">        :param data_names: Data name(s) for which to reorder the axes.</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a><span class="sd">                           If None, apply to all dependents.</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a><span class="sd">        :param pos: New axes position in the form ``axis_name = new_position``.</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a><span class="sd">                    Non-specified axes positions are adjusted automatically.</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a><span class="sd">        :return: Dataset with re-ordered axes (not a copy)</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>        <span class="k">if</span> <span class="n">data_names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a>            <span class="n">data_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dependents</span><span class="p">()</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data_names</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a>            <span class="n">data_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">data_names</span><span class="p">]</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a>        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">data_names</span><span class="p">:</span>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a>            <span class="n">neworder</span><span class="p">,</span> <span class="n">newaxes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reorder_axes_indices</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="o">**</span><span class="n">pos</span><span class="p">)</span>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a>            <span class="bp">self</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">&#39;axes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">newaxes</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a>        <span class="k">return</span> <span class="bp">self</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a><span class="sd">        Make a copy of the dataset.</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a><span class="sd">        :return: A copy of the dataset.</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;copying a dataset with size </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nbytes</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a>        <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="p">()</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a>        <span class="k">assert</span> <span class="n">ret</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a>            <span class="n">ret</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_vals</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a>        <span class="k">return</span> <span class="n">ret</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">astype</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">T</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a><span class="sd">        Convert all data values to given dtype.</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a><span class="sd">        :param dtype: np dtype.</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a><span class="sd">        :return: Dataset, with values as given type (not a copy)</span>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a>            <span class="n">vals</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">]</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a>            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">])</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">MaskedArray</span><span class="p">]:</span>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a>                <span class="n">vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">])</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a>            <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vals</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a>        <span class="k">return</span> <span class="bp">self</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">mask_invalid</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a><span class="sd">        Mask all invalid data in all values.</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a><span class="sd">        :return: Copy of the dataset with invalid entries (nan/None) masked.</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a>        <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a>            <span class="n">arr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_vals</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a>            <span class="n">vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_where</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">is_invalid</span><span class="p">(</span><span class="n">arr</span><span class="p">),</span> <span class="n">arr</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a>                <span class="n">vals</span><span class="o">.</span><span class="n">fill_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a>            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a>                <span class="n">vals</span><span class="o">.</span><span class="n">fill_value</span> <span class="o">=</span> <span class="o">-</span><span class="mi">9999</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a>            <span class="bp">self</span><span class="p">[</span><span class="n">d</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vals</span>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a>        <span class="k">return</span> <span class="bp">self</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a>    <span class="k">class</span><span class="w"> </span><span class="nc">_DataAccess</span><span class="p">:</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a>        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="s2">&quot;DataDictBase&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">parent</span>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a>        <span class="k">def</span><span class="w"> </span><span class="fm">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">__name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a>            <span class="n">parent</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">DataDictBase</span><span class="o">.</span><span class="n">_DataAccess</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="s1">&#39;_parent&#39;</span><span class="p">)</span>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a>            <span class="k">if</span> <span class="n">__name</span> <span class="ow">in</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">parent</span><span class="o">.</span><span class="n">data_items</span><span class="p">()]:</span>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a>                <span class="k">return</span> <span class="n">parent</span><span class="o">.</span><span class="n">data_vals</span><span class="p">(</span><span class="n">__name</span><span class="p">)</span>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a>                <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">DataDictBase</span><span class="o">.</span><span class="n">_DataAccess</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">__name</span><span class="p">)</span>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a>        <span class="k">def</span><span class="w"> </span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">__name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">__value</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a>            <span class="c1"># this check: make sure that we can set the parent correctly in the</span>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a>            <span class="c1"># constructor.</span>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a>            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_parent&#39;</span><span class="p">):</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a>                <span class="k">if</span> <span class="n">__name</span> <span class="ow">in</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">data_items</span><span class="p">()]:</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="p">[</span><span class="n">__name</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">__value</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a>                <span class="c1"># still allow setting random things, essentially.</span>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a>                    <span class="nb">super</span><span class="p">(</span><span class="n">DataDictBase</span><span class="o">.</span><span class="n">_DataAccess</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">__name</span><span class="p">,</span> <span class="n">__value</span><span class="p">)</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a>                <span class="nb">super</span><span class="p">(</span><span class="n">DataDictBase</span><span class="o">.</span><span class="n">_DataAccess</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">__name</span><span class="p">,</span> <span class="n">__value</span><span class="p">)</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_update_data_access</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a>        <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">d_</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict.DataDictBase.__eq__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Check for content equality of two datadicts.</p>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-91">91</a></span>
<span class="normal"><a href="#__codelineno-0-92">92</a></span>
<span class="normal"><a href="#__codelineno-0-93">93</a></span>
<span class="normal"><a href="#__codelineno-0-94">94</a></span>
<span class="normal"><a href="#__codelineno-0-95">95</a></span>
<span class="normal"><a href="#__codelineno-0-96">96</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Check for content equality of two datadicts.&quot;&quot;&quot;</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">DataDictBase</span><span class="p">):</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>        <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>        <span class="k">return</span> <span class="n">datasets_are_equal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict.DataDictBase.add_meta" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">add_meta</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Add meta info to the dataset.</p>
<p>If the key already exists, meta info will be overwritten.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>key</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of the meta field (without underscores).</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>value</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Value of the meta information.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, None]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>None</code>, meta will be global; otherwise assigned to data field <code>data</code>.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="k">def</span><span class="w"> </span><span class="nf">add_meta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">    Add meta info to the dataset.</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">    If the key already exists, meta info will be overwritten.</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">    :param key: Name of the meta field (without underscores).</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">    :param value: Value of the meta information.</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="sd">    :param data: If ``None``, meta will be global; otherwise assigned to</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="sd">                 data field ``data``.</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta_name_to_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>    <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>        <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>        <span class="bp">self</span><span class="p">[</span><span class="n">data</span><span class="p">][</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict.DataDictBase.astype" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Convert all data values to given dtype.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>dtype</code></td>
          <td>
                <code><span title="numpy.dtype">dtype</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>np dtype.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="labcore.data.datadict.T">T</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dataset, with values as given type (not a copy)</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span>
<span class="normal"><a href="#__codelineno-0-716">716</a></span>
<span class="normal"><a href="#__codelineno-0-717">717</a></span>
<span class="normal"><a href="#__codelineno-0-718">718</a></span>
<span class="normal"><a href="#__codelineno-0-719">719</a></span>
<span class="normal"><a href="#__codelineno-0-720">720</a></span>
<span class="normal"><a href="#__codelineno-0-721">721</a></span>
<span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-711" name="__codelineno-0-711"></a><span class="k">def</span><span class="w"> </span><span class="nf">astype</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">T</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a><span class="sd">    Convert all data values to given dtype.</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a><span class="sd">    :param dtype: np dtype.</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a><span class="sd">    :return: Dataset, with values as given type (not a copy)</span>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a>    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a>        <span class="n">vals</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">]</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">])</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">MaskedArray</span><span class="p">]:</span>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a>            <span class="n">vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">])</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a>        <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vals</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a>    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict.DataDictBase.axes" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">axes</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Return a list of axes.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="typing.Sequence">Sequence</span>[str], str, None]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>if <code>None</code>, return all axes present in the dataset, otherwise only the axes of the dependent <code>data</code>.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.List">List</span>[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The list of axes.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-514" name="__codelineno-0-514"></a><span class="k">def</span><span class="w"> </span><span class="nf">axes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a><span class="sd">    Return a list of axes.</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a><span class="sd">    :param data: if ``None``, return all axes present in the dataset,</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a><span class="sd">                 otherwise only the axes of the dependent ``data``.</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a><span class="sd">    :return: The list of axes.</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>    <span class="n">lst</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>    <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>            <span class="k">if</span> <span class="s1">&#39;axes&#39;</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>                <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;axes&#39;</span><span class="p">]:</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>                    <span class="k">if</span> <span class="n">n</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">lst</span> <span class="ow">and</span> <span class="bp">self</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="p">[])</span> <span class="o">==</span> <span class="p">[]:</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>                        <span class="n">lst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>            <span class="n">dataseq</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">,)</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>            <span class="n">dataseq</span> <span class="o">=</span> <span class="n">data</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">dataseq</span><span class="p">:</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>            <span class="k">if</span> <span class="s1">&#39;axes&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">[</span><span class="n">n</span><span class="p">]:</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>                <span class="k">continue</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>            <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">&#39;axes&#39;</span><span class="p">]:</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>                <span class="k">if</span> <span class="n">m</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">lst</span> <span class="ow">and</span> <span class="bp">self</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="p">[])</span> <span class="o">==</span> <span class="p">[]:</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>                    <span class="n">lst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>    <span class="k">return</span> <span class="n">lst</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict.DataDictBase.axes_are_compatible" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">axes_are_compatible</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Check if all dependent data fields have the same axes.</p>
<p>This includes axes order.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p><code>True</code> or <code>False</code>.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-497" name="__codelineno-0-497"></a><span class="k">def</span><span class="w"> </span><span class="nf">axes_are_compatible</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a><span class="sd">    Check if all dependent data fields have the same axes.</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a><span class="sd">    This includes axes order.</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a><span class="sd">    :return: ``True`` or ``False``.</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>    <span class="n">axes</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dependents</span><span class="p">()):</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>            <span class="n">axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">!=</span> <span class="n">axes</span><span class="p">:</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>                <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict.DataDictBase.clear_meta" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">clear_meta</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Deletes all meta data.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, None]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If not <code>None</code>, delete all meta only from specified data field <code>data</code>. Else, deletes all top-level meta, as well as meta for all data fields.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="k">def</span><span class="w"> </span><span class="nf">clear_meta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="sd">    Deletes all meta data.</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">    :param data: If not ``None``, delete all meta only from specified data field ``data``.</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">                 Else, deletes all top-level meta, as well as meta for all data fields.</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>    <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>        <span class="n">meta_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta_items</span><span class="p">()]</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">meta_list</span><span class="p">:</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">delete_meta</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>        <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>            <span class="n">data_meta_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta_items</span><span class="p">(</span><span class="n">d</span><span class="p">)]</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>            <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">data_meta_list</span><span class="p">:</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">delete_meta</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>        <span class="n">data_meta_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta_items</span><span class="p">(</span><span class="n">data</span><span class="p">)]</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">data_meta_list</span><span class="p">:</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">delete_meta</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict.DataDictBase.copy" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">copy</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Make a copy of the dataset.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="labcore.data.datadict.T">T</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A copy of the dataset.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-697">697</a></span>
<span class="normal"><a href="#__codelineno-0-698">698</a></span>
<span class="normal"><a href="#__codelineno-0-699">699</a></span>
<span class="normal"><a href="#__codelineno-0-700">700</a></span>
<span class="normal"><a href="#__codelineno-0-701">701</a></span>
<span class="normal"><a href="#__codelineno-0-702">702</a></span>
<span class="normal"><a href="#__codelineno-0-703">703</a></span>
<span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span>
<span class="normal"><a href="#__codelineno-0-709">709</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-697" name="__codelineno-0-697"></a><span class="k">def</span><span class="w"> </span><span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a><span class="sd">    Make a copy of the dataset.</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a><span class="sd">    :return: A copy of the dataset.</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;copying a dataset with size </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nbytes</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a>    <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="p">()</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a>    <span class="k">assert</span> <span class="n">ret</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a>    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a>        <span class="n">ret</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_vals</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a>    <span class="k">return</span> <span class="n">ret</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict.DataDictBase.data_items" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">data_items</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Generator for data field items.</p>
<p>Like dict.items(), but ignores meta data.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Iterator">Iterator</span>[<span title="typing.Tuple">Tuple</span>[str, <span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Generator yielding first the key of the data field and second its value.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="k">def</span><span class="w"> </span><span class="nf">data_items</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]:</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">    Generator for data field items.</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">    Like dict.items(), but ignores meta data.</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">    :return: Generator yielding first the key of the data field and second its value.</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_meta_key</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>            <span class="k">yield</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict.DataDictBase.data_vals" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">data_vals</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Return the data values of field <code>key</code>.</p>
<p>Equivalent to <code>DataDict['key'].values</code>.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>key</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of the data field.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Values of the data field.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="k">def</span><span class="w"> </span><span class="nf">data_vals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">    Return the data values of field ``key``.</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">    Equivalent to ``DataDict[&#39;key&#39;].values``.</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">    :param key: Name of the data field.</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="sd">    :return: Values of the data field.</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_meta_key</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> is a meta key.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>    <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;values&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict.DataDictBase.delete_meta" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">delete_meta</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Deletes specific meta data.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>key</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of the meta field to remove.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, None]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>None</code>, this affects global meta; otherwise remove from data field <code>data</code>.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="k">def</span><span class="w"> </span><span class="nf">delete_meta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">    Deletes specific meta data.</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">    :param key: Name of the meta field to remove.</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="sd">    :param data: If ``None``, this affects global meta; otherwise remove</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">                 from data field ``data``.</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta_name_to_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>    <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>        <span class="k">del</span> <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>        <span class="k">del</span> <span class="bp">self</span><span class="p">[</span><span class="n">data</span><span class="p">][</span><span class="n">key</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict.DataDictBase.dependents" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">dependents</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get all dependents in the dataset.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.List">List</span>[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of the names of dependents.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-543" name="__codelineno-0-543"></a><span class="k">def</span><span class="w"> </span><span class="nf">dependents</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a><span class="sd">    Get all dependents in the dataset.</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a><span class="sd">    :return: A list of the names of dependents.</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>    <span class="n">ret</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>    <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="p">[]))</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>            <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>    <span class="k">return</span> <span class="n">ret</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict.DataDictBase.extract" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">extract</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">include_meta</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sanitize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Extract data from a dataset.</p>
<p>Return a new datadict with all fields specified in <code>data</code> included.
Will also take any axes fields along that have not been explicitly
specified. Will return empty if <code>data</code> consists of only axes fields.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span title="typing.List">List</span>[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Data field or list of data fields to be extracted.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>include_meta</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>True</code>, include the global meta data. data meta will always be included.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>copy</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>True</code>, data fields will be <code>deep copies &lt;https://docs.python.org/3/library/copy.html&gt;</code>__ of the original.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>sanitize</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>True</code>, will run DataDictBase.sanitize before returning.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="labcore.data.datadict.T">T</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>New DataDictBase containing only requested fields.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="k">def</span><span class="w"> </span><span class="nf">extract</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">T</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">include_meta</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>            <span class="n">copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">sanitize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">    Extract data from a dataset.</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">    Return a new datadict with all fields specified in ``data`` included.</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">    Will also take any axes fields along that have not been explicitly</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">    specified. Will return empty if ``data`` consists of only axes fields.</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">    :param data: Data field or list of data fields to be extracted.</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">    :param include_meta: If ``True``, include the global meta data.</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">                         data meta will always be included.</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a><span class="sd">    :param copy: If ``True``, data fields will be `deep copies &lt;https://docs.python.org/3/library/copy.html&gt;`__</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">                 of the original.</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">    :param sanitize: If ``True``, will run DataDictBase.sanitize before</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">                     returning.</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="sd">    :return: New DataDictBase containing only requested fields.</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="p">]</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>    <span class="c1"># include all the axes used by the data.</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>            <span class="k">if</span> <span class="n">a</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>                <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>    <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>        <span class="k">if</span> <span class="n">copy</span><span class="p">:</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>            <span class="n">ret</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">d</span><span class="p">])</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>            <span class="n">ret</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">d</span><span class="p">]</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>    <span class="k">if</span> <span class="n">include_meta</span><span class="p">:</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta_items</span><span class="p">():</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>            <span class="k">if</span> <span class="n">copy</span><span class="p">:</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>                <span class="n">ret</span><span class="o">.</span><span class="n">add_meta</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>                <span class="n">ret</span><span class="o">.</span><span class="n">add_meta</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>    <span class="k">if</span> <span class="n">sanitize</span><span class="p">:</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>        <span class="n">ret</span> <span class="o">=</span> <span class="n">ret</span><span class="o">.</span><span class="n">sanitize</span><span class="p">()</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>    <span class="n">ret</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>    <span class="k">return</span> <span class="n">ret</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict.DataDictBase.has_meta" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">has_meta</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Check whether meta field exists in the dataset.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p><code>True</code> if it exists, <code>False</code> if it doesn't.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="k">def</span><span class="w"> </span><span class="nf">has_meta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Check whether meta field exists in the dataset.</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">    :return: ``True`` if it exists, ``False`` if it doesn&#39;t.</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>    <span class="n">k</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta_name_to_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>    <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>        <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">field_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">field_dict</span><span class="p">:</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>                <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict.DataDictBase.label" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">label</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get the label for a data field. If no label is present returns the
name of the data field as the label. If a unit is present, it will
be appended at the end in brackets: "label (unit)".</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of the data field.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Labelled name.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-473" name="__codelineno-0-473"></a><span class="k">def</span><span class="w"> </span><span class="nf">label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a><span class="sd">    Get the label for a data field. If no label is present returns the</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a><span class="sd">    name of the data field as the label. If a unit is present, it will</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a><span class="sd">    be appended at the end in brackets: &quot;label (unit)&quot;.</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="sd">    :param name: Name of the data field.</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a><span class="sd">    :return: Labelled name.</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">():</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>        <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No field &#39;</span><span class="si">{}</span><span class="s2">&#39; present.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>        <span class="k">if</span> <span class="bp">self</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>            <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;label&#39;</span><span class="p">]</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>            <span class="n">n</span> <span class="o">=</span> <span class="n">name</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>        <span class="k">if</span> <span class="bp">self</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;unit&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>            <span class="n">n</span> <span class="o">+=</span> <span class="s1">&#39; (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;unit&#39;</span><span class="p">])</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>        <span class="k">return</span> <span class="n">n</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict.DataDictBase.mask_invalid" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">mask_invalid</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Mask all invalid data in all values.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="labcore.data.datadict.T">T</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Copy of the dataset with invalid entries (nan/None) masked.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-726">726</a></span>
<span class="normal"><a href="#__codelineno-0-727">727</a></span>
<span class="normal"><a href="#__codelineno-0-728">728</a></span>
<span class="normal"><a href="#__codelineno-0-729">729</a></span>
<span class="normal"><a href="#__codelineno-0-730">730</a></span>
<span class="normal"><a href="#__codelineno-0-731">731</a></span>
<span class="normal"><a href="#__codelineno-0-732">732</a></span>
<span class="normal"><a href="#__codelineno-0-733">733</a></span>
<span class="normal"><a href="#__codelineno-0-734">734</a></span>
<span class="normal"><a href="#__codelineno-0-735">735</a></span>
<span class="normal"><a href="#__codelineno-0-736">736</a></span>
<span class="normal"><a href="#__codelineno-0-737">737</a></span>
<span class="normal"><a href="#__codelineno-0-738">738</a></span>
<span class="normal"><a href="#__codelineno-0-739">739</a></span>
<span class="normal"><a href="#__codelineno-0-740">740</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-726" name="__codelineno-0-726"></a><span class="k">def</span><span class="w"> </span><span class="nf">mask_invalid</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a><span class="sd">    Mask all invalid data in all values.</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a><span class="sd">    :return: Copy of the dataset with invalid entries (nan/None) masked.</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a>    <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a>        <span class="n">arr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_vals</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a>        <span class="n">vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_where</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">is_invalid</span><span class="p">(</span><span class="n">arr</span><span class="p">),</span> <span class="n">arr</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a>            <span class="n">vals</span><span class="o">.</span><span class="n">fill_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a>        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a>            <span class="n">vals</span><span class="o">.</span><span class="n">fill_value</span> <span class="o">=</span> <span class="o">-</span><span class="mi">9999</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a>        <span class="bp">self</span><span class="p">[</span><span class="n">d</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vals</span>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a>    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict.DataDictBase.meta_items" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">meta_items</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">clean_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Generator for meta items.</p>
<p>Like dict.items(), but yields <code>only</code> meta entries.
The keys returned do not contain the underscores used internally.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, None]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>None</code> iterate over global meta data. If it's the name of a data field, iterate over the meta information of that field.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>clean_keys</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>True</code>, remove the underscore pre/suffix.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Iterator">Iterator</span>[<span title="typing.Tuple">Tuple</span>[str, <span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Generator yielding first the key of the data field and second its value.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="k">def</span><span class="w"> </span><span class="nf">meta_items</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>               <span class="n">clean_keys</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]:</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">    Generator for meta items.</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">    Like dict.items(), but yields `only` meta entries.</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">    The keys returned do not contain the underscores used internally.</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">    :param data: If ``None`` iterate over global meta data.</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">                 If it&#39;s the name of a data field, iterate over the meta</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">                 information of that field.</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">    :param clean_keys: If `True`, remove the underscore pre/suffix.</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">    :return: Generator yielding first the key of the data field and second its value.</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>    <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_meta_key</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>                <span class="k">if</span> <span class="n">clean_keys</span><span class="p">:</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>                    <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta_key_to_name</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>                    <span class="n">n</span> <span class="o">=</span> <span class="n">k</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>                <span class="k">yield</span> <span class="n">n</span><span class="p">,</span> <span class="n">v</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">[</span><span class="n">data</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_meta_key</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>                <span class="k">if</span> <span class="n">clean_keys</span><span class="p">:</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>                    <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta_key_to_name</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>                    <span class="n">n</span> <span class="o">=</span> <span class="n">k</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>                <span class="k">yield</span> <span class="n">n</span><span class="p">,</span> <span class="n">v</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict.DataDictBase.meta_val" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">meta_val</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Return the value of meta field <code>key</code> (given without underscore).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>key</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of the meta field.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, None]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p><code>None</code> for global meta; name of data field for data meta.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The value of the meta information.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="k">def</span><span class="w"> </span><span class="nf">meta_val</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">    Return the value of meta field ``key`` (given without underscore).</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">    :param key: Name of the meta field.</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">    :param data: ``None`` for global meta; name of data field for data meta.</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">    :return: The value of the meta information.</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>    <span class="n">k</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta_name_to_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>    <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">data</span><span class="p">][</span><span class="n">k</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict.DataDictBase.nbytes" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">nbytes</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get the size of data.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>name</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of the data field. if none, return size of  entire datadict.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Optional">Optional</span>[int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>size in bytes.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-456" name="__codelineno-0-456"></a><span class="k">def</span><span class="w"> </span><span class="nf">nbytes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the size of data.</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a><span class="sd">    :param name: Name of the data field. if none, return size of </span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a><span class="sd">        entire datadict.</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a><span class="sd">    :return: size in bytes.</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">():</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>            <span class="k">return</span> <span class="nb">sum</span><span class="p">([</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">itemsize</span> 
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>                        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_items</span><span class="p">()])</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_vals</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_vals</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">itemsize</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict.DataDictBase.remove_unused_axes" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">remove_unused_axes</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Removes axes not associated with dependents.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="labcore.data.datadict.T">T</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Cleaned dataset.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-621" name="__codelineno-0-621"></a><span class="k">def</span><span class="w"> </span><span class="nf">remove_unused_axes</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a><span class="sd">    Removes axes not associated with dependents.</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a><span class="sd">    :return: Cleaned dataset.</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a>    <span class="n">dependents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dependents</span><span class="p">()</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a>    <span class="n">unused</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a>    <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a>        <span class="n">used</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a>        <span class="k">if</span> <span class="n">n</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dependents</span><span class="p">:</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a>            <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">dependents</span><span class="p">:</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a>                <span class="k">if</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">[</span><span class="n">m</span><span class="p">][</span><span class="s1">&#39;axes&#39;</span><span class="p">]:</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a>                    <span class="n">used</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a>            <span class="n">used</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">used</span><span class="p">:</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a>            <span class="n">unused</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a>    <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">unused</span><span class="p">:</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a>        <span class="k">del</span> <span class="bp">self</span><span class="p">[</span><span class="n">u</span><span class="p">]</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a>    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict.DataDictBase.reorder_axes" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">reorder_axes</span><span class="p">(</span><span class="n">data_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">pos</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Reorder data axes.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data_names</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, <span title="typing.Sequence">Sequence</span>[str], None]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Data name(s) for which to reorder the axes. If None, apply to all dependents.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>pos</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>New axes position in the form <code>axis_name = new_position</code>. Non-specified axes positions are adjusted automatically.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="labcore.data.datadict.T">T</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dataset with re-ordered axes (not a copy)</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span>
<span class="normal"><a href="#__codelineno-0-688">688</a></span>
<span class="normal"><a href="#__codelineno-0-689">689</a></span>
<span class="normal"><a href="#__codelineno-0-690">690</a></span>
<span class="normal"><a href="#__codelineno-0-691">691</a></span>
<span class="normal"><a href="#__codelineno-0-692">692</a></span>
<span class="normal"><a href="#__codelineno-0-693">693</a></span>
<span class="normal"><a href="#__codelineno-0-694">694</a></span>
<span class="normal"><a href="#__codelineno-0-695">695</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-673" name="__codelineno-0-673"></a><span class="k">def</span><span class="w"> </span><span class="nf">reorder_axes</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">T</span><span class="p">,</span> <span class="n">data_names</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a>                 <span class="o">**</span><span class="n">pos</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a><span class="sd">    Reorder data axes.</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a><span class="sd">    :param data_names: Data name(s) for which to reorder the axes.</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a><span class="sd">                       If None, apply to all dependents.</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a><span class="sd">    :param pos: New axes position in the form ``axis_name = new_position``.</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a><span class="sd">                Non-specified axes positions are adjusted automatically.</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a><span class="sd">    :return: Dataset with re-ordered axes (not a copy)</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>    <span class="k">if</span> <span class="n">data_names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a>        <span class="n">data_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dependents</span><span class="p">()</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data_names</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a>        <span class="n">data_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">data_names</span><span class="p">]</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a>    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">data_names</span><span class="p">:</span>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a>        <span class="n">neworder</span><span class="p">,</span> <span class="n">newaxes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reorder_axes_indices</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="o">**</span><span class="n">pos</span><span class="p">)</span>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a>        <span class="bp">self</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">&#39;axes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">newaxes</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a>    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict.DataDictBase.reorder_axes_indices" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">reorder_axes_indices</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">pos</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get the indices that can reorder axes in a given way.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of the data field of which we want to reorder axes.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>pos</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>New axes position in the form <code>axis_name = new_position</code>. Non-specified axes positions are adjusted automatically.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Tuple">Tuple</span>[<span title="typing.Tuple">Tuple</span>[int, ...], <span title="typing.List">List</span>[str]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The tuple of new indices, and the list of axes names in the new order.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-657" name="__codelineno-0-657"></a><span class="k">def</span><span class="w"> </span><span class="nf">reorder_axes_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a>                         <span class="o">**</span><span class="n">pos</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a><span class="sd">    Get the indices that can reorder axes in a given way.</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a><span class="sd">    :param name: Name of the data field of which we want to reorder axes.</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a><span class="sd">    :param pos: New axes position in the form ``axis_name = new_position``.</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a><span class="sd">                Non-specified axes positions are adjusted automatically.</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a><span class="sd">    :return: The tuple of new indices, and the list of axes names in the</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a><span class="sd">             new order.</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>    <span class="n">axlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>    <span class="n">order</span> <span class="o">=</span> <span class="n">misc</span><span class="o">.</span><span class="n">reorder_indices_from_new_positions</span><span class="p">(</span><span class="n">axlist</span><span class="p">,</span> <span class="o">**</span><span class="n">pos</span><span class="p">)</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a>    <span class="k">return</span> <span class="n">order</span><span class="p">,</span> <span class="p">[</span><span class="n">axlist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">order</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict.DataDictBase.same_structure" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">same_structure</span><span class="p">(</span><span class="o">*</span><span class="n">data</span><span class="p">,</span> <span class="n">check_shape</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Check if all supplied DataDicts share the same data structure
(i.e., dependents and axes).</p>
<p>Ignores meta data and values. Checks also for matching shapes if
<code>check_shape</code> is <code>True</code>.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span title="labcore.data.datadict.T">T</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The data sets to compare.</p>
            </div>
          </td>
          <td>
                <code>()</code>
          </td>
        </tr>
        <tr>
          <td><code>check_shape</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to include shape check in the comparison.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p><code>True</code> if the structure matches for all, else <code>False</code>.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="nd">@staticmethod</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a><span class="k">def</span><span class="w"> </span><span class="nf">same_structure</span><span class="p">(</span><span class="o">*</span><span class="n">data</span><span class="p">:</span> <span class="n">T</span><span class="p">,</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>                   <span class="n">check_shape</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a><span class="sd">    Check if all supplied DataDicts share the same data structure</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="sd">    (i.e., dependents and axes).</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a><span class="sd">    Ignores meta data and values. Checks also for matching shapes if</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a><span class="sd">    `check_shape` is `True`.</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a><span class="sd">    :param data: The data sets to compare.</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a><span class="sd">    :param check_shape: Whether to include shape check in the comparison.</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a><span class="sd">    :return: ``True`` if the structure matches for all, else ``False``.</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>        <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">empty_structure</span><span class="p">(</span><span class="n">d</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">misc</span><span class="o">.</span><span class="n">unwrap_optional</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">structure</span><span class="p">(</span><span class="n">include_meta</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">add_shape</span><span class="o">=</span><span class="n">check_shape</span><span class="p">))</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>            <span class="k">if</span> <span class="s1">&#39;values&#39;</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>                <span class="k">del</span> <span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>        <span class="k">return</span> <span class="n">s</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>    <span class="n">s0</span> <span class="o">=</span> <span class="n">empty_structure</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>        <span class="k">if</span> <span class="n">d</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>            <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>        <span class="k">if</span> <span class="n">s0</span> <span class="o">!=</span> <span class="n">empty_structure</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>            <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict.DataDictBase.sanitize" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">sanitize</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Clean-up tasks:
    * Removes unused axes.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="labcore.data.datadict.T">T</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Sanitized dataset.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-646" name="__codelineno-0-646"></a><span class="k">def</span><span class="w"> </span><span class="nf">sanitize</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a><span class="sd">    Clean-up tasks:</span>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a><span class="sd">        * Removes unused axes.</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a><span class="sd">    :return: Sanitized dataset.</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">remove_unused_axes</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict.DataDictBase.shapes" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">shapes</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get the shapes of all data fields.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Tuple">Tuple</span>[int, ...]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary of the form <code>{key : shape}</code>, where shape is the np.shape-tuple of the data with name <code>key</code>.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-555" name="__codelineno-0-555"></a><span class="k">def</span><span class="w"> </span><span class="nf">shapes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]]:</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a><span class="sd">    Get the shapes of all data fields.</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a><span class="sd">    :return: A dictionary of the form ``{key : shape}``, where shape is the</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a><span class="sd">             np.shape-tuple of the data with name ``key``.</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>    <span class="n">shapes</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>        <span class="n">shapes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_vals</span><span class="p">(</span><span class="n">k</span><span class="p">))</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>    <span class="k">return</span> <span class="n">shapes</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict.DataDictBase.structure" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">structure</span><span class="p">(</span><span class="n">add_shape</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_meta</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">same_type</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_data</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get the structure of the DataDict.</p>
<p>Return the datadict without values (<code>value</code> omitted in the dict).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>add_shape</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Deprecated -- ignored.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>include_meta</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>True</code>, include the meta information in the returned dict.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>same_type</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>True</code>, return type will be the one of the object this is called on. Else, DataDictBase.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>remove_data</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[str]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>any data fields listed will be removed from the result, also when listed in any axes.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="labcore.data.datadict.T">T</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The DataDict containing the structure only. The exact type is the same as the type of <code>self</code>.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="k">def</span><span class="w"> </span><span class="nf">structure</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">T</span><span class="p">,</span> <span class="n">add_shape</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>              <span class="n">include_meta</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>              <span class="n">same_type</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>              <span class="n">remove_data</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="sd">    Get the structure of the DataDict.</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a><span class="sd">    Return the datadict without values (`value` omitted in the dict).</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a><span class="sd">    :param add_shape: Deprecated -- ignored.</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a><span class="sd">    :param include_meta: If `True`, include the meta information in</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a><span class="sd">                         the returned dict.</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a><span class="sd">    :param same_type: If `True`, return type will be the one of the</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a><span class="sd">                      object this is called on. Else, DataDictBase.</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a><span class="sd">    :param remove_data: any data fields listed will be removed from</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a><span class="sd">                        the result, also when listed in any axes.</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a><span class="sd">    :return: The DataDict containing the structure only. The exact type</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a><span class="sd">                 is the same as the type of ``self``.</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>    <span class="k">if</span> <span class="n">add_shape</span><span class="p">:</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;&#39;add_shape&#39; is deprecated and will be ignored&quot;</span><span class="p">,</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>                      <span class="ne">DeprecationWarning</span><span class="p">)</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>    <span class="n">add_shape</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>    <span class="k">if</span> <span class="n">remove_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>        <span class="n">remove_data</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">():</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>            <span class="k">if</span> <span class="n">n</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">remove_data</span><span class="p">:</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>                <span class="n">v2</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>                <span class="n">v2</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>                <span class="n">s</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">v2</span><span class="p">)</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>                <span class="k">if</span> <span class="s1">&#39;axes&#39;</span> <span class="ow">in</span> <span class="n">s</span><span class="p">[</span><span class="n">n</span><span class="p">]:</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>                    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">remove_data</span><span class="p">:</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>                        <span class="k">if</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">s</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">&#39;axes&#39;</span><span class="p">]:</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>                            <span class="n">i</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">&#39;axes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>                            <span class="n">s</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">&#39;axes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>        <span class="k">if</span> <span class="n">include_meta</span><span class="p">:</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>            <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta_items</span><span class="p">():</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>                <span class="n">s</span><span class="o">.</span><span class="n">add_meta</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>            <span class="n">s</span><span class="o">.</span><span class="n">clear_meta</span><span class="p">()</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>        <span class="k">if</span> <span class="n">same_type</span><span class="p">:</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>            <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="o">**</span><span class="n">s</span><span class="p">)</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>        <span class="k">return</span> <span class="n">s</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict.DataDictBase.to_records" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">to_records</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Convert data to records that can be added to the <code>DataDict</code>.
All data is converted to np.array, and reshaped such that the first dimension of all resulting
arrays have the same length (chosen to be the smallest possible number
that does not alter any shapes beyond adding a length-1 dimension as
first dimension, if necessary).</p>
<p>If a data field is given as <code>None</code>, it will be converted to <code>numpy.array([numpy.nan])</code>.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>keyword arguments for each data field followed by data.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="numpy.ndarray">ndarray</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with properly shaped data.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="nd">@staticmethod</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="k">def</span><span class="w"> </span><span class="nf">to_records</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert data to records that can be added to the ``DataDict``.</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">    All data is converted to np.array, and reshaped such that the first dimension of all resulting</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">    arrays have the same length (chosen to be the smallest possible number</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">    that does not alter any shapes beyond adding a length-1 dimension as</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">    first dimension, if necessary).</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">    If a data field is given as ``None``, it will be converted to ``numpy.array([numpy.nan])``.</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">    :param data: keyword arguments for each data field followed by data.</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">    :returns: Dictionary with properly shaped data.</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>    <span class="n">records</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>    <span class="n">seqtypes</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>    <span class="n">nantypes</span> <span class="o">=</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span> <span class="p">)</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">seqtypes</span><span class="p">):</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>            <span class="n">records</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">nantypes</span><span class="p">):</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>            <span class="n">records</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>            <span class="n">records</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">v</span><span class="p">])</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span class="n">possible_nrecords</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">records</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>        <span class="n">possible_nrecords</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>    <span class="n">commons</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">possible_nrecords</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>            <span class="k">if</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">commons</span><span class="p">:</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>                <span class="k">continue</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>            <span class="n">is_common</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>            <span class="k">for</span> <span class="n">kk</span><span class="p">,</span> <span class="n">vv</span> <span class="ow">in</span> <span class="n">possible_nrecords</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>                <span class="k">if</span> <span class="n">n</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">vv</span><span class="p">:</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>                    <span class="n">is_common</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>            <span class="k">if</span> <span class="n">is_common</span><span class="p">:</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>                <span class="n">commons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>    <span class="n">nrecs</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">commons</span><span class="p">)</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">records</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>        <span class="n">shp</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>        <span class="k">if</span> <span class="n">nrecs</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">shp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>            <span class="n">newshp</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">shp</span><span class="p">))</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>            <span class="n">records</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">newshp</span><span class="p">)</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>    <span class="k">return</span> <span class="n">records</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict.DataDictBase.validate" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">validate</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Check the validity of the dataset.</p>
<p>Checks performed:
    * All axes specified with dependents must exist as data fields.</p>
<p>Other tasks performed:
    * <code>unit</code> keys are created if omitted.
    * <code>label</code> keys are created if omitted.
    * <code>shape</code> meta information is updated with the correct values
      (only if present already).</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p><code>True</code> if valid, <code>False</code> if invalid.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-571" name="__codelineno-0-571"></a><span class="k">def</span><span class="w"> </span><span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a><span class="sd">    Check the validity of the dataset.</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a><span class="sd">    Checks performed:</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a><span class="sd">        * All axes specified with dependents must exist as data fields.</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a><span class="sd">    Other tasks performed:</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a><span class="sd">        * ``unit`` keys are created if omitted.</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a><span class="sd">        * ``label`` keys are created if omitted.</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a><span class="sd">        * ``shape`` meta information is updated with the correct values</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a><span class="sd">          (only if present already).</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a><span class="sd">    :return: ``True`` if valid, ``False`` if invalid.</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a><span class="sd">    :raises: ``ValueError`` if invalid.</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_update_data_access</span><span class="p">()</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a>    <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a>    <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>        <span class="k">if</span> <span class="s1">&#39;axes&#39;</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>            <span class="k">for</span> <span class="n">na</span> <span class="ow">in</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;axes&#39;</span><span class="p">]:</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a>                <span class="k">if</span> <span class="n">na</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>                    <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot; * &#39;</span><span class="si">{}</span><span class="s2">&#39; has axis &#39;</span><span class="si">{}</span><span class="s2">&#39;, but no field &quot;</span> \
<a id="__codelineno-0-596" name="__codelineno-0-596"></a>                           <span class="s2">&quot;with name &#39;</span><span class="si">{}</span><span class="s2">&#39; registered.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a>                        <span class="n">n</span><span class="p">,</span> <span class="n">na</span><span class="p">,</span> <span class="n">na</span><span class="p">)</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>                <span class="k">elif</span> <span class="n">na</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">():</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a>                    <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot; * &#39;</span><span class="si">{}</span><span class="s2">&#39; has axis &#39;</span><span class="si">{}</span><span class="s2">&#39;, but no independent &quot;</span> \
<a id="__codelineno-0-600" name="__codelineno-0-600"></a>                           <span class="s2">&quot;with name &#39;</span><span class="si">{}</span><span class="s2">&#39; registered.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a>                        <span class="n">n</span><span class="p">,</span> <span class="n">na</span><span class="p">,</span> <span class="n">na</span><span class="p">)</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a>            <span class="n">v</span><span class="p">[</span><span class="s1">&#39;axes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a>        <span class="k">if</span> <span class="s1">&#39;unit&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a>            <span class="n">v</span><span class="p">[</span><span class="s1">&#39;unit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a>        <span class="k">if</span> <span class="s1">&#39;label&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a>            <span class="n">v</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a>        <span class="n">vals</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;values&#39;</span><span class="p">,</span> <span class="p">[])</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">MaskedArray</span><span class="p">]:</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a>            <span class="n">vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>        <span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vals</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a>    <span class="k">if</span> <span class="n">msg</span> <span class="o">!=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a>    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="labcore.data.datadict.MeshgridDataDict" class="doc doc-heading">
          <code>MeshgridDataDict</code>


</h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="labcore.data.datadict.DataDictBase" href="#labcore.data.datadict.DataDictBase">DataDictBase</a></code></p>

  
      <p>Implementation of DataDictBase meant to be used for when the axes form
a grid on which the dependent values reside.</p>
<p>It enforces that all dependents have the same axes and all shapes need to be identical.</p>

            <details class="quote">
              <summary>Source code in <code>labcore/data/datadict.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span>
<span class="normal"><a href="#__codelineno-0-1049">1049</a></span>
<span class="normal"><a href="#__codelineno-0-1050">1050</a></span>
<span class="normal"><a href="#__codelineno-0-1051">1051</a></span>
<span class="normal"><a href="#__codelineno-0-1052">1052</a></span>
<span class="normal"><a href="#__codelineno-0-1053">1053</a></span>
<span class="normal"><a href="#__codelineno-0-1054">1054</a></span>
<span class="normal"><a href="#__codelineno-0-1055">1055</a></span>
<span class="normal"><a href="#__codelineno-0-1056">1056</a></span>
<span class="normal"><a href="#__codelineno-0-1057">1057</a></span>
<span class="normal"><a href="#__codelineno-0-1058">1058</a></span>
<span class="normal"><a href="#__codelineno-0-1059">1059</a></span>
<span class="normal"><a href="#__codelineno-0-1060">1060</a></span>
<span class="normal"><a href="#__codelineno-0-1061">1061</a></span>
<span class="normal"><a href="#__codelineno-0-1062">1062</a></span>
<span class="normal"><a href="#__codelineno-0-1063">1063</a></span>
<span class="normal"><a href="#__codelineno-0-1064">1064</a></span>
<span class="normal"><a href="#__codelineno-0-1065">1065</a></span>
<span class="normal"><a href="#__codelineno-0-1066">1066</a></span>
<span class="normal"><a href="#__codelineno-0-1067">1067</a></span>
<span class="normal"><a href="#__codelineno-0-1068">1068</a></span>
<span class="normal"><a href="#__codelineno-0-1069">1069</a></span>
<span class="normal"><a href="#__codelineno-0-1070">1070</a></span>
<span class="normal"><a href="#__codelineno-0-1071">1071</a></span>
<span class="normal"><a href="#__codelineno-0-1072">1072</a></span>
<span class="normal"><a href="#__codelineno-0-1073">1073</a></span>
<span class="normal"><a href="#__codelineno-0-1074">1074</a></span>
<span class="normal"><a href="#__codelineno-0-1075">1075</a></span>
<span class="normal"><a href="#__codelineno-0-1076">1076</a></span>
<span class="normal"><a href="#__codelineno-0-1077">1077</a></span>
<span class="normal"><a href="#__codelineno-0-1078">1078</a></span>
<span class="normal"><a href="#__codelineno-0-1079">1079</a></span>
<span class="normal"><a href="#__codelineno-0-1080">1080</a></span>
<span class="normal"><a href="#__codelineno-0-1081">1081</a></span>
<span class="normal"><a href="#__codelineno-0-1082">1082</a></span>
<span class="normal"><a href="#__codelineno-0-1083">1083</a></span>
<span class="normal"><a href="#__codelineno-0-1084">1084</a></span>
<span class="normal"><a href="#__codelineno-0-1085">1085</a></span>
<span class="normal"><a href="#__codelineno-0-1086">1086</a></span>
<span class="normal"><a href="#__codelineno-0-1087">1087</a></span>
<span class="normal"><a href="#__codelineno-0-1088">1088</a></span>
<span class="normal"><a href="#__codelineno-0-1089">1089</a></span>
<span class="normal"><a href="#__codelineno-0-1090">1090</a></span>
<span class="normal"><a href="#__codelineno-0-1091">1091</a></span>
<span class="normal"><a href="#__codelineno-0-1092">1092</a></span>
<span class="normal"><a href="#__codelineno-0-1093">1093</a></span>
<span class="normal"><a href="#__codelineno-0-1094">1094</a></span>
<span class="normal"><a href="#__codelineno-0-1095">1095</a></span>
<span class="normal"><a href="#__codelineno-0-1096">1096</a></span>
<span class="normal"><a href="#__codelineno-0-1097">1097</a></span>
<span class="normal"><a href="#__codelineno-0-1098">1098</a></span>
<span class="normal"><a href="#__codelineno-0-1099">1099</a></span>
<span class="normal"><a href="#__codelineno-0-1100">1100</a></span>
<span class="normal"><a href="#__codelineno-0-1101">1101</a></span>
<span class="normal"><a href="#__codelineno-0-1102">1102</a></span>
<span class="normal"><a href="#__codelineno-0-1103">1103</a></span>
<span class="normal"><a href="#__codelineno-0-1104">1104</a></span>
<span class="normal"><a href="#__codelineno-0-1105">1105</a></span>
<span class="normal"><a href="#__codelineno-0-1106">1106</a></span>
<span class="normal"><a href="#__codelineno-0-1107">1107</a></span>
<span class="normal"><a href="#__codelineno-0-1108">1108</a></span>
<span class="normal"><a href="#__codelineno-0-1109">1109</a></span>
<span class="normal"><a href="#__codelineno-0-1110">1110</a></span>
<span class="normal"><a href="#__codelineno-0-1111">1111</a></span>
<span class="normal"><a href="#__codelineno-0-1112">1112</a></span>
<span class="normal"><a href="#__codelineno-0-1113">1113</a></span>
<span class="normal"><a href="#__codelineno-0-1114">1114</a></span>
<span class="normal"><a href="#__codelineno-0-1115">1115</a></span>
<span class="normal"><a href="#__codelineno-0-1116">1116</a></span>
<span class="normal"><a href="#__codelineno-0-1117">1117</a></span>
<span class="normal"><a href="#__codelineno-0-1118">1118</a></span>
<span class="normal"><a href="#__codelineno-0-1119">1119</a></span>
<span class="normal"><a href="#__codelineno-0-1120">1120</a></span>
<span class="normal"><a href="#__codelineno-0-1121">1121</a></span>
<span class="normal"><a href="#__codelineno-0-1122">1122</a></span>
<span class="normal"><a href="#__codelineno-0-1123">1123</a></span>
<span class="normal"><a href="#__codelineno-0-1124">1124</a></span>
<span class="normal"><a href="#__codelineno-0-1125">1125</a></span>
<span class="normal"><a href="#__codelineno-0-1126">1126</a></span>
<span class="normal"><a href="#__codelineno-0-1127">1127</a></span>
<span class="normal"><a href="#__codelineno-0-1128">1128</a></span>
<span class="normal"><a href="#__codelineno-0-1129">1129</a></span>
<span class="normal"><a href="#__codelineno-0-1130">1130</a></span>
<span class="normal"><a href="#__codelineno-0-1131">1131</a></span>
<span class="normal"><a href="#__codelineno-0-1132">1132</a></span>
<span class="normal"><a href="#__codelineno-0-1133">1133</a></span>
<span class="normal"><a href="#__codelineno-0-1134">1134</a></span>
<span class="normal"><a href="#__codelineno-0-1135">1135</a></span>
<span class="normal"><a href="#__codelineno-0-1136">1136</a></span>
<span class="normal"><a href="#__codelineno-0-1137">1137</a></span>
<span class="normal"><a href="#__codelineno-0-1138">1138</a></span>
<span class="normal"><a href="#__codelineno-0-1139">1139</a></span>
<span class="normal"><a href="#__codelineno-0-1140">1140</a></span>
<span class="normal"><a href="#__codelineno-0-1141">1141</a></span>
<span class="normal"><a href="#__codelineno-0-1142">1142</a></span>
<span class="normal"><a href="#__codelineno-0-1143">1143</a></span>
<span class="normal"><a href="#__codelineno-0-1144">1144</a></span>
<span class="normal"><a href="#__codelineno-0-1145">1145</a></span>
<span class="normal"><a href="#__codelineno-0-1146">1146</a></span>
<span class="normal"><a href="#__codelineno-0-1147">1147</a></span>
<span class="normal"><a href="#__codelineno-0-1148">1148</a></span>
<span class="normal"><a href="#__codelineno-0-1149">1149</a></span>
<span class="normal"><a href="#__codelineno-0-1150">1150</a></span>
<span class="normal"><a href="#__codelineno-0-1151">1151</a></span>
<span class="normal"><a href="#__codelineno-0-1152">1152</a></span>
<span class="normal"><a href="#__codelineno-0-1153">1153</a></span>
<span class="normal"><a href="#__codelineno-0-1154">1154</a></span>
<span class="normal"><a href="#__codelineno-0-1155">1155</a></span>
<span class="normal"><a href="#__codelineno-0-1156">1156</a></span>
<span class="normal"><a href="#__codelineno-0-1157">1157</a></span>
<span class="normal"><a href="#__codelineno-0-1158">1158</a></span>
<span class="normal"><a href="#__codelineno-0-1159">1159</a></span>
<span class="normal"><a href="#__codelineno-0-1160">1160</a></span>
<span class="normal"><a href="#__codelineno-0-1161">1161</a></span>
<span class="normal"><a href="#__codelineno-0-1162">1162</a></span>
<span class="normal"><a href="#__codelineno-0-1163">1163</a></span>
<span class="normal"><a href="#__codelineno-0-1164">1164</a></span>
<span class="normal"><a href="#__codelineno-0-1165">1165</a></span>
<span class="normal"><a href="#__codelineno-0-1166">1166</a></span>
<span class="normal"><a href="#__codelineno-0-1167">1167</a></span>
<span class="normal"><a href="#__codelineno-0-1168">1168</a></span>
<span class="normal"><a href="#__codelineno-0-1169">1169</a></span>
<span class="normal"><a href="#__codelineno-0-1170">1170</a></span>
<span class="normal"><a href="#__codelineno-0-1171">1171</a></span>
<span class="normal"><a href="#__codelineno-0-1172">1172</a></span>
<span class="normal"><a href="#__codelineno-0-1173">1173</a></span>
<span class="normal"><a href="#__codelineno-0-1174">1174</a></span>
<span class="normal"><a href="#__codelineno-0-1175">1175</a></span>
<span class="normal"><a href="#__codelineno-0-1176">1176</a></span>
<span class="normal"><a href="#__codelineno-0-1177">1177</a></span>
<span class="normal"><a href="#__codelineno-0-1178">1178</a></span>
<span class="normal"><a href="#__codelineno-0-1179">1179</a></span>
<span class="normal"><a href="#__codelineno-0-1180">1180</a></span>
<span class="normal"><a href="#__codelineno-0-1181">1181</a></span>
<span class="normal"><a href="#__codelineno-0-1182">1182</a></span>
<span class="normal"><a href="#__codelineno-0-1183">1183</a></span>
<span class="normal"><a href="#__codelineno-0-1184">1184</a></span>
<span class="normal"><a href="#__codelineno-0-1185">1185</a></span>
<span class="normal"><a href="#__codelineno-0-1186">1186</a></span>
<span class="normal"><a href="#__codelineno-0-1187">1187</a></span>
<span class="normal"><a href="#__codelineno-0-1188">1188</a></span>
<span class="normal"><a href="#__codelineno-0-1189">1189</a></span>
<span class="normal"><a href="#__codelineno-0-1190">1190</a></span>
<span class="normal"><a href="#__codelineno-0-1191">1191</a></span>
<span class="normal"><a href="#__codelineno-0-1192">1192</a></span>
<span class="normal"><a href="#__codelineno-0-1193">1193</a></span>
<span class="normal"><a href="#__codelineno-0-1194">1194</a></span>
<span class="normal"><a href="#__codelineno-0-1195">1195</a></span>
<span class="normal"><a href="#__codelineno-0-1196">1196</a></span>
<span class="normal"><a href="#__codelineno-0-1197">1197</a></span>
<span class="normal"><a href="#__codelineno-0-1198">1198</a></span>
<span class="normal"><a href="#__codelineno-0-1199">1199</a></span>
<span class="normal"><a href="#__codelineno-0-1200">1200</a></span>
<span class="normal"><a href="#__codelineno-0-1201">1201</a></span>
<span class="normal"><a href="#__codelineno-0-1202">1202</a></span>
<span class="normal"><a href="#__codelineno-0-1203">1203</a></span>
<span class="normal"><a href="#__codelineno-0-1204">1204</a></span>
<span class="normal"><a href="#__codelineno-0-1205">1205</a></span>
<span class="normal"><a href="#__codelineno-0-1206">1206</a></span>
<span class="normal"><a href="#__codelineno-0-1207">1207</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1047" name="__codelineno-0-1047"></a><span class="k">class</span><span class="w"> </span><span class="nc">MeshgridDataDict</span><span class="p">(</span><span class="n">DataDictBase</span><span class="p">):</span>
<a id="__codelineno-0-1048" name="__codelineno-0-1048"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1049" name="__codelineno-0-1049"></a><span class="sd">    Implementation of DataDictBase meant to be used for when the axes form</span>
<a id="__codelineno-0-1050" name="__codelineno-0-1050"></a><span class="sd">    a grid on which the dependent values reside.</span>
<a id="__codelineno-0-1051" name="__codelineno-0-1051"></a>
<a id="__codelineno-0-1052" name="__codelineno-0-1052"></a><span class="sd">    It enforces that all dependents have the same axes and all shapes need to be identical.</span>
<a id="__codelineno-0-1053" name="__codelineno-0-1053"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1054" name="__codelineno-0-1054"></a>
<a id="__codelineno-0-1055" name="__codelineno-0-1055"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]]:</span>
<a id="__codelineno-0-1056" name="__codelineno-0-1056"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1057" name="__codelineno-0-1057"></a><span class="sd">        Return the shape of the meshgrid.</span>
<a id="__codelineno-0-1058" name="__codelineno-0-1058"></a>
<a id="__codelineno-0-1059" name="__codelineno-0-1059"></a><span class="sd">        :returns: The shape as tuple. ``None`` if no data in the set.</span>
<a id="__codelineno-0-1060" name="__codelineno-0-1060"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1061" name="__codelineno-0-1061"></a>        <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-1062" name="__codelineno-0-1062"></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_vals</span><span class="p">(</span><span class="n">d</span><span class="p">))</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-1063" name="__codelineno-0-1063"></a>        <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-1064" name="__codelineno-0-1064"></a>
<a id="__codelineno-0-1065" name="__codelineno-0-1065"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1066" name="__codelineno-0-1066"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1067" name="__codelineno-0-1067"></a><span class="sd">        Validation of the dataset.</span>
<a id="__codelineno-0-1068" name="__codelineno-0-1068"></a>
<a id="__codelineno-0-1069" name="__codelineno-0-1069"></a><span class="sd">        Performs the following checks:</span>
<a id="__codelineno-0-1070" name="__codelineno-0-1070"></a><span class="sd">        * All dependents must have the same axes.</span>
<a id="__codelineno-0-1071" name="__codelineno-0-1071"></a><span class="sd">        * All shapes need to be identical.</span>
<a id="__codelineno-0-1072" name="__codelineno-0-1072"></a>
<a id="__codelineno-0-1073" name="__codelineno-0-1073"></a><span class="sd">        :return: ``True`` if valid.</span>
<a id="__codelineno-0-1074" name="__codelineno-0-1074"></a><span class="sd">        :raises: ``ValueError`` if invalid.</span>
<a id="__codelineno-0-1075" name="__codelineno-0-1075"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1076" name="__codelineno-0-1076"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">validate</span><span class="p">():</span>
<a id="__codelineno-0-1077" name="__codelineno-0-1077"></a>            <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-1078" name="__codelineno-0-1078"></a>
<a id="__codelineno-0-1079" name="__codelineno-0-1079"></a>        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-1080" name="__codelineno-0-1080"></a>
<a id="__codelineno-0-1081" name="__codelineno-0-1081"></a>        <span class="n">axes</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1082" name="__codelineno-0-1082"></a>        <span class="n">axessrc</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a id="__codelineno-0-1083" name="__codelineno-0-1083"></a>        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dependents</span><span class="p">():</span>
<a id="__codelineno-0-1084" name="__codelineno-0-1084"></a>            <span class="k">if</span> <span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1085" name="__codelineno-0-1085"></a>                <span class="n">axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<a id="__codelineno-0-1086" name="__codelineno-0-1086"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1087" name="__codelineno-0-1087"></a>                <span class="k">if</span> <span class="n">axes</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
<a id="__codelineno-0-1088" name="__codelineno-0-1088"></a>                    <span class="n">msg</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; * All dependents must have the same axes, but &quot;</span>
<a id="__codelineno-0-1089" name="__codelineno-0-1089"></a>                    <span class="n">msg</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s2"> has </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">axessrc</span><span class="si">}</span><span class="s2"> has </span><span class="si">{</span><span class="n">axes</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-1090" name="__codelineno-0-1090"></a>
<a id="__codelineno-0-1091" name="__codelineno-0-1091"></a>        <span class="n">shp</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1092" name="__codelineno-0-1092"></a>        <span class="n">shpsrc</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a id="__codelineno-0-1093" name="__codelineno-0-1093"></a>
<a id="__codelineno-0-1094" name="__codelineno-0-1094"></a>        <span class="n">data_items</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_items</span><span class="p">())</span>
<a id="__codelineno-0-1095" name="__codelineno-0-1095"></a>
<a id="__codelineno-0-1096" name="__codelineno-0-1096"></a>        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data_items</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-1097" name="__codelineno-0-1097"></a>            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">])</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">MaskedArray</span><span class="p">]:</span>
<a id="__codelineno-0-1098" name="__codelineno-0-1098"></a>                <span class="bp">self</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">])</span>
<a id="__codelineno-0-1099" name="__codelineno-0-1099"></a>
<a id="__codelineno-0-1100" name="__codelineno-0-1100"></a>            <span class="k">if</span> <span class="n">shp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1101" name="__codelineno-0-1101"></a>                <span class="n">shp</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-1102" name="__codelineno-0-1102"></a>                <span class="n">shpsrc</span> <span class="o">=</span> <span class="n">n</span>
<a id="__codelineno-0-1103" name="__codelineno-0-1103"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1104" name="__codelineno-0-1104"></a>                <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">shp</span><span class="p">:</span>
<a id="__codelineno-0-1105" name="__codelineno-0-1105"></a>                    <span class="n">msg</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; * shapes need to match, but &#39;</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">&#39; has&quot;</span>
<a id="__codelineno-0-1106" name="__codelineno-0-1106"></a>                    <span class="n">msg</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">, &quot;</span>
<a id="__codelineno-0-1107" name="__codelineno-0-1107"></a>                    <span class="n">msg</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;and &#39;</span><span class="si">{</span><span class="n">shpsrc</span><span class="si">}</span><span class="s2">&#39; has </span><span class="si">{</span><span class="n">shp</span><span class="si">}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-1108" name="__codelineno-0-1108"></a>
<a id="__codelineno-0-1109" name="__codelineno-0-1109"></a>            <span class="k">if</span> <span class="n">msg</span> <span class="o">!=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span>
<a id="__codelineno-0-1110" name="__codelineno-0-1110"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<a id="__codelineno-0-1111" name="__codelineno-0-1111"></a>
<a id="__codelineno-0-1112" name="__codelineno-0-1112"></a>            <span class="k">if</span> <span class="s1">&#39;axes&#39;</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
<a id="__codelineno-0-1113" name="__codelineno-0-1113"></a>                <span class="k">for</span> <span class="n">axis_num</span><span class="p">,</span> <span class="n">na</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;axes&#39;</span><span class="p">]):</span>
<a id="__codelineno-0-1114" name="__codelineno-0-1114"></a>                    <span class="c1"># check that the data of the axes matches its use</span>
<a id="__codelineno-0-1115" name="__codelineno-0-1115"></a>                    <span class="c1"># if data present</span>
<a id="__codelineno-0-1116" name="__codelineno-0-1116"></a>                    <span class="n">axis_data</span> <span class="o">=</span> <span class="n">data_items</span><span class="p">[</span><span class="n">na</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span>
<a id="__codelineno-0-1117" name="__codelineno-0-1117"></a>
<a id="__codelineno-0-1118" name="__codelineno-0-1118"></a>                    <span class="c1"># for the data to be a valid meshgrid, we need to have an increase/decrease along each</span>
<a id="__codelineno-0-1119" name="__codelineno-0-1119"></a>                    <span class="c1"># axis that contains data.</span>
<a id="__codelineno-0-1120" name="__codelineno-0-1120"></a>                    <span class="k">if</span> <span class="n">axis_data</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1121" name="__codelineno-0-1121"></a>                        <span class="c1"># if axis length is 1, then we cannot infer anything about grids yet</span>
<a id="__codelineno-0-1122" name="__codelineno-0-1122"></a>
<a id="__codelineno-0-1123" name="__codelineno-0-1123"></a>                        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-1124" name="__codelineno-0-1124"></a>                            <span class="k">if</span> <span class="n">axis_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis_num</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-1125" name="__codelineno-0-1125"></a>                                <span class="n">steps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">axis_data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis_num</span><span class="p">)))</span>
<a id="__codelineno-0-1126" name="__codelineno-0-1126"></a>
<a id="__codelineno-0-1127" name="__codelineno-0-1127"></a>                                <span class="c1"># for incomplete data, there maybe nan steps -- we need to remove those, </span>
<a id="__codelineno-0-1128" name="__codelineno-0-1128"></a>                                <span class="c1"># doesn&#39;t mean anything is wrong.</span>
<a id="__codelineno-0-1129" name="__codelineno-0-1129"></a>                                <span class="n">steps</span> <span class="o">=</span> <span class="n">steps</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">steps</span><span class="p">)]</span>
<a id="__codelineno-0-1130" name="__codelineno-0-1130"></a>
<a id="__codelineno-0-1131" name="__codelineno-0-1131"></a>                                <span class="k">if</span> <span class="mi">0</span> <span class="ow">in</span> <span class="n">steps</span><span class="p">:</span>
<a id="__codelineno-0-1132" name="__codelineno-0-1132"></a>                                    <span class="n">msg</span> <span class="o">+=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Malformed data: </span><span class="si">{</span><span class="n">na</span><span class="si">}</span><span class="s2"> is expected to be </span><span class="si">{</span><span class="n">axis_num</span><span class="si">}</span><span class="s2">th &quot;</span>
<a id="__codelineno-0-1133" name="__codelineno-0-1133"></a>                                            <span class="s2">&quot;axis but has no variation along that axis.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1134" name="__codelineno-0-1134"></a>                                <span class="k">if</span> <span class="n">steps</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-1135" name="__codelineno-0-1135"></a>                                    <span class="n">msg</span> <span class="o">+=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Malformed data: axis </span><span class="si">{</span><span class="n">na</span><span class="si">}</span><span class="s2"> is not monotonous.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1136" name="__codelineno-0-1136"></a>
<a id="__codelineno-0-1137" name="__codelineno-0-1137"></a>                        <span class="c1"># can happen if we have bad shapes. but that should already have been caught.</span>
<a id="__codelineno-0-1138" name="__codelineno-0-1138"></a>                        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
<a id="__codelineno-0-1139" name="__codelineno-0-1139"></a>                            <span class="k">pass</span>
<a id="__codelineno-0-1140" name="__codelineno-0-1140"></a>
<a id="__codelineno-0-1141" name="__codelineno-0-1141"></a>            <span class="k">if</span> <span class="s1">&#39;__shape__&#39;</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
<a id="__codelineno-0-1142" name="__codelineno-0-1142"></a>                <span class="n">v</span><span class="p">[</span><span class="s1">&#39;__shape__&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">shp</span>
<a id="__codelineno-0-1143" name="__codelineno-0-1143"></a>
<a id="__codelineno-0-1144" name="__codelineno-0-1144"></a>            <span class="k">if</span> <span class="n">msg</span> <span class="o">!=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span>
<a id="__codelineno-0-1145" name="__codelineno-0-1145"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<a id="__codelineno-0-1146" name="__codelineno-0-1146"></a>
<a id="__codelineno-0-1147" name="__codelineno-0-1147"></a>        <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-1148" name="__codelineno-0-1148"></a>
<a id="__codelineno-0-1149" name="__codelineno-0-1149"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">reorder_axes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_names</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1150" name="__codelineno-0-1150"></a>                     <span class="o">**</span><span class="n">pos</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;MeshgridDataDict&#39;</span><span class="p">:</span>
<a id="__codelineno-0-1151" name="__codelineno-0-1151"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1152" name="__codelineno-0-1152"></a><span class="sd">        Reorder the axes for all data.</span>
<a id="__codelineno-0-1153" name="__codelineno-0-1153"></a>
<a id="__codelineno-0-1154" name="__codelineno-0-1154"></a><span class="sd">        This includes transposing the data, since we&#39;re on a grid.</span>
<a id="__codelineno-0-1155" name="__codelineno-0-1155"></a>
<a id="__codelineno-0-1156" name="__codelineno-0-1156"></a><span class="sd">        :param data_names: Which dependents to include. if None are given,</span>
<a id="__codelineno-0-1157" name="__codelineno-0-1157"></a><span class="sd">                           all dependents are included.</span>
<a id="__codelineno-0-1158" name="__codelineno-0-1158"></a><span class="sd">        :param pos: New axes position in the form ``axis_name = new_position``.</span>
<a id="__codelineno-0-1159" name="__codelineno-0-1159"></a><span class="sd">                    non-specified axes positions are adjusted automatically.</span>
<a id="__codelineno-0-1160" name="__codelineno-0-1160"></a>
<a id="__codelineno-0-1161" name="__codelineno-0-1161"></a><span class="sd">        :return: Dataset with re-ordered axes.</span>
<a id="__codelineno-0-1162" name="__codelineno-0-1162"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1163" name="__codelineno-0-1163"></a>        <span class="k">if</span> <span class="n">data_names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1164" name="__codelineno-0-1164"></a>            <span class="n">data_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dependents</span><span class="p">()</span>
<a id="__codelineno-0-1165" name="__codelineno-0-1165"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data_names</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-1166" name="__codelineno-0-1166"></a>            <span class="n">data_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">data_names</span><span class="p">]</span>
<a id="__codelineno-0-1167" name="__codelineno-0-1167"></a>
<a id="__codelineno-0-1168" name="__codelineno-0-1168"></a>        <span class="n">transposed</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1169" name="__codelineno-0-1169"></a>        <span class="n">orders</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1170" name="__codelineno-0-1170"></a>        <span class="n">orig_axes</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1171" name="__codelineno-0-1171"></a>        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">data_names</span><span class="p">:</span>
<a id="__codelineno-0-1172" name="__codelineno-0-1172"></a>            <span class="n">orders</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reorder_axes_indices</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="o">**</span><span class="n">pos</span><span class="p">)</span>
<a id="__codelineno-0-1173" name="__codelineno-0-1173"></a>            <span class="n">orig_axes</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-1174" name="__codelineno-0-1174"></a>
<a id="__codelineno-0-1175" name="__codelineno-0-1175"></a>        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">data_names</span><span class="p">:</span>
<a id="__codelineno-0-1176" name="__codelineno-0-1176"></a>            <span class="n">neworder</span><span class="p">,</span> <span class="n">newaxes</span> <span class="o">=</span> <span class="n">orders</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
<a id="__codelineno-0-1177" name="__codelineno-0-1177"></a>            <span class="bp">self</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">&#39;axes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">newaxes</span>
<a id="__codelineno-0-1178" name="__codelineno-0-1178"></a>            <span class="bp">self</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">neworder</span><span class="p">)</span>
<a id="__codelineno-0-1179" name="__codelineno-0-1179"></a>            <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">orig_axes</span><span class="p">[</span><span class="n">n</span><span class="p">]:</span>
<a id="__codelineno-0-1180" name="__codelineno-0-1180"></a>                <span class="k">if</span> <span class="n">ax</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">transposed</span><span class="p">:</span>
<a id="__codelineno-0-1181" name="__codelineno-0-1181"></a>                    <span class="bp">self</span><span class="p">[</span><span class="n">ax</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">ax</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">neworder</span><span class="p">)</span>
<a id="__codelineno-0-1182" name="__codelineno-0-1182"></a>                    <span class="n">transposed</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<a id="__codelineno-0-1183" name="__codelineno-0-1183"></a>
<a id="__codelineno-0-1184" name="__codelineno-0-1184"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
<a id="__codelineno-0-1185" name="__codelineno-0-1185"></a>        <span class="k">return</span> <span class="bp">self</span>
<a id="__codelineno-0-1186" name="__codelineno-0-1186"></a>
<a id="__codelineno-0-1187" name="__codelineno-0-1187"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;MeshgridDataDict&#39;</span><span class="p">:</span>
<a id="__codelineno-0-1188" name="__codelineno-0-1188"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Take the mean over the given axis.</span>
<a id="__codelineno-0-1189" name="__codelineno-0-1189"></a>
<a id="__codelineno-0-1190" name="__codelineno-0-1190"></a><span class="sd">        :param axis: which axis to take the average over.</span>
<a id="__codelineno-0-1191" name="__codelineno-0-1191"></a><span class="sd">        :return: data, averaged over ``axis``.</span>
<a id="__codelineno-0-1192" name="__codelineno-0-1192"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1193" name="__codelineno-0-1193"></a>        <span class="k">return</span> <span class="n">_mesh_mean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
<a id="__codelineno-0-1194" name="__codelineno-0-1194"></a>
<a id="__codelineno-0-1195" name="__codelineno-0-1195"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">slice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">slice</span><span class="p">,</span> <span class="nb">int</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="s1">&#39;MeshgridDataDict&#39;</span><span class="p">:</span>
<a id="__codelineno-0-1196" name="__codelineno-0-1196"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a N-d slice of the data.</span>
<a id="__codelineno-0-1197" name="__codelineno-0-1197"></a>
<a id="__codelineno-0-1198" name="__codelineno-0-1198"></a><span class="sd">        :param kwargs: slicing information in the format ``axis: spec``, where</span>
<a id="__codelineno-0-1199" name="__codelineno-0-1199"></a><span class="sd">            ``spec`` can be a ``slice`` object, or an integer (usual slicing </span>
<a id="__codelineno-0-1200" name="__codelineno-0-1200"></a><span class="sd">            notation).</span>
<a id="__codelineno-0-1201" name="__codelineno-0-1201"></a><span class="sd">        :return: sliced data (as a copy)</span>
<a id="__codelineno-0-1202" name="__codelineno-0-1202"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1203" name="__codelineno-0-1203"></a>        <span class="k">return</span> <span class="n">_mesh_slice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-1204" name="__codelineno-0-1204"></a>
<a id="__codelineno-0-1205" name="__codelineno-0-1205"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">squeeze</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1206" name="__codelineno-0-1206"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Remove size-1 dimensions.&quot;&quot;&quot;</span>
<a id="__codelineno-0-1207" name="__codelineno-0-1207"></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict.MeshgridDataDict.mean" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Take the mean over the given axis.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>axis</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>which axis to take the average over.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="labcore.data.datadict.MeshgridDataDict" href="#labcore.data.datadict.MeshgridDataDict">MeshgridDataDict</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>data, averaged over <code>axis</code>.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1187">1187</a></span>
<span class="normal"><a href="#__codelineno-0-1188">1188</a></span>
<span class="normal"><a href="#__codelineno-0-1189">1189</a></span>
<span class="normal"><a href="#__codelineno-0-1190">1190</a></span>
<span class="normal"><a href="#__codelineno-0-1191">1191</a></span>
<span class="normal"><a href="#__codelineno-0-1192">1192</a></span>
<span class="normal"><a href="#__codelineno-0-1193">1193</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1187" name="__codelineno-0-1187"></a><span class="k">def</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;MeshgridDataDict&#39;</span><span class="p">:</span>
<a id="__codelineno-0-1188" name="__codelineno-0-1188"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Take the mean over the given axis.</span>
<a id="__codelineno-0-1189" name="__codelineno-0-1189"></a>
<a id="__codelineno-0-1190" name="__codelineno-0-1190"></a><span class="sd">    :param axis: which axis to take the average over.</span>
<a id="__codelineno-0-1191" name="__codelineno-0-1191"></a><span class="sd">    :return: data, averaged over ``axis``.</span>
<a id="__codelineno-0-1192" name="__codelineno-0-1192"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1193" name="__codelineno-0-1193"></a>    <span class="k">return</span> <span class="n">_mesh_mean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict.MeshgridDataDict.reorder_axes" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">reorder_axes</span><span class="p">(</span><span class="n">data_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">pos</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Reorder the axes for all data.</p>
<p>This includes transposing the data, since we're on a grid.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data_names</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, <span title="typing.Sequence">Sequence</span>[str], None]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Which dependents to include. if None are given, all dependents are included.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>pos</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>New axes position in the form <code>axis_name = new_position</code>. non-specified axes positions are adjusted automatically.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="labcore.data.datadict.MeshgridDataDict" href="#labcore.data.datadict.MeshgridDataDict">MeshgridDataDict</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dataset with re-ordered axes.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1149">1149</a></span>
<span class="normal"><a href="#__codelineno-0-1150">1150</a></span>
<span class="normal"><a href="#__codelineno-0-1151">1151</a></span>
<span class="normal"><a href="#__codelineno-0-1152">1152</a></span>
<span class="normal"><a href="#__codelineno-0-1153">1153</a></span>
<span class="normal"><a href="#__codelineno-0-1154">1154</a></span>
<span class="normal"><a href="#__codelineno-0-1155">1155</a></span>
<span class="normal"><a href="#__codelineno-0-1156">1156</a></span>
<span class="normal"><a href="#__codelineno-0-1157">1157</a></span>
<span class="normal"><a href="#__codelineno-0-1158">1158</a></span>
<span class="normal"><a href="#__codelineno-0-1159">1159</a></span>
<span class="normal"><a href="#__codelineno-0-1160">1160</a></span>
<span class="normal"><a href="#__codelineno-0-1161">1161</a></span>
<span class="normal"><a href="#__codelineno-0-1162">1162</a></span>
<span class="normal"><a href="#__codelineno-0-1163">1163</a></span>
<span class="normal"><a href="#__codelineno-0-1164">1164</a></span>
<span class="normal"><a href="#__codelineno-0-1165">1165</a></span>
<span class="normal"><a href="#__codelineno-0-1166">1166</a></span>
<span class="normal"><a href="#__codelineno-0-1167">1167</a></span>
<span class="normal"><a href="#__codelineno-0-1168">1168</a></span>
<span class="normal"><a href="#__codelineno-0-1169">1169</a></span>
<span class="normal"><a href="#__codelineno-0-1170">1170</a></span>
<span class="normal"><a href="#__codelineno-0-1171">1171</a></span>
<span class="normal"><a href="#__codelineno-0-1172">1172</a></span>
<span class="normal"><a href="#__codelineno-0-1173">1173</a></span>
<span class="normal"><a href="#__codelineno-0-1174">1174</a></span>
<span class="normal"><a href="#__codelineno-0-1175">1175</a></span>
<span class="normal"><a href="#__codelineno-0-1176">1176</a></span>
<span class="normal"><a href="#__codelineno-0-1177">1177</a></span>
<span class="normal"><a href="#__codelineno-0-1178">1178</a></span>
<span class="normal"><a href="#__codelineno-0-1179">1179</a></span>
<span class="normal"><a href="#__codelineno-0-1180">1180</a></span>
<span class="normal"><a href="#__codelineno-0-1181">1181</a></span>
<span class="normal"><a href="#__codelineno-0-1182">1182</a></span>
<span class="normal"><a href="#__codelineno-0-1183">1183</a></span>
<span class="normal"><a href="#__codelineno-0-1184">1184</a></span>
<span class="normal"><a href="#__codelineno-0-1185">1185</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1149" name="__codelineno-0-1149"></a><span class="k">def</span><span class="w"> </span><span class="nf">reorder_axes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_names</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1150" name="__codelineno-0-1150"></a>                 <span class="o">**</span><span class="n">pos</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;MeshgridDataDict&#39;</span><span class="p">:</span>
<a id="__codelineno-0-1151" name="__codelineno-0-1151"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1152" name="__codelineno-0-1152"></a><span class="sd">    Reorder the axes for all data.</span>
<a id="__codelineno-0-1153" name="__codelineno-0-1153"></a>
<a id="__codelineno-0-1154" name="__codelineno-0-1154"></a><span class="sd">    This includes transposing the data, since we&#39;re on a grid.</span>
<a id="__codelineno-0-1155" name="__codelineno-0-1155"></a>
<a id="__codelineno-0-1156" name="__codelineno-0-1156"></a><span class="sd">    :param data_names: Which dependents to include. if None are given,</span>
<a id="__codelineno-0-1157" name="__codelineno-0-1157"></a><span class="sd">                       all dependents are included.</span>
<a id="__codelineno-0-1158" name="__codelineno-0-1158"></a><span class="sd">    :param pos: New axes position in the form ``axis_name = new_position``.</span>
<a id="__codelineno-0-1159" name="__codelineno-0-1159"></a><span class="sd">                non-specified axes positions are adjusted automatically.</span>
<a id="__codelineno-0-1160" name="__codelineno-0-1160"></a>
<a id="__codelineno-0-1161" name="__codelineno-0-1161"></a><span class="sd">    :return: Dataset with re-ordered axes.</span>
<a id="__codelineno-0-1162" name="__codelineno-0-1162"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1163" name="__codelineno-0-1163"></a>    <span class="k">if</span> <span class="n">data_names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1164" name="__codelineno-0-1164"></a>        <span class="n">data_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dependents</span><span class="p">()</span>
<a id="__codelineno-0-1165" name="__codelineno-0-1165"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data_names</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-1166" name="__codelineno-0-1166"></a>        <span class="n">data_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">data_names</span><span class="p">]</span>
<a id="__codelineno-0-1167" name="__codelineno-0-1167"></a>
<a id="__codelineno-0-1168" name="__codelineno-0-1168"></a>    <span class="n">transposed</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1169" name="__codelineno-0-1169"></a>    <span class="n">orders</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1170" name="__codelineno-0-1170"></a>    <span class="n">orig_axes</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1171" name="__codelineno-0-1171"></a>    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">data_names</span><span class="p">:</span>
<a id="__codelineno-0-1172" name="__codelineno-0-1172"></a>        <span class="n">orders</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reorder_axes_indices</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="o">**</span><span class="n">pos</span><span class="p">)</span>
<a id="__codelineno-0-1173" name="__codelineno-0-1173"></a>        <span class="n">orig_axes</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-1174" name="__codelineno-0-1174"></a>
<a id="__codelineno-0-1175" name="__codelineno-0-1175"></a>    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">data_names</span><span class="p">:</span>
<a id="__codelineno-0-1176" name="__codelineno-0-1176"></a>        <span class="n">neworder</span><span class="p">,</span> <span class="n">newaxes</span> <span class="o">=</span> <span class="n">orders</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
<a id="__codelineno-0-1177" name="__codelineno-0-1177"></a>        <span class="bp">self</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">&#39;axes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">newaxes</span>
<a id="__codelineno-0-1178" name="__codelineno-0-1178"></a>        <span class="bp">self</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">neworder</span><span class="p">)</span>
<a id="__codelineno-0-1179" name="__codelineno-0-1179"></a>        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">orig_axes</span><span class="p">[</span><span class="n">n</span><span class="p">]:</span>
<a id="__codelineno-0-1180" name="__codelineno-0-1180"></a>            <span class="k">if</span> <span class="n">ax</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">transposed</span><span class="p">:</span>
<a id="__codelineno-0-1181" name="__codelineno-0-1181"></a>                <span class="bp">self</span><span class="p">[</span><span class="n">ax</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">ax</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">neworder</span><span class="p">)</span>
<a id="__codelineno-0-1182" name="__codelineno-0-1182"></a>                <span class="n">transposed</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<a id="__codelineno-0-1183" name="__codelineno-0-1183"></a>
<a id="__codelineno-0-1184" name="__codelineno-0-1184"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
<a id="__codelineno-0-1185" name="__codelineno-0-1185"></a>    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict.MeshgridDataDict.shape" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">shape</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Return the shape of the meshgrid.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Union">Union</span>[None, <span title="typing.Tuple">Tuple</span>[int, ...]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The shape as tuple. <code>None</code> if no data in the set.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1055">1055</a></span>
<span class="normal"><a href="#__codelineno-0-1056">1056</a></span>
<span class="normal"><a href="#__codelineno-0-1057">1057</a></span>
<span class="normal"><a href="#__codelineno-0-1058">1058</a></span>
<span class="normal"><a href="#__codelineno-0-1059">1059</a></span>
<span class="normal"><a href="#__codelineno-0-1060">1060</a></span>
<span class="normal"><a href="#__codelineno-0-1061">1061</a></span>
<span class="normal"><a href="#__codelineno-0-1062">1062</a></span>
<span class="normal"><a href="#__codelineno-0-1063">1063</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1055" name="__codelineno-0-1055"></a><span class="k">def</span><span class="w"> </span><span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]]:</span>
<a id="__codelineno-0-1056" name="__codelineno-0-1056"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1057" name="__codelineno-0-1057"></a><span class="sd">    Return the shape of the meshgrid.</span>
<a id="__codelineno-0-1058" name="__codelineno-0-1058"></a>
<a id="__codelineno-0-1059" name="__codelineno-0-1059"></a><span class="sd">    :returns: The shape as tuple. ``None`` if no data in the set.</span>
<a id="__codelineno-0-1060" name="__codelineno-0-1060"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1061" name="__codelineno-0-1061"></a>    <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-1062" name="__codelineno-0-1062"></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_vals</span><span class="p">(</span><span class="n">d</span><span class="p">))</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-1063" name="__codelineno-0-1063"></a>    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict.MeshgridDataDict.slice" class="doc doc-heading">
          <code class="highlight language-python"><span class="nb">slice</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Return a N-d slice of the data.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>kwargs</code></td>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="labcore.data.datadict.MeshgridDataDict.slice" href="#labcore.data.datadict.MeshgridDataDict.slice">slice</a>, int]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>slicing information in the format <code>axis: spec</code>, where <code>spec</code> can be a <code>slice</code> object, or an integer (usual slicing  notation).</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="labcore.data.datadict.MeshgridDataDict" href="#labcore.data.datadict.MeshgridDataDict">MeshgridDataDict</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>sliced data (as a copy)</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1195">1195</a></span>
<span class="normal"><a href="#__codelineno-0-1196">1196</a></span>
<span class="normal"><a href="#__codelineno-0-1197">1197</a></span>
<span class="normal"><a href="#__codelineno-0-1198">1198</a></span>
<span class="normal"><a href="#__codelineno-0-1199">1199</a></span>
<span class="normal"><a href="#__codelineno-0-1200">1200</a></span>
<span class="normal"><a href="#__codelineno-0-1201">1201</a></span>
<span class="normal"><a href="#__codelineno-0-1202">1202</a></span>
<span class="normal"><a href="#__codelineno-0-1203">1203</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1195" name="__codelineno-0-1195"></a><span class="k">def</span><span class="w"> </span><span class="nf">slice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">slice</span><span class="p">,</span> <span class="nb">int</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="s1">&#39;MeshgridDataDict&#39;</span><span class="p">:</span>
<a id="__codelineno-0-1196" name="__codelineno-0-1196"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a N-d slice of the data.</span>
<a id="__codelineno-0-1197" name="__codelineno-0-1197"></a>
<a id="__codelineno-0-1198" name="__codelineno-0-1198"></a><span class="sd">    :param kwargs: slicing information in the format ``axis: spec``, where</span>
<a id="__codelineno-0-1199" name="__codelineno-0-1199"></a><span class="sd">        ``spec`` can be a ``slice`` object, or an integer (usual slicing </span>
<a id="__codelineno-0-1200" name="__codelineno-0-1200"></a><span class="sd">        notation).</span>
<a id="__codelineno-0-1201" name="__codelineno-0-1201"></a><span class="sd">    :return: sliced data (as a copy)</span>
<a id="__codelineno-0-1202" name="__codelineno-0-1202"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1203" name="__codelineno-0-1203"></a>    <span class="k">return</span> <span class="n">_mesh_slice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict.MeshgridDataDict.squeeze" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">squeeze</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Remove size-1 dimensions.</p>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1205">1205</a></span>
<span class="normal"><a href="#__codelineno-0-1206">1206</a></span>
<span class="normal"><a href="#__codelineno-0-1207">1207</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1205" name="__codelineno-0-1205"></a><span class="k">def</span><span class="w"> </span><span class="nf">squeeze</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1206" name="__codelineno-0-1206"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove size-1 dimensions.&quot;&quot;&quot;</span>
<a id="__codelineno-0-1207" name="__codelineno-0-1207"></a>    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict.MeshgridDataDict.validate" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">validate</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Validation of the dataset.</p>
<p>Performs the following checks:
* All dependents must have the same axes.
* All shapes need to be identical.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p><code>True</code> if valid.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1065">1065</a></span>
<span class="normal"><a href="#__codelineno-0-1066">1066</a></span>
<span class="normal"><a href="#__codelineno-0-1067">1067</a></span>
<span class="normal"><a href="#__codelineno-0-1068">1068</a></span>
<span class="normal"><a href="#__codelineno-0-1069">1069</a></span>
<span class="normal"><a href="#__codelineno-0-1070">1070</a></span>
<span class="normal"><a href="#__codelineno-0-1071">1071</a></span>
<span class="normal"><a href="#__codelineno-0-1072">1072</a></span>
<span class="normal"><a href="#__codelineno-0-1073">1073</a></span>
<span class="normal"><a href="#__codelineno-0-1074">1074</a></span>
<span class="normal"><a href="#__codelineno-0-1075">1075</a></span>
<span class="normal"><a href="#__codelineno-0-1076">1076</a></span>
<span class="normal"><a href="#__codelineno-0-1077">1077</a></span>
<span class="normal"><a href="#__codelineno-0-1078">1078</a></span>
<span class="normal"><a href="#__codelineno-0-1079">1079</a></span>
<span class="normal"><a href="#__codelineno-0-1080">1080</a></span>
<span class="normal"><a href="#__codelineno-0-1081">1081</a></span>
<span class="normal"><a href="#__codelineno-0-1082">1082</a></span>
<span class="normal"><a href="#__codelineno-0-1083">1083</a></span>
<span class="normal"><a href="#__codelineno-0-1084">1084</a></span>
<span class="normal"><a href="#__codelineno-0-1085">1085</a></span>
<span class="normal"><a href="#__codelineno-0-1086">1086</a></span>
<span class="normal"><a href="#__codelineno-0-1087">1087</a></span>
<span class="normal"><a href="#__codelineno-0-1088">1088</a></span>
<span class="normal"><a href="#__codelineno-0-1089">1089</a></span>
<span class="normal"><a href="#__codelineno-0-1090">1090</a></span>
<span class="normal"><a href="#__codelineno-0-1091">1091</a></span>
<span class="normal"><a href="#__codelineno-0-1092">1092</a></span>
<span class="normal"><a href="#__codelineno-0-1093">1093</a></span>
<span class="normal"><a href="#__codelineno-0-1094">1094</a></span>
<span class="normal"><a href="#__codelineno-0-1095">1095</a></span>
<span class="normal"><a href="#__codelineno-0-1096">1096</a></span>
<span class="normal"><a href="#__codelineno-0-1097">1097</a></span>
<span class="normal"><a href="#__codelineno-0-1098">1098</a></span>
<span class="normal"><a href="#__codelineno-0-1099">1099</a></span>
<span class="normal"><a href="#__codelineno-0-1100">1100</a></span>
<span class="normal"><a href="#__codelineno-0-1101">1101</a></span>
<span class="normal"><a href="#__codelineno-0-1102">1102</a></span>
<span class="normal"><a href="#__codelineno-0-1103">1103</a></span>
<span class="normal"><a href="#__codelineno-0-1104">1104</a></span>
<span class="normal"><a href="#__codelineno-0-1105">1105</a></span>
<span class="normal"><a href="#__codelineno-0-1106">1106</a></span>
<span class="normal"><a href="#__codelineno-0-1107">1107</a></span>
<span class="normal"><a href="#__codelineno-0-1108">1108</a></span>
<span class="normal"><a href="#__codelineno-0-1109">1109</a></span>
<span class="normal"><a href="#__codelineno-0-1110">1110</a></span>
<span class="normal"><a href="#__codelineno-0-1111">1111</a></span>
<span class="normal"><a href="#__codelineno-0-1112">1112</a></span>
<span class="normal"><a href="#__codelineno-0-1113">1113</a></span>
<span class="normal"><a href="#__codelineno-0-1114">1114</a></span>
<span class="normal"><a href="#__codelineno-0-1115">1115</a></span>
<span class="normal"><a href="#__codelineno-0-1116">1116</a></span>
<span class="normal"><a href="#__codelineno-0-1117">1117</a></span>
<span class="normal"><a href="#__codelineno-0-1118">1118</a></span>
<span class="normal"><a href="#__codelineno-0-1119">1119</a></span>
<span class="normal"><a href="#__codelineno-0-1120">1120</a></span>
<span class="normal"><a href="#__codelineno-0-1121">1121</a></span>
<span class="normal"><a href="#__codelineno-0-1122">1122</a></span>
<span class="normal"><a href="#__codelineno-0-1123">1123</a></span>
<span class="normal"><a href="#__codelineno-0-1124">1124</a></span>
<span class="normal"><a href="#__codelineno-0-1125">1125</a></span>
<span class="normal"><a href="#__codelineno-0-1126">1126</a></span>
<span class="normal"><a href="#__codelineno-0-1127">1127</a></span>
<span class="normal"><a href="#__codelineno-0-1128">1128</a></span>
<span class="normal"><a href="#__codelineno-0-1129">1129</a></span>
<span class="normal"><a href="#__codelineno-0-1130">1130</a></span>
<span class="normal"><a href="#__codelineno-0-1131">1131</a></span>
<span class="normal"><a href="#__codelineno-0-1132">1132</a></span>
<span class="normal"><a href="#__codelineno-0-1133">1133</a></span>
<span class="normal"><a href="#__codelineno-0-1134">1134</a></span>
<span class="normal"><a href="#__codelineno-0-1135">1135</a></span>
<span class="normal"><a href="#__codelineno-0-1136">1136</a></span>
<span class="normal"><a href="#__codelineno-0-1137">1137</a></span>
<span class="normal"><a href="#__codelineno-0-1138">1138</a></span>
<span class="normal"><a href="#__codelineno-0-1139">1139</a></span>
<span class="normal"><a href="#__codelineno-0-1140">1140</a></span>
<span class="normal"><a href="#__codelineno-0-1141">1141</a></span>
<span class="normal"><a href="#__codelineno-0-1142">1142</a></span>
<span class="normal"><a href="#__codelineno-0-1143">1143</a></span>
<span class="normal"><a href="#__codelineno-0-1144">1144</a></span>
<span class="normal"><a href="#__codelineno-0-1145">1145</a></span>
<span class="normal"><a href="#__codelineno-0-1146">1146</a></span>
<span class="normal"><a href="#__codelineno-0-1147">1147</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1065" name="__codelineno-0-1065"></a><span class="k">def</span><span class="w"> </span><span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1066" name="__codelineno-0-1066"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1067" name="__codelineno-0-1067"></a><span class="sd">    Validation of the dataset.</span>
<a id="__codelineno-0-1068" name="__codelineno-0-1068"></a>
<a id="__codelineno-0-1069" name="__codelineno-0-1069"></a><span class="sd">    Performs the following checks:</span>
<a id="__codelineno-0-1070" name="__codelineno-0-1070"></a><span class="sd">    * All dependents must have the same axes.</span>
<a id="__codelineno-0-1071" name="__codelineno-0-1071"></a><span class="sd">    * All shapes need to be identical.</span>
<a id="__codelineno-0-1072" name="__codelineno-0-1072"></a>
<a id="__codelineno-0-1073" name="__codelineno-0-1073"></a><span class="sd">    :return: ``True`` if valid.</span>
<a id="__codelineno-0-1074" name="__codelineno-0-1074"></a><span class="sd">    :raises: ``ValueError`` if invalid.</span>
<a id="__codelineno-0-1075" name="__codelineno-0-1075"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1076" name="__codelineno-0-1076"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">validate</span><span class="p">():</span>
<a id="__codelineno-0-1077" name="__codelineno-0-1077"></a>        <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-1078" name="__codelineno-0-1078"></a>
<a id="__codelineno-0-1079" name="__codelineno-0-1079"></a>    <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-1080" name="__codelineno-0-1080"></a>
<a id="__codelineno-0-1081" name="__codelineno-0-1081"></a>    <span class="n">axes</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1082" name="__codelineno-0-1082"></a>    <span class="n">axessrc</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a id="__codelineno-0-1083" name="__codelineno-0-1083"></a>    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dependents</span><span class="p">():</span>
<a id="__codelineno-0-1084" name="__codelineno-0-1084"></a>        <span class="k">if</span> <span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1085" name="__codelineno-0-1085"></a>            <span class="n">axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<a id="__codelineno-0-1086" name="__codelineno-0-1086"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1087" name="__codelineno-0-1087"></a>            <span class="k">if</span> <span class="n">axes</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
<a id="__codelineno-0-1088" name="__codelineno-0-1088"></a>                <span class="n">msg</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; * All dependents must have the same axes, but &quot;</span>
<a id="__codelineno-0-1089" name="__codelineno-0-1089"></a>                <span class="n">msg</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s2"> has </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">axessrc</span><span class="si">}</span><span class="s2"> has </span><span class="si">{</span><span class="n">axes</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-1090" name="__codelineno-0-1090"></a>
<a id="__codelineno-0-1091" name="__codelineno-0-1091"></a>    <span class="n">shp</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1092" name="__codelineno-0-1092"></a>    <span class="n">shpsrc</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a id="__codelineno-0-1093" name="__codelineno-0-1093"></a>
<a id="__codelineno-0-1094" name="__codelineno-0-1094"></a>    <span class="n">data_items</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_items</span><span class="p">())</span>
<a id="__codelineno-0-1095" name="__codelineno-0-1095"></a>
<a id="__codelineno-0-1096" name="__codelineno-0-1096"></a>    <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data_items</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-1097" name="__codelineno-0-1097"></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">])</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">MaskedArray</span><span class="p">]:</span>
<a id="__codelineno-0-1098" name="__codelineno-0-1098"></a>            <span class="bp">self</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">])</span>
<a id="__codelineno-0-1099" name="__codelineno-0-1099"></a>
<a id="__codelineno-0-1100" name="__codelineno-0-1100"></a>        <span class="k">if</span> <span class="n">shp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1101" name="__codelineno-0-1101"></a>            <span class="n">shp</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-1102" name="__codelineno-0-1102"></a>            <span class="n">shpsrc</span> <span class="o">=</span> <span class="n">n</span>
<a id="__codelineno-0-1103" name="__codelineno-0-1103"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1104" name="__codelineno-0-1104"></a>            <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">shp</span><span class="p">:</span>
<a id="__codelineno-0-1105" name="__codelineno-0-1105"></a>                <span class="n">msg</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; * shapes need to match, but &#39;</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">&#39; has&quot;</span>
<a id="__codelineno-0-1106" name="__codelineno-0-1106"></a>                <span class="n">msg</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">, &quot;</span>
<a id="__codelineno-0-1107" name="__codelineno-0-1107"></a>                <span class="n">msg</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;and &#39;</span><span class="si">{</span><span class="n">shpsrc</span><span class="si">}</span><span class="s2">&#39; has </span><span class="si">{</span><span class="n">shp</span><span class="si">}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-1108" name="__codelineno-0-1108"></a>
<a id="__codelineno-0-1109" name="__codelineno-0-1109"></a>        <span class="k">if</span> <span class="n">msg</span> <span class="o">!=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span>
<a id="__codelineno-0-1110" name="__codelineno-0-1110"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<a id="__codelineno-0-1111" name="__codelineno-0-1111"></a>
<a id="__codelineno-0-1112" name="__codelineno-0-1112"></a>        <span class="k">if</span> <span class="s1">&#39;axes&#39;</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
<a id="__codelineno-0-1113" name="__codelineno-0-1113"></a>            <span class="k">for</span> <span class="n">axis_num</span><span class="p">,</span> <span class="n">na</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;axes&#39;</span><span class="p">]):</span>
<a id="__codelineno-0-1114" name="__codelineno-0-1114"></a>                <span class="c1"># check that the data of the axes matches its use</span>
<a id="__codelineno-0-1115" name="__codelineno-0-1115"></a>                <span class="c1"># if data present</span>
<a id="__codelineno-0-1116" name="__codelineno-0-1116"></a>                <span class="n">axis_data</span> <span class="o">=</span> <span class="n">data_items</span><span class="p">[</span><span class="n">na</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span>
<a id="__codelineno-0-1117" name="__codelineno-0-1117"></a>
<a id="__codelineno-0-1118" name="__codelineno-0-1118"></a>                <span class="c1"># for the data to be a valid meshgrid, we need to have an increase/decrease along each</span>
<a id="__codelineno-0-1119" name="__codelineno-0-1119"></a>                <span class="c1"># axis that contains data.</span>
<a id="__codelineno-0-1120" name="__codelineno-0-1120"></a>                <span class="k">if</span> <span class="n">axis_data</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1121" name="__codelineno-0-1121"></a>                    <span class="c1"># if axis length is 1, then we cannot infer anything about grids yet</span>
<a id="__codelineno-0-1122" name="__codelineno-0-1122"></a>
<a id="__codelineno-0-1123" name="__codelineno-0-1123"></a>                    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-1124" name="__codelineno-0-1124"></a>                        <span class="k">if</span> <span class="n">axis_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis_num</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-1125" name="__codelineno-0-1125"></a>                            <span class="n">steps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">axis_data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis_num</span><span class="p">)))</span>
<a id="__codelineno-0-1126" name="__codelineno-0-1126"></a>
<a id="__codelineno-0-1127" name="__codelineno-0-1127"></a>                            <span class="c1"># for incomplete data, there maybe nan steps -- we need to remove those, </span>
<a id="__codelineno-0-1128" name="__codelineno-0-1128"></a>                            <span class="c1"># doesn&#39;t mean anything is wrong.</span>
<a id="__codelineno-0-1129" name="__codelineno-0-1129"></a>                            <span class="n">steps</span> <span class="o">=</span> <span class="n">steps</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">steps</span><span class="p">)]</span>
<a id="__codelineno-0-1130" name="__codelineno-0-1130"></a>
<a id="__codelineno-0-1131" name="__codelineno-0-1131"></a>                            <span class="k">if</span> <span class="mi">0</span> <span class="ow">in</span> <span class="n">steps</span><span class="p">:</span>
<a id="__codelineno-0-1132" name="__codelineno-0-1132"></a>                                <span class="n">msg</span> <span class="o">+=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Malformed data: </span><span class="si">{</span><span class="n">na</span><span class="si">}</span><span class="s2"> is expected to be </span><span class="si">{</span><span class="n">axis_num</span><span class="si">}</span><span class="s2">th &quot;</span>
<a id="__codelineno-0-1133" name="__codelineno-0-1133"></a>                                        <span class="s2">&quot;axis but has no variation along that axis.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1134" name="__codelineno-0-1134"></a>                            <span class="k">if</span> <span class="n">steps</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-1135" name="__codelineno-0-1135"></a>                                <span class="n">msg</span> <span class="o">+=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Malformed data: axis </span><span class="si">{</span><span class="n">na</span><span class="si">}</span><span class="s2"> is not monotonous.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1136" name="__codelineno-0-1136"></a>
<a id="__codelineno-0-1137" name="__codelineno-0-1137"></a>                    <span class="c1"># can happen if we have bad shapes. but that should already have been caught.</span>
<a id="__codelineno-0-1138" name="__codelineno-0-1138"></a>                    <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
<a id="__codelineno-0-1139" name="__codelineno-0-1139"></a>                        <span class="k">pass</span>
<a id="__codelineno-0-1140" name="__codelineno-0-1140"></a>
<a id="__codelineno-0-1141" name="__codelineno-0-1141"></a>        <span class="k">if</span> <span class="s1">&#39;__shape__&#39;</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
<a id="__codelineno-0-1142" name="__codelineno-0-1142"></a>            <span class="n">v</span><span class="p">[</span><span class="s1">&#39;__shape__&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">shp</span>
<a id="__codelineno-0-1143" name="__codelineno-0-1143"></a>
<a id="__codelineno-0-1144" name="__codelineno-0-1144"></a>        <span class="k">if</span> <span class="n">msg</span> <span class="o">!=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span>
<a id="__codelineno-0-1145" name="__codelineno-0-1145"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<a id="__codelineno-0-1146" name="__codelineno-0-1146"></a>
<a id="__codelineno-0-1147" name="__codelineno-0-1147"></a>    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>



<div class="doc doc-object doc-function">




<h2 id="labcore.data.datadict.combine_datadicts" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">combine_datadicts</span><span class="p">(</span><span class="o">*</span><span class="n">dicts</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Try to make one datadict out of multiple.</p>
<p>Basic rules:</p>
<ul>
<li>We try to maintain the input type.</li>
<li>Return type is 'downgraded' to DataDictBase if the contents are not
  compatible (i.e., different numbers of records in the inputs).</li>
</ul>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="labcore.data.datadict.DataDictBase" href="#labcore.data.datadict.DataDictBase">DataDictBase</a>, <a class="autorefs autorefs-internal" title="labcore.data.datadict.DataDict" href="#labcore.data.datadict.DataDict">DataDict</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Combined data.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1395">1395</a></span>
<span class="normal"><a href="#__codelineno-0-1396">1396</a></span>
<span class="normal"><a href="#__codelineno-0-1397">1397</a></span>
<span class="normal"><a href="#__codelineno-0-1398">1398</a></span>
<span class="normal"><a href="#__codelineno-0-1399">1399</a></span>
<span class="normal"><a href="#__codelineno-0-1400">1400</a></span>
<span class="normal"><a href="#__codelineno-0-1401">1401</a></span>
<span class="normal"><a href="#__codelineno-0-1402">1402</a></span>
<span class="normal"><a href="#__codelineno-0-1403">1403</a></span>
<span class="normal"><a href="#__codelineno-0-1404">1404</a></span>
<span class="normal"><a href="#__codelineno-0-1405">1405</a></span>
<span class="normal"><a href="#__codelineno-0-1406">1406</a></span>
<span class="normal"><a href="#__codelineno-0-1407">1407</a></span>
<span class="normal"><a href="#__codelineno-0-1408">1408</a></span>
<span class="normal"><a href="#__codelineno-0-1409">1409</a></span>
<span class="normal"><a href="#__codelineno-0-1410">1410</a></span>
<span class="normal"><a href="#__codelineno-0-1411">1411</a></span>
<span class="normal"><a href="#__codelineno-0-1412">1412</a></span>
<span class="normal"><a href="#__codelineno-0-1413">1413</a></span>
<span class="normal"><a href="#__codelineno-0-1414">1414</a></span>
<span class="normal"><a href="#__codelineno-0-1415">1415</a></span>
<span class="normal"><a href="#__codelineno-0-1416">1416</a></span>
<span class="normal"><a href="#__codelineno-0-1417">1417</a></span>
<span class="normal"><a href="#__codelineno-0-1418">1418</a></span>
<span class="normal"><a href="#__codelineno-0-1419">1419</a></span>
<span class="normal"><a href="#__codelineno-0-1420">1420</a></span>
<span class="normal"><a href="#__codelineno-0-1421">1421</a></span>
<span class="normal"><a href="#__codelineno-0-1422">1422</a></span>
<span class="normal"><a href="#__codelineno-0-1423">1423</a></span>
<span class="normal"><a href="#__codelineno-0-1424">1424</a></span>
<span class="normal"><a href="#__codelineno-0-1425">1425</a></span>
<span class="normal"><a href="#__codelineno-0-1426">1426</a></span>
<span class="normal"><a href="#__codelineno-0-1427">1427</a></span>
<span class="normal"><a href="#__codelineno-0-1428">1428</a></span>
<span class="normal"><a href="#__codelineno-0-1429">1429</a></span>
<span class="normal"><a href="#__codelineno-0-1430">1430</a></span>
<span class="normal"><a href="#__codelineno-0-1431">1431</a></span>
<span class="normal"><a href="#__codelineno-0-1432">1432</a></span>
<span class="normal"><a href="#__codelineno-0-1433">1433</a></span>
<span class="normal"><a href="#__codelineno-0-1434">1434</a></span>
<span class="normal"><a href="#__codelineno-0-1435">1435</a></span>
<span class="normal"><a href="#__codelineno-0-1436">1436</a></span>
<span class="normal"><a href="#__codelineno-0-1437">1437</a></span>
<span class="normal"><a href="#__codelineno-0-1438">1438</a></span>
<span class="normal"><a href="#__codelineno-0-1439">1439</a></span>
<span class="normal"><a href="#__codelineno-0-1440">1440</a></span>
<span class="normal"><a href="#__codelineno-0-1441">1441</a></span>
<span class="normal"><a href="#__codelineno-0-1442">1442</a></span>
<span class="normal"><a href="#__codelineno-0-1443">1443</a></span>
<span class="normal"><a href="#__codelineno-0-1444">1444</a></span>
<span class="normal"><a href="#__codelineno-0-1445">1445</a></span>
<span class="normal"><a href="#__codelineno-0-1446">1446</a></span>
<span class="normal"><a href="#__codelineno-0-1447">1447</a></span>
<span class="normal"><a href="#__codelineno-0-1448">1448</a></span>
<span class="normal"><a href="#__codelineno-0-1449">1449</a></span>
<span class="normal"><a href="#__codelineno-0-1450">1450</a></span>
<span class="normal"><a href="#__codelineno-0-1451">1451</a></span>
<span class="normal"><a href="#__codelineno-0-1452">1452</a></span>
<span class="normal"><a href="#__codelineno-0-1453">1453</a></span>
<span class="normal"><a href="#__codelineno-0-1454">1454</a></span>
<span class="normal"><a href="#__codelineno-0-1455">1455</a></span>
<span class="normal"><a href="#__codelineno-0-1456">1456</a></span>
<span class="normal"><a href="#__codelineno-0-1457">1457</a></span>
<span class="normal"><a href="#__codelineno-0-1458">1458</a></span>
<span class="normal"><a href="#__codelineno-0-1459">1459</a></span>
<span class="normal"><a href="#__codelineno-0-1460">1460</a></span>
<span class="normal"><a href="#__codelineno-0-1461">1461</a></span>
<span class="normal"><a href="#__codelineno-0-1462">1462</a></span>
<span class="normal"><a href="#__codelineno-0-1463">1463</a></span>
<span class="normal"><a href="#__codelineno-0-1464">1464</a></span>
<span class="normal"><a href="#__codelineno-0-1465">1465</a></span>
<span class="normal"><a href="#__codelineno-0-1466">1466</a></span>
<span class="normal"><a href="#__codelineno-0-1467">1467</a></span>
<span class="normal"><a href="#__codelineno-0-1468">1468</a></span>
<span class="normal"><a href="#__codelineno-0-1469">1469</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1395" name="__codelineno-0-1395"></a><span class="k">def</span><span class="w"> </span><span class="nf">combine_datadicts</span><span class="p">(</span><span class="o">*</span><span class="n">dicts</span><span class="p">:</span> <span class="n">DataDict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">DataDictBase</span><span class="p">,</span> <span class="n">DataDict</span><span class="p">]:</span>
<a id="__codelineno-0-1396" name="__codelineno-0-1396"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1397" name="__codelineno-0-1397"></a><span class="sd">    Try to make one datadict out of multiple.</span>
<a id="__codelineno-0-1398" name="__codelineno-0-1398"></a>
<a id="__codelineno-0-1399" name="__codelineno-0-1399"></a><span class="sd">    Basic rules:</span>
<a id="__codelineno-0-1400" name="__codelineno-0-1400"></a>
<a id="__codelineno-0-1401" name="__codelineno-0-1401"></a><span class="sd">    - We try to maintain the input type.</span>
<a id="__codelineno-0-1402" name="__codelineno-0-1402"></a><span class="sd">    - Return type is &#39;downgraded&#39; to DataDictBase if the contents are not</span>
<a id="__codelineno-0-1403" name="__codelineno-0-1403"></a><span class="sd">      compatible (i.e., different numbers of records in the inputs).</span>
<a id="__codelineno-0-1404" name="__codelineno-0-1404"></a>
<a id="__codelineno-0-1405" name="__codelineno-0-1405"></a><span class="sd">    :returns: Combined data.</span>
<a id="__codelineno-0-1406" name="__codelineno-0-1406"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1407" name="__codelineno-0-1407"></a>
<a id="__codelineno-0-1408" name="__codelineno-0-1408"></a>    <span class="c1"># TODO: deal correctly with MeshGridData when combined with other types</span>
<a id="__codelineno-0-1409" name="__codelineno-0-1409"></a>    <span class="c1"># TODO: should we strictly copy all values?</span>
<a id="__codelineno-0-1410" name="__codelineno-0-1410"></a>    <span class="c1"># TODO: we should try to consolidate axes as much as possible. Currently</span>
<a id="__codelineno-0-1411" name="__codelineno-0-1411"></a>    <span class="c1">#   axes in the return can be separated even if they match (caused</span>
<a id="__codelineno-0-1412" name="__codelineno-0-1412"></a>    <span class="c1">#   by earlier mismatches)</span>
<a id="__codelineno-0-1413" name="__codelineno-0-1413"></a>
<a id="__codelineno-0-1414" name="__codelineno-0-1414"></a>    <span class="n">ret</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1415" name="__codelineno-0-1415"></a>    <span class="n">rettype</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1416" name="__codelineno-0-1416"></a>
<a id="__codelineno-0-1417" name="__codelineno-0-1417"></a>    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dicts</span><span class="p">:</span>
<a id="__codelineno-0-1418" name="__codelineno-0-1418"></a>        <span class="k">if</span> <span class="n">ret</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1419" name="__codelineno-0-1419"></a>            <span class="n">ret</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-1420" name="__codelineno-0-1420"></a>            <span class="n">rettype</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<a id="__codelineno-0-1421" name="__codelineno-0-1421"></a>
<a id="__codelineno-0-1422" name="__codelineno-0-1422"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1423" name="__codelineno-0-1423"></a>
<a id="__codelineno-0-1424" name="__codelineno-0-1424"></a>            <span class="c1"># if we don&#39;t have a well defined number of records anymore,</span>
<a id="__codelineno-0-1425" name="__codelineno-0-1425"></a>            <span class="c1"># need to revert the type to DataDictBase</span>
<a id="__codelineno-0-1426" name="__codelineno-0-1426"></a>            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="s1">&#39;nrecords&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="s1">&#39;nrecords&#39;</span><span class="p">):</span>
<a id="__codelineno-0-1427" name="__codelineno-0-1427"></a>                <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">nrecords</span><span class="p">()</span> <span class="o">!=</span> <span class="n">ret</span><span class="o">.</span><span class="n">nrecords</span><span class="p">():</span>
<a id="__codelineno-0-1428" name="__codelineno-0-1428"></a>                    <span class="n">rettype</span> <span class="o">=</span> <span class="n">DataDictBase</span>
<a id="__codelineno-0-1429" name="__codelineno-0-1429"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1430" name="__codelineno-0-1430"></a>                <span class="n">rettype</span> <span class="o">=</span> <span class="n">DataDictBase</span>
<a id="__codelineno-0-1431" name="__codelineno-0-1431"></a>            <span class="n">ret</span> <span class="o">=</span> <span class="n">rettype</span><span class="p">(</span><span class="o">**</span><span class="n">ret</span><span class="p">)</span>
<a id="__codelineno-0-1432" name="__codelineno-0-1432"></a>
<a id="__codelineno-0-1433" name="__codelineno-0-1433"></a>            <span class="c1"># First, parse the axes in the to-be-added ddict.</span>
<a id="__codelineno-0-1434" name="__codelineno-0-1434"></a>            <span class="c1"># if dimensions with same names are present already in the current</span>
<a id="__codelineno-0-1435" name="__codelineno-0-1435"></a>            <span class="c1"># return ddict and are not compatible with what&#39;s to be added,</span>
<a id="__codelineno-0-1436" name="__codelineno-0-1436"></a>            <span class="c1"># rename the incoming dimension.</span>
<a id="__codelineno-0-1437" name="__codelineno-0-1437"></a>            <span class="n">ax_map</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1438" name="__codelineno-0-1438"></a>            <span class="k">for</span> <span class="n">d_ax</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">axes</span><span class="p">():</span>
<a id="__codelineno-0-1439" name="__codelineno-0-1439"></a>                <span class="k">if</span> <span class="n">d_ax</span> <span class="ow">in</span> <span class="n">ret</span><span class="o">.</span><span class="n">axes</span><span class="p">():</span>
<a id="__codelineno-0-1440" name="__codelineno-0-1440"></a>                    <span class="k">if</span> <span class="n">num</span><span class="o">.</span><span class="n">arrays_equal</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">data_vals</span><span class="p">(</span><span class="n">d_ax</span><span class="p">),</span> <span class="n">ret</span><span class="o">.</span><span class="n">data_vals</span><span class="p">(</span><span class="n">d_ax</span><span class="p">)):</span>
<a id="__codelineno-0-1441" name="__codelineno-0-1441"></a>                        <span class="n">ax_map</span><span class="p">[</span><span class="n">d_ax</span><span class="p">]</span> <span class="o">=</span> <span class="n">d_ax</span>
<a id="__codelineno-0-1442" name="__codelineno-0-1442"></a>                    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1443" name="__codelineno-0-1443"></a>                        <span class="n">newax</span> <span class="o">=</span> <span class="n">_find_replacement_name</span><span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="n">d_ax</span><span class="p">)</span>
<a id="__codelineno-0-1444" name="__codelineno-0-1444"></a>                        <span class="n">ax_map</span><span class="p">[</span><span class="n">d_ax</span><span class="p">]</span> <span class="o">=</span> <span class="n">newax</span>
<a id="__codelineno-0-1445" name="__codelineno-0-1445"></a>                        <span class="n">ret</span><span class="p">[</span><span class="n">newax</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">d_ax</span><span class="p">]</span>
<a id="__codelineno-0-1446" name="__codelineno-0-1446"></a>                <span class="k">elif</span> <span class="n">d_ax</span> <span class="ow">in</span> <span class="n">ret</span><span class="o">.</span><span class="n">dependents</span><span class="p">():</span>
<a id="__codelineno-0-1447" name="__codelineno-0-1447"></a>                    <span class="n">newax</span> <span class="o">=</span> <span class="n">_find_replacement_name</span><span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="n">d_ax</span><span class="p">)</span>
<a id="__codelineno-0-1448" name="__codelineno-0-1448"></a>                    <span class="n">ax_map</span><span class="p">[</span><span class="n">d_ax</span><span class="p">]</span> <span class="o">=</span> <span class="n">newax</span>
<a id="__codelineno-0-1449" name="__codelineno-0-1449"></a>                    <span class="n">ret</span><span class="p">[</span><span class="n">newax</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">d_ax</span><span class="p">]</span>
<a id="__codelineno-0-1450" name="__codelineno-0-1450"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1451" name="__codelineno-0-1451"></a>                    <span class="n">ax_map</span><span class="p">[</span><span class="n">d_ax</span><span class="p">]</span> <span class="o">=</span> <span class="n">d_ax</span>
<a id="__codelineno-0-1452" name="__codelineno-0-1452"></a>                    <span class="n">ret</span><span class="p">[</span><span class="n">d_ax</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">d_ax</span><span class="p">]</span>
<a id="__codelineno-0-1453" name="__codelineno-0-1453"></a>
<a id="__codelineno-0-1454" name="__codelineno-0-1454"></a>            <span class="k">for</span> <span class="n">d_dep</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">dependents</span><span class="p">():</span>
<a id="__codelineno-0-1455" name="__codelineno-0-1455"></a>                <span class="k">if</span> <span class="n">d_dep</span> <span class="ow">in</span> <span class="n">ret</span><span class="p">:</span>
<a id="__codelineno-0-1456" name="__codelineno-0-1456"></a>                    <span class="n">newdep</span> <span class="o">=</span> <span class="n">_find_replacement_name</span><span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="n">d_dep</span><span class="p">)</span>
<a id="__codelineno-0-1457" name="__codelineno-0-1457"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1458" name="__codelineno-0-1458"></a>                    <span class="n">newdep</span> <span class="o">=</span> <span class="n">d_dep</span>
<a id="__codelineno-0-1459" name="__codelineno-0-1459"></a>
<a id="__codelineno-0-1460" name="__codelineno-0-1460"></a>                <span class="n">dep_axes</span> <span class="o">=</span> <span class="p">[</span><span class="n">ax_map</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span> <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">d</span><span class="p">[</span><span class="n">d_dep</span><span class="p">][</span><span class="s1">&#39;axes&#39;</span><span class="p">]]</span>
<a id="__codelineno-0-1461" name="__codelineno-0-1461"></a>                <span class="n">ret</span><span class="p">[</span><span class="n">newdep</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">d_dep</span><span class="p">]</span>
<a id="__codelineno-0-1462" name="__codelineno-0-1462"></a>                <span class="n">ret</span><span class="p">[</span><span class="n">newdep</span><span class="p">][</span><span class="s1">&#39;axes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dep_axes</span>
<a id="__codelineno-0-1463" name="__codelineno-0-1463"></a>
<a id="__codelineno-0-1464" name="__codelineno-0-1464"></a>    <span class="k">if</span> <span class="n">ret</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1465" name="__codelineno-0-1465"></a>        <span class="n">ret</span> <span class="o">=</span> <span class="n">DataDict</span><span class="p">()</span>
<a id="__codelineno-0-1466" name="__codelineno-0-1466"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1467" name="__codelineno-0-1467"></a>        <span class="n">ret</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
<a id="__codelineno-0-1468" name="__codelineno-0-1468"></a>
<a id="__codelineno-0-1469" name="__codelineno-0-1469"></a>    <span class="k">return</span> <span class="n">ret</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="labcore.data.datadict.datadict_to_meshgrid" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">datadict_to_meshgrid</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target_shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">inner_axis_order</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_existing_shape</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Try to make a meshgrid from a dataset.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="labcore.data.datadict.DataDict" href="#labcore.data.datadict.DataDict">DataDict</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Input DataDict.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>target_shape</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="typing.Tuple">Tuple</span>[int, ...], None]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Target shape. If <code>None</code> we use <code>guess_shape_from_datadict</code> to infer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>inner_axis_order</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[None, <span title="typing.Sequence">Sequence</span>[str]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If axes of the datadict are not specified in the 'C' order (1st the slowest, last the fastest axis) then the 'true' inner order can be specified as a list of axes names, which has to match the specified axes in all but order. The data is then transposed to conform to the specified order.  .. note:: If this is given, then <code>target_shape</code> needs to be given in in the order of this inner_axis_order. The output data will keep the axis ordering specified in the <code>axes</code> property.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>use_existing_shape</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>if <code>True</code>, simply use the shape that the data already has. For numpy-array data, this might already be present. If <code>False</code>, flatten and reshape.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>copy</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>if <code>True</code>, then we make a copy of the data arrays. if <code>False</code>, data array is modified in-place.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="labcore.data.datadict.MeshgridDataDict" href="#labcore.data.datadict.MeshgridDataDict">MeshgridDataDict</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The generated <code>MeshgridDataDict</code>.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1275">1275</a></span>
<span class="normal"><a href="#__codelineno-0-1276">1276</a></span>
<span class="normal"><a href="#__codelineno-0-1277">1277</a></span>
<span class="normal"><a href="#__codelineno-0-1278">1278</a></span>
<span class="normal"><a href="#__codelineno-0-1279">1279</a></span>
<span class="normal"><a href="#__codelineno-0-1280">1280</a></span>
<span class="normal"><a href="#__codelineno-0-1281">1281</a></span>
<span class="normal"><a href="#__codelineno-0-1282">1282</a></span>
<span class="normal"><a href="#__codelineno-0-1283">1283</a></span>
<span class="normal"><a href="#__codelineno-0-1284">1284</a></span>
<span class="normal"><a href="#__codelineno-0-1285">1285</a></span>
<span class="normal"><a href="#__codelineno-0-1286">1286</a></span>
<span class="normal"><a href="#__codelineno-0-1287">1287</a></span>
<span class="normal"><a href="#__codelineno-0-1288">1288</a></span>
<span class="normal"><a href="#__codelineno-0-1289">1289</a></span>
<span class="normal"><a href="#__codelineno-0-1290">1290</a></span>
<span class="normal"><a href="#__codelineno-0-1291">1291</a></span>
<span class="normal"><a href="#__codelineno-0-1292">1292</a></span>
<span class="normal"><a href="#__codelineno-0-1293">1293</a></span>
<span class="normal"><a href="#__codelineno-0-1294">1294</a></span>
<span class="normal"><a href="#__codelineno-0-1295">1295</a></span>
<span class="normal"><a href="#__codelineno-0-1296">1296</a></span>
<span class="normal"><a href="#__codelineno-0-1297">1297</a></span>
<span class="normal"><a href="#__codelineno-0-1298">1298</a></span>
<span class="normal"><a href="#__codelineno-0-1299">1299</a></span>
<span class="normal"><a href="#__codelineno-0-1300">1300</a></span>
<span class="normal"><a href="#__codelineno-0-1301">1301</a></span>
<span class="normal"><a href="#__codelineno-0-1302">1302</a></span>
<span class="normal"><a href="#__codelineno-0-1303">1303</a></span>
<span class="normal"><a href="#__codelineno-0-1304">1304</a></span>
<span class="normal"><a href="#__codelineno-0-1305">1305</a></span>
<span class="normal"><a href="#__codelineno-0-1306">1306</a></span>
<span class="normal"><a href="#__codelineno-0-1307">1307</a></span>
<span class="normal"><a href="#__codelineno-0-1308">1308</a></span>
<span class="normal"><a href="#__codelineno-0-1309">1309</a></span>
<span class="normal"><a href="#__codelineno-0-1310">1310</a></span>
<span class="normal"><a href="#__codelineno-0-1311">1311</a></span>
<span class="normal"><a href="#__codelineno-0-1312">1312</a></span>
<span class="normal"><a href="#__codelineno-0-1313">1313</a></span>
<span class="normal"><a href="#__codelineno-0-1314">1314</a></span>
<span class="normal"><a href="#__codelineno-0-1315">1315</a></span>
<span class="normal"><a href="#__codelineno-0-1316">1316</a></span>
<span class="normal"><a href="#__codelineno-0-1317">1317</a></span>
<span class="normal"><a href="#__codelineno-0-1318">1318</a></span>
<span class="normal"><a href="#__codelineno-0-1319">1319</a></span>
<span class="normal"><a href="#__codelineno-0-1320">1320</a></span>
<span class="normal"><a href="#__codelineno-0-1321">1321</a></span>
<span class="normal"><a href="#__codelineno-0-1322">1322</a></span>
<span class="normal"><a href="#__codelineno-0-1323">1323</a></span>
<span class="normal"><a href="#__codelineno-0-1324">1324</a></span>
<span class="normal"><a href="#__codelineno-0-1325">1325</a></span>
<span class="normal"><a href="#__codelineno-0-1326">1326</a></span>
<span class="normal"><a href="#__codelineno-0-1327">1327</a></span>
<span class="normal"><a href="#__codelineno-0-1328">1328</a></span>
<span class="normal"><a href="#__codelineno-0-1329">1329</a></span>
<span class="normal"><a href="#__codelineno-0-1330">1330</a></span>
<span class="normal"><a href="#__codelineno-0-1331">1331</a></span>
<span class="normal"><a href="#__codelineno-0-1332">1332</a></span>
<span class="normal"><a href="#__codelineno-0-1333">1333</a></span>
<span class="normal"><a href="#__codelineno-0-1334">1334</a></span>
<span class="normal"><a href="#__codelineno-0-1335">1335</a></span>
<span class="normal"><a href="#__codelineno-0-1336">1336</a></span>
<span class="normal"><a href="#__codelineno-0-1337">1337</a></span>
<span class="normal"><a href="#__codelineno-0-1338">1338</a></span>
<span class="normal"><a href="#__codelineno-0-1339">1339</a></span>
<span class="normal"><a href="#__codelineno-0-1340">1340</a></span>
<span class="normal"><a href="#__codelineno-0-1341">1341</a></span>
<span class="normal"><a href="#__codelineno-0-1342">1342</a></span>
<span class="normal"><a href="#__codelineno-0-1343">1343</a></span>
<span class="normal"><a href="#__codelineno-0-1344">1344</a></span>
<span class="normal"><a href="#__codelineno-0-1345">1345</a></span>
<span class="normal"><a href="#__codelineno-0-1346">1346</a></span>
<span class="normal"><a href="#__codelineno-0-1347">1347</a></span>
<span class="normal"><a href="#__codelineno-0-1348">1348</a></span>
<span class="normal"><a href="#__codelineno-0-1349">1349</a></span>
<span class="normal"><a href="#__codelineno-0-1350">1350</a></span>
<span class="normal"><a href="#__codelineno-0-1351">1351</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1275" name="__codelineno-0-1275"></a><span class="k">def</span><span class="w"> </span><span class="nf">datadict_to_meshgrid</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">DataDict</span><span class="p">,</span>
<a id="__codelineno-0-1276" name="__codelineno-0-1276"></a>                         <span class="n">target_shape</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1277" name="__codelineno-0-1277"></a>                         <span class="n">inner_axis_order</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1278" name="__codelineno-0-1278"></a>                         <span class="n">use_existing_shape</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1279" name="__codelineno-0-1279"></a>                         <span class="n">copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> \
<a id="__codelineno-0-1280" name="__codelineno-0-1280"></a>        <span class="o">-&gt;</span> <span class="n">MeshgridDataDict</span><span class="p">:</span>
<a id="__codelineno-0-1281" name="__codelineno-0-1281"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1282" name="__codelineno-0-1282"></a><span class="sd">    Try to make a meshgrid from a dataset.</span>
<a id="__codelineno-0-1283" name="__codelineno-0-1283"></a>
<a id="__codelineno-0-1284" name="__codelineno-0-1284"></a><span class="sd">    :param data: Input DataDict.</span>
<a id="__codelineno-0-1285" name="__codelineno-0-1285"></a><span class="sd">    :param target_shape: Target shape. If ``None`` we use</span>
<a id="__codelineno-0-1286" name="__codelineno-0-1286"></a><span class="sd">        ``guess_shape_from_datadict`` to infer.</span>
<a id="__codelineno-0-1287" name="__codelineno-0-1287"></a><span class="sd">    :param inner_axis_order: If axes of the datadict are not specified in the</span>
<a id="__codelineno-0-1288" name="__codelineno-0-1288"></a><span class="sd">        &#39;C&#39; order (1st the slowest, last the fastest axis) then the</span>
<a id="__codelineno-0-1289" name="__codelineno-0-1289"></a><span class="sd">        &#39;true&#39; inner order can be specified as a list of axes names, which has</span>
<a id="__codelineno-0-1290" name="__codelineno-0-1290"></a><span class="sd">        to match the specified axes in all but order. The data is then</span>
<a id="__codelineno-0-1291" name="__codelineno-0-1291"></a><span class="sd">        transposed to conform to the specified order.</span>
<a id="__codelineno-0-1292" name="__codelineno-0-1292"></a>
<a id="__codelineno-0-1293" name="__codelineno-0-1293"></a><span class="sd">        .. note::</span>
<a id="__codelineno-0-1294" name="__codelineno-0-1294"></a><span class="sd">            If this is given, then ``target_shape`` needs to be given in</span>
<a id="__codelineno-0-1295" name="__codelineno-0-1295"></a><span class="sd">            in the order of this inner_axis_order. The output data will keep the</span>
<a id="__codelineno-0-1296" name="__codelineno-0-1296"></a><span class="sd">            axis ordering specified in the `axes` property.</span>
<a id="__codelineno-0-1297" name="__codelineno-0-1297"></a>
<a id="__codelineno-0-1298" name="__codelineno-0-1298"></a><span class="sd">    :param use_existing_shape: if ``True``, simply use the shape that the data</span>
<a id="__codelineno-0-1299" name="__codelineno-0-1299"></a><span class="sd">        already has. For numpy-array data, this might already be present.</span>
<a id="__codelineno-0-1300" name="__codelineno-0-1300"></a><span class="sd">        If ``False``, flatten and reshape.</span>
<a id="__codelineno-0-1301" name="__codelineno-0-1301"></a><span class="sd">    :param copy: if ``True``, then we make a copy of the data arrays.</span>
<a id="__codelineno-0-1302" name="__codelineno-0-1302"></a><span class="sd">        if ``False``, data array is modified in-place.</span>
<a id="__codelineno-0-1303" name="__codelineno-0-1303"></a>
<a id="__codelineno-0-1304" name="__codelineno-0-1304"></a><span class="sd">    :raises: GriddingError (subclass of ValueError) if the data cannot be gridded.</span>
<a id="__codelineno-0-1305" name="__codelineno-0-1305"></a><span class="sd">    :returns: The generated ``MeshgridDataDict``.</span>
<a id="__codelineno-0-1306" name="__codelineno-0-1306"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1307" name="__codelineno-0-1307"></a>
<a id="__codelineno-0-1308" name="__codelineno-0-1308"></a>    <span class="c1"># if the data is empty, return empty MeshgridData</span>
<a id="__codelineno-0-1309" name="__codelineno-0-1309"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">([</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">data_items</span><span class="p">()])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1310" name="__codelineno-0-1310"></a>        <span class="k">return</span> <span class="n">MeshgridDataDict</span><span class="p">()</span>
<a id="__codelineno-0-1311" name="__codelineno-0-1311"></a>
<a id="__codelineno-0-1312" name="__codelineno-0-1312"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="o">.</span><span class="n">axes_are_compatible</span><span class="p">():</span>
<a id="__codelineno-0-1313" name="__codelineno-0-1313"></a>        <span class="k">raise</span> <span class="n">GriddingError</span><span class="p">(</span><span class="s1">&#39;Non-compatible axes, cannot grid that.&#39;</span><span class="p">)</span>
<a id="__codelineno-0-1314" name="__codelineno-0-1314"></a>
<a id="__codelineno-0-1315" name="__codelineno-0-1315"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">use_existing_shape</span> <span class="ow">and</span> <span class="n">data</span><span class="o">.</span><span class="n">is_expandable</span><span class="p">():</span>
<a id="__codelineno-0-1316" name="__codelineno-0-1316"></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<a id="__codelineno-0-1317" name="__codelineno-0-1317"></a>    <span class="k">elif</span> <span class="n">use_existing_shape</span><span class="p">:</span>
<a id="__codelineno-0-1318" name="__codelineno-0-1318"></a>        <span class="n">target_shape</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shapes</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1319" name="__codelineno-0-1319"></a>
<a id="__codelineno-0-1320" name="__codelineno-0-1320"></a>    <span class="c1"># guess what the shape likely is.</span>
<a id="__codelineno-0-1321" name="__codelineno-0-1321"></a>    <span class="k">if</span> <span class="n">target_shape</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1322" name="__codelineno-0-1322"></a>        <span class="n">shp_specs</span> <span class="o">=</span> <span class="n">guess_shape_from_datadict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-0-1323" name="__codelineno-0-1323"></a>        <span class="n">shps</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">order_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">order_shape</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-1324" name="__codelineno-0-1324"></a>                   <span class="k">else</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">order_shape</span> <span class="ow">in</span> <span class="n">shp_specs</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<a id="__codelineno-0-1325" name="__codelineno-0-1325"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">shps</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-1326" name="__codelineno-0-1326"></a>            <span class="k">raise</span> <span class="n">GriddingError</span><span class="p">(</span><span class="s1">&#39;Cannot determine unique shape for all data.&#39;</span><span class="p">)</span>
<a id="__codelineno-0-1327" name="__codelineno-0-1327"></a>        <span class="n">ret</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">shp_specs</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1328" name="__codelineno-0-1328"></a>        <span class="k">if</span> <span class="n">ret</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1329" name="__codelineno-0-1329"></a>            <span class="k">raise</span> <span class="n">GriddingError</span><span class="p">(</span><span class="s1">&#39;Shape could not be inferred.&#39;</span><span class="p">)</span>
<a id="__codelineno-0-1330" name="__codelineno-0-1330"></a>        <span class="c1"># the guess-function returns both axis order as well as shape.</span>
<a id="__codelineno-0-1331" name="__codelineno-0-1331"></a>        <span class="n">inner_axis_order</span><span class="p">,</span> <span class="n">target_shape</span> <span class="o">=</span> <span class="n">ret</span>
<a id="__codelineno-0-1332" name="__codelineno-0-1332"></a>
<a id="__codelineno-0-1333" name="__codelineno-0-1333"></a>    <span class="c1"># construct new data</span>
<a id="__codelineno-0-1334" name="__codelineno-0-1334"></a>    <span class="n">newdata</span> <span class="o">=</span> <span class="n">MeshgridDataDict</span><span class="p">(</span><span class="o">**</span><span class="n">misc</span><span class="o">.</span><span class="n">unwrap_optional</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">structure</span><span class="p">(</span><span class="n">add_shape</span><span class="o">=</span><span class="kc">False</span><span class="p">)))</span>
<a id="__codelineno-0-1335" name="__codelineno-0-1335"></a>    <span class="n">axlist</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">dependents</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-1336" name="__codelineno-0-1336"></a>
<a id="__codelineno-0-1337" name="__codelineno-0-1337"></a>    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-1338" name="__codelineno-0-1338"></a>        <span class="n">vals</span> <span class="o">=</span> <span class="n">num</span><span class="o">.</span><span class="n">array1d_to_meshgrid</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">],</span> <span class="n">target_shape</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="n">copy</span><span class="p">)</span>
<a id="__codelineno-0-1339" name="__codelineno-0-1339"></a>
<a id="__codelineno-0-1340" name="__codelineno-0-1340"></a>        <span class="c1"># if an inner axis order is given, we transpose to transform from that</span>
<a id="__codelineno-0-1341" name="__codelineno-0-1341"></a>        <span class="c1"># to the specified order.</span>
<a id="__codelineno-0-1342" name="__codelineno-0-1342"></a>        <span class="k">if</span> <span class="n">inner_axis_order</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1343" name="__codelineno-0-1343"></a>            <span class="n">transpose_idxs</span> <span class="o">=</span> <span class="n">misc</span><span class="o">.</span><span class="n">reorder_indices</span><span class="p">(</span>
<a id="__codelineno-0-1344" name="__codelineno-0-1344"></a>                <span class="n">inner_axis_order</span><span class="p">,</span> <span class="n">axlist</span><span class="p">)</span>
<a id="__codelineno-0-1345" name="__codelineno-0-1345"></a>            <span class="n">vals</span> <span class="o">=</span> <span class="n">vals</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">transpose_idxs</span><span class="p">)</span>
<a id="__codelineno-0-1346" name="__codelineno-0-1346"></a>
<a id="__codelineno-0-1347" name="__codelineno-0-1347"></a>        <span class="n">newdata</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vals</span>
<a id="__codelineno-0-1348" name="__codelineno-0-1348"></a>
<a id="__codelineno-0-1349" name="__codelineno-0-1349"></a>    <span class="n">newdata</span> <span class="o">=</span> <span class="n">newdata</span><span class="o">.</span><span class="n">sanitize</span><span class="p">()</span>
<a id="__codelineno-0-1350" name="__codelineno-0-1350"></a>    <span class="n">newdata</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
<a id="__codelineno-0-1351" name="__codelineno-0-1351"></a>    <span class="k">return</span> <span class="n">newdata</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="labcore.data.datadict.datasets_are_equal" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">datasets_are_equal</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">ignore_meta</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Check whether two datasets are equal.</p>
<p>Compares type, structure, and content of all fields.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>a</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="labcore.data.datadict.DataDictBase" href="#labcore.data.datadict.DataDictBase">DataDictBase</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>First dataset.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>b</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="labcore.data.datadict.DataDictBase" href="#labcore.data.datadict.DataDictBase">DataDictBase</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Second dataset.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>ignore_meta</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>True</code>, do not verify if metadata matches.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p><code>True</code> or <code>False</code>.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1591">1591</a></span>
<span class="normal"><a href="#__codelineno-0-1592">1592</a></span>
<span class="normal"><a href="#__codelineno-0-1593">1593</a></span>
<span class="normal"><a href="#__codelineno-0-1594">1594</a></span>
<span class="normal"><a href="#__codelineno-0-1595">1595</a></span>
<span class="normal"><a href="#__codelineno-0-1596">1596</a></span>
<span class="normal"><a href="#__codelineno-0-1597">1597</a></span>
<span class="normal"><a href="#__codelineno-0-1598">1598</a></span>
<span class="normal"><a href="#__codelineno-0-1599">1599</a></span>
<span class="normal"><a href="#__codelineno-0-1600">1600</a></span>
<span class="normal"><a href="#__codelineno-0-1601">1601</a></span>
<span class="normal"><a href="#__codelineno-0-1602">1602</a></span>
<span class="normal"><a href="#__codelineno-0-1603">1603</a></span>
<span class="normal"><a href="#__codelineno-0-1604">1604</a></span>
<span class="normal"><a href="#__codelineno-0-1605">1605</a></span>
<span class="normal"><a href="#__codelineno-0-1606">1606</a></span>
<span class="normal"><a href="#__codelineno-0-1607">1607</a></span>
<span class="normal"><a href="#__codelineno-0-1608">1608</a></span>
<span class="normal"><a href="#__codelineno-0-1609">1609</a></span>
<span class="normal"><a href="#__codelineno-0-1610">1610</a></span>
<span class="normal"><a href="#__codelineno-0-1611">1611</a></span>
<span class="normal"><a href="#__codelineno-0-1612">1612</a></span>
<span class="normal"><a href="#__codelineno-0-1613">1613</a></span>
<span class="normal"><a href="#__codelineno-0-1614">1614</a></span>
<span class="normal"><a href="#__codelineno-0-1615">1615</a></span>
<span class="normal"><a href="#__codelineno-0-1616">1616</a></span>
<span class="normal"><a href="#__codelineno-0-1617">1617</a></span>
<span class="normal"><a href="#__codelineno-0-1618">1618</a></span>
<span class="normal"><a href="#__codelineno-0-1619">1619</a></span>
<span class="normal"><a href="#__codelineno-0-1620">1620</a></span>
<span class="normal"><a href="#__codelineno-0-1621">1621</a></span>
<span class="normal"><a href="#__codelineno-0-1622">1622</a></span>
<span class="normal"><a href="#__codelineno-0-1623">1623</a></span>
<span class="normal"><a href="#__codelineno-0-1624">1624</a></span>
<span class="normal"><a href="#__codelineno-0-1625">1625</a></span>
<span class="normal"><a href="#__codelineno-0-1626">1626</a></span>
<span class="normal"><a href="#__codelineno-0-1627">1627</a></span>
<span class="normal"><a href="#__codelineno-0-1628">1628</a></span>
<span class="normal"><a href="#__codelineno-0-1629">1629</a></span>
<span class="normal"><a href="#__codelineno-0-1630">1630</a></span>
<span class="normal"><a href="#__codelineno-0-1631">1631</a></span>
<span class="normal"><a href="#__codelineno-0-1632">1632</a></span>
<span class="normal"><a href="#__codelineno-0-1633">1633</a></span>
<span class="normal"><a href="#__codelineno-0-1634">1634</a></span>
<span class="normal"><a href="#__codelineno-0-1635">1635</a></span>
<span class="normal"><a href="#__codelineno-0-1636">1636</a></span>
<span class="normal"><a href="#__codelineno-0-1637">1637</a></span>
<span class="normal"><a href="#__codelineno-0-1638">1638</a></span>
<span class="normal"><a href="#__codelineno-0-1639">1639</a></span>
<span class="normal"><a href="#__codelineno-0-1640">1640</a></span>
<span class="normal"><a href="#__codelineno-0-1641">1641</a></span>
<span class="normal"><a href="#__codelineno-0-1642">1642</a></span>
<span class="normal"><a href="#__codelineno-0-1643">1643</a></span>
<span class="normal"><a href="#__codelineno-0-1644">1644</a></span>
<span class="normal"><a href="#__codelineno-0-1645">1645</a></span>
<span class="normal"><a href="#__codelineno-0-1646">1646</a></span>
<span class="normal"><a href="#__codelineno-0-1647">1647</a></span>
<span class="normal"><a href="#__codelineno-0-1648">1648</a></span>
<span class="normal"><a href="#__codelineno-0-1649">1649</a></span>
<span class="normal"><a href="#__codelineno-0-1650">1650</a></span>
<span class="normal"><a href="#__codelineno-0-1651">1651</a></span>
<span class="normal"><a href="#__codelineno-0-1652">1652</a></span>
<span class="normal"><a href="#__codelineno-0-1653">1653</a></span>
<span class="normal"><a href="#__codelineno-0-1654">1654</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1591" name="__codelineno-0-1591"></a><span class="k">def</span><span class="w"> </span><span class="nf">datasets_are_equal</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">DataDictBase</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">DataDictBase</span><span class="p">,</span>
<a id="__codelineno-0-1592" name="__codelineno-0-1592"></a>                       <span class="n">ignore_meta</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1593" name="__codelineno-0-1593"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Check whether two datasets are equal.</span>
<a id="__codelineno-0-1594" name="__codelineno-0-1594"></a>
<a id="__codelineno-0-1595" name="__codelineno-0-1595"></a><span class="sd">    Compares type, structure, and content of all fields.</span>
<a id="__codelineno-0-1596" name="__codelineno-0-1596"></a>
<a id="__codelineno-0-1597" name="__codelineno-0-1597"></a><span class="sd">    :param a: First dataset.</span>
<a id="__codelineno-0-1598" name="__codelineno-0-1598"></a><span class="sd">    :param b: Second dataset.</span>
<a id="__codelineno-0-1599" name="__codelineno-0-1599"></a><span class="sd">    :param ignore_meta: If ``True``, do not verify if metadata matches.</span>
<a id="__codelineno-0-1600" name="__codelineno-0-1600"></a><span class="sd">    :returns: ``True`` or ``False``.</span>
<a id="__codelineno-0-1601" name="__codelineno-0-1601"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1602" name="__codelineno-0-1602"></a>
<a id="__codelineno-0-1603" name="__codelineno-0-1603"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">==</span> <span class="nb">type</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
<a id="__codelineno-0-1604" name="__codelineno-0-1604"></a>        <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-1605" name="__codelineno-0-1605"></a>
<a id="__codelineno-0-1606" name="__codelineno-0-1606"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">a</span><span class="o">.</span><span class="n">same_structure</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<a id="__codelineno-0-1607" name="__codelineno-0-1607"></a>        <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-1608" name="__codelineno-0-1608"></a>
<a id="__codelineno-0-1609" name="__codelineno-0-1609"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">ignore_meta</span><span class="p">:</span>
<a id="__codelineno-0-1610" name="__codelineno-0-1610"></a>        <span class="c1"># are all meta data of a also in b, and are they the same value?</span>
<a id="__codelineno-0-1611" name="__codelineno-0-1611"></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">meta_items</span><span class="p">():</span>
<a id="__codelineno-0-1612" name="__codelineno-0-1612"></a>            <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">kk</span> <span class="k">for</span> <span class="n">kk</span><span class="p">,</span> <span class="n">vv</span> <span class="ow">in</span> <span class="n">b</span><span class="o">.</span><span class="n">meta_items</span><span class="p">()]:</span>
<a id="__codelineno-0-1613" name="__codelineno-0-1613"></a>                <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-1614" name="__codelineno-0-1614"></a>            <span class="k">elif</span> <span class="n">b</span><span class="o">.</span><span class="n">meta_val</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">!=</span> <span class="n">v</span><span class="p">:</span>
<a id="__codelineno-0-1615" name="__codelineno-0-1615"></a>                <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-1616" name="__codelineno-0-1616"></a>
<a id="__codelineno-0-1617" name="__codelineno-0-1617"></a>        <span class="c1"># are all meta data of b also in a?</span>
<a id="__codelineno-0-1618" name="__codelineno-0-1618"></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">b</span><span class="o">.</span><span class="n">meta_items</span><span class="p">():</span>
<a id="__codelineno-0-1619" name="__codelineno-0-1619"></a>            <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">kk</span> <span class="k">for</span> <span class="n">kk</span><span class="p">,</span> <span class="n">vv</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">meta_items</span><span class="p">()]:</span>
<a id="__codelineno-0-1620" name="__codelineno-0-1620"></a>                <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-1621" name="__codelineno-0-1621"></a>
<a id="__codelineno-0-1622" name="__codelineno-0-1622"></a>    <span class="c1"># check all data fields in a</span>
<a id="__codelineno-0-1623" name="__codelineno-0-1623"></a>    <span class="k">for</span> <span class="n">dn</span><span class="p">,</span> <span class="n">dv</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-1624" name="__codelineno-0-1624"></a>
<a id="__codelineno-0-1625" name="__codelineno-0-1625"></a>        <span class="c1"># are all fields also present in b?</span>
<a id="__codelineno-0-1626" name="__codelineno-0-1626"></a>        <span class="k">if</span> <span class="n">dn</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">dnn</span> <span class="k">for</span> <span class="n">dnn</span><span class="p">,</span> <span class="n">dvv</span> <span class="ow">in</span> <span class="n">b</span><span class="o">.</span><span class="n">data_items</span><span class="p">()]:</span>
<a id="__codelineno-0-1627" name="__codelineno-0-1627"></a>            <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-1628" name="__codelineno-0-1628"></a>
<a id="__codelineno-0-1629" name="__codelineno-0-1629"></a>        <span class="c1"># check if data is equal</span>
<a id="__codelineno-0-1630" name="__codelineno-0-1630"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">num</span><span class="o">.</span><span class="n">arrays_equal</span><span class="p">(</span>
<a id="__codelineno-0-1631" name="__codelineno-0-1631"></a>                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">data_vals</span><span class="p">(</span><span class="n">dn</span><span class="p">)),</span>
<a id="__codelineno-0-1632" name="__codelineno-0-1632"></a>                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">data_vals</span><span class="p">(</span><span class="n">dn</span><span class="p">)),</span>
<a id="__codelineno-0-1633" name="__codelineno-0-1633"></a>        <span class="p">):</span>
<a id="__codelineno-0-1634" name="__codelineno-0-1634"></a>            <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-1635" name="__codelineno-0-1635"></a>
<a id="__codelineno-0-1636" name="__codelineno-0-1636"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">ignore_meta</span><span class="p">:</span>
<a id="__codelineno-0-1637" name="__codelineno-0-1637"></a>            <span class="c1"># check meta data</span>
<a id="__codelineno-0-1638" name="__codelineno-0-1638"></a>            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">meta_items</span><span class="p">(</span><span class="n">dn</span><span class="p">):</span>
<a id="__codelineno-0-1639" name="__codelineno-0-1639"></a>                <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">kk</span> <span class="k">for</span> <span class="n">kk</span><span class="p">,</span> <span class="n">vv</span> <span class="ow">in</span> <span class="n">b</span><span class="o">.</span><span class="n">meta_items</span><span class="p">(</span><span class="n">dn</span><span class="p">)]:</span>
<a id="__codelineno-0-1640" name="__codelineno-0-1640"></a>                    <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-1641" name="__codelineno-0-1641"></a>                <span class="k">elif</span> <span class="n">v</span> <span class="o">!=</span> <span class="n">b</span><span class="o">.</span><span class="n">meta_val</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">dn</span><span class="p">):</span>
<a id="__codelineno-0-1642" name="__codelineno-0-1642"></a>                    <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-1643" name="__codelineno-0-1643"></a>
<a id="__codelineno-0-1644" name="__codelineno-0-1644"></a>    <span class="c1"># only thing left to check is whether there are items in b but not a</span>
<a id="__codelineno-0-1645" name="__codelineno-0-1645"></a>    <span class="k">for</span> <span class="n">dn</span><span class="p">,</span> <span class="n">dv</span> <span class="ow">in</span> <span class="n">b</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-1646" name="__codelineno-0-1646"></a>        <span class="k">if</span> <span class="n">dn</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">dnn</span> <span class="k">for</span> <span class="n">dnn</span><span class="p">,</span> <span class="n">dvv</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">data_items</span><span class="p">()]:</span>
<a id="__codelineno-0-1647" name="__codelineno-0-1647"></a>            <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-1648" name="__codelineno-0-1648"></a>
<a id="__codelineno-0-1649" name="__codelineno-0-1649"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">ignore_meta</span><span class="p">:</span>
<a id="__codelineno-0-1650" name="__codelineno-0-1650"></a>            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">b</span><span class="o">.</span><span class="n">meta_items</span><span class="p">(</span><span class="n">dn</span><span class="p">):</span>
<a id="__codelineno-0-1651" name="__codelineno-0-1651"></a>                <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">kk</span> <span class="k">for</span> <span class="n">kk</span><span class="p">,</span> <span class="n">vv</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">meta_items</span><span class="p">(</span><span class="n">dn</span><span class="p">)]:</span>
<a id="__codelineno-0-1652" name="__codelineno-0-1652"></a>                    <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-1653" name="__codelineno-0-1653"></a>
<a id="__codelineno-0-1654" name="__codelineno-0-1654"></a>    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="labcore.data.datadict.datastructure_from_string" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">datastructure_from_string</span><span class="p">(</span><span class="n">description</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Construct a DataDict from a string description.</p>
<p>Examples:
    * <code>"data[mV](x, y)"</code> results in a datadict with one dependent <code>data</code> with unit <code>mV</code> and
      two independents, <code>x</code> and <code>y</code>, that do not have units.</p>
<div class="highlight"><pre><span></span><code>* ``&quot;data_1[mV](x, y); data_2[mA](x); x[mV]; y[nT]&quot;`` results in two dependents,
  one of them depening on ``x`` and ``y``, the other only on ``x``.
  Note that ``x`` and ``y`` have units. We can (but do not have to) omit them when specifying
  the dependencies.

* ``&quot;data_1[mV](x[mV], y[nT]); data_2[mA](x[mV])&quot;``. Same result as the previous example.
</code></pre></div>
<p>Rules:
    We recognize descriptions of the form <code>field1[unit1](ax1, ax2, ...); field1[unit2](...); ...</code>.</p>
<div class="highlight"><pre><span></span><code>* Field names (like ``field1`` and ``field2`` above) have to start with a letter, and may contain
  word characters.
* Field descriptors consist of the name, optional unit (presence signified by square brackets),
  and optional dependencies (presence signified by round brackets).
* Dependencies (axes) are implicitly recognized as fields (and thus have the same naming restrictions as field
  names).
* Axes are separated by commas.
* Axes may have a unit when specified as dependency, but besides the name, square brackets, and commas no other
  characters are recognized within the round brackets that specify the dependency.
* In addition to being specified as dependency for a field,
  axes may be specified also as additional field without dependency,
  for instance to specify the unit (may simplify the string). For example,
  ``z1[x, y]; z2[x, y]; x[V]; y[V]``.
* Units may only consist of word characters.
* Use of unexpected characters will result in the ignoring the part that contains the symbol.
* The regular expression used to find field descriptors is:
  ``((?&lt;=\A)|(?&lt;=\;))[a-zA-Z]+\w*(\[\w*\])?(\(([a-zA-Z]+\w*(\[\w*\])?\,?)*\))?``
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1472">1472</a></span>
<span class="normal"><a href="#__codelineno-0-1473">1473</a></span>
<span class="normal"><a href="#__codelineno-0-1474">1474</a></span>
<span class="normal"><a href="#__codelineno-0-1475">1475</a></span>
<span class="normal"><a href="#__codelineno-0-1476">1476</a></span>
<span class="normal"><a href="#__codelineno-0-1477">1477</a></span>
<span class="normal"><a href="#__codelineno-0-1478">1478</a></span>
<span class="normal"><a href="#__codelineno-0-1479">1479</a></span>
<span class="normal"><a href="#__codelineno-0-1480">1480</a></span>
<span class="normal"><a href="#__codelineno-0-1481">1481</a></span>
<span class="normal"><a href="#__codelineno-0-1482">1482</a></span>
<span class="normal"><a href="#__codelineno-0-1483">1483</a></span>
<span class="normal"><a href="#__codelineno-0-1484">1484</a></span>
<span class="normal"><a href="#__codelineno-0-1485">1485</a></span>
<span class="normal"><a href="#__codelineno-0-1486">1486</a></span>
<span class="normal"><a href="#__codelineno-0-1487">1487</a></span>
<span class="normal"><a href="#__codelineno-0-1488">1488</a></span>
<span class="normal"><a href="#__codelineno-0-1489">1489</a></span>
<span class="normal"><a href="#__codelineno-0-1490">1490</a></span>
<span class="normal"><a href="#__codelineno-0-1491">1491</a></span>
<span class="normal"><a href="#__codelineno-0-1492">1492</a></span>
<span class="normal"><a href="#__codelineno-0-1493">1493</a></span>
<span class="normal"><a href="#__codelineno-0-1494">1494</a></span>
<span class="normal"><a href="#__codelineno-0-1495">1495</a></span>
<span class="normal"><a href="#__codelineno-0-1496">1496</a></span>
<span class="normal"><a href="#__codelineno-0-1497">1497</a></span>
<span class="normal"><a href="#__codelineno-0-1498">1498</a></span>
<span class="normal"><a href="#__codelineno-0-1499">1499</a></span>
<span class="normal"><a href="#__codelineno-0-1500">1500</a></span>
<span class="normal"><a href="#__codelineno-0-1501">1501</a></span>
<span class="normal"><a href="#__codelineno-0-1502">1502</a></span>
<span class="normal"><a href="#__codelineno-0-1503">1503</a></span>
<span class="normal"><a href="#__codelineno-0-1504">1504</a></span>
<span class="normal"><a href="#__codelineno-0-1505">1505</a></span>
<span class="normal"><a href="#__codelineno-0-1506">1506</a></span>
<span class="normal"><a href="#__codelineno-0-1507">1507</a></span>
<span class="normal"><a href="#__codelineno-0-1508">1508</a></span>
<span class="normal"><a href="#__codelineno-0-1509">1509</a></span>
<span class="normal"><a href="#__codelineno-0-1510">1510</a></span>
<span class="normal"><a href="#__codelineno-0-1511">1511</a></span>
<span class="normal"><a href="#__codelineno-0-1512">1512</a></span>
<span class="normal"><a href="#__codelineno-0-1513">1513</a></span>
<span class="normal"><a href="#__codelineno-0-1514">1514</a></span>
<span class="normal"><a href="#__codelineno-0-1515">1515</a></span>
<span class="normal"><a href="#__codelineno-0-1516">1516</a></span>
<span class="normal"><a href="#__codelineno-0-1517">1517</a></span>
<span class="normal"><a href="#__codelineno-0-1518">1518</a></span>
<span class="normal"><a href="#__codelineno-0-1519">1519</a></span>
<span class="normal"><a href="#__codelineno-0-1520">1520</a></span>
<span class="normal"><a href="#__codelineno-0-1521">1521</a></span>
<span class="normal"><a href="#__codelineno-0-1522">1522</a></span>
<span class="normal"><a href="#__codelineno-0-1523">1523</a></span>
<span class="normal"><a href="#__codelineno-0-1524">1524</a></span>
<span class="normal"><a href="#__codelineno-0-1525">1525</a></span>
<span class="normal"><a href="#__codelineno-0-1526">1526</a></span>
<span class="normal"><a href="#__codelineno-0-1527">1527</a></span>
<span class="normal"><a href="#__codelineno-0-1528">1528</a></span>
<span class="normal"><a href="#__codelineno-0-1529">1529</a></span>
<span class="normal"><a href="#__codelineno-0-1530">1530</a></span>
<span class="normal"><a href="#__codelineno-0-1531">1531</a></span>
<span class="normal"><a href="#__codelineno-0-1532">1532</a></span>
<span class="normal"><a href="#__codelineno-0-1533">1533</a></span>
<span class="normal"><a href="#__codelineno-0-1534">1534</a></span>
<span class="normal"><a href="#__codelineno-0-1535">1535</a></span>
<span class="normal"><a href="#__codelineno-0-1536">1536</a></span>
<span class="normal"><a href="#__codelineno-0-1537">1537</a></span>
<span class="normal"><a href="#__codelineno-0-1538">1538</a></span>
<span class="normal"><a href="#__codelineno-0-1539">1539</a></span>
<span class="normal"><a href="#__codelineno-0-1540">1540</a></span>
<span class="normal"><a href="#__codelineno-0-1541">1541</a></span>
<span class="normal"><a href="#__codelineno-0-1542">1542</a></span>
<span class="normal"><a href="#__codelineno-0-1543">1543</a></span>
<span class="normal"><a href="#__codelineno-0-1544">1544</a></span>
<span class="normal"><a href="#__codelineno-0-1545">1545</a></span>
<span class="normal"><a href="#__codelineno-0-1546">1546</a></span>
<span class="normal"><a href="#__codelineno-0-1547">1547</a></span>
<span class="normal"><a href="#__codelineno-0-1548">1548</a></span>
<span class="normal"><a href="#__codelineno-0-1549">1549</a></span>
<span class="normal"><a href="#__codelineno-0-1550">1550</a></span>
<span class="normal"><a href="#__codelineno-0-1551">1551</a></span>
<span class="normal"><a href="#__codelineno-0-1552">1552</a></span>
<span class="normal"><a href="#__codelineno-0-1553">1553</a></span>
<span class="normal"><a href="#__codelineno-0-1554">1554</a></span>
<span class="normal"><a href="#__codelineno-0-1555">1555</a></span>
<span class="normal"><a href="#__codelineno-0-1556">1556</a></span>
<span class="normal"><a href="#__codelineno-0-1557">1557</a></span>
<span class="normal"><a href="#__codelineno-0-1558">1558</a></span>
<span class="normal"><a href="#__codelineno-0-1559">1559</a></span>
<span class="normal"><a href="#__codelineno-0-1560">1560</a></span>
<span class="normal"><a href="#__codelineno-0-1561">1561</a></span>
<span class="normal"><a href="#__codelineno-0-1562">1562</a></span>
<span class="normal"><a href="#__codelineno-0-1563">1563</a></span>
<span class="normal"><a href="#__codelineno-0-1564">1564</a></span>
<span class="normal"><a href="#__codelineno-0-1565">1565</a></span>
<span class="normal"><a href="#__codelineno-0-1566">1566</a></span>
<span class="normal"><a href="#__codelineno-0-1567">1567</a></span>
<span class="normal"><a href="#__codelineno-0-1568">1568</a></span>
<span class="normal"><a href="#__codelineno-0-1569">1569</a></span>
<span class="normal"><a href="#__codelineno-0-1570">1570</a></span>
<span class="normal"><a href="#__codelineno-0-1571">1571</a></span>
<span class="normal"><a href="#__codelineno-0-1572">1572</a></span>
<span class="normal"><a href="#__codelineno-0-1573">1573</a></span>
<span class="normal"><a href="#__codelineno-0-1574">1574</a></span>
<span class="normal"><a href="#__codelineno-0-1575">1575</a></span>
<span class="normal"><a href="#__codelineno-0-1576">1576</a></span>
<span class="normal"><a href="#__codelineno-0-1577">1577</a></span>
<span class="normal"><a href="#__codelineno-0-1578">1578</a></span>
<span class="normal"><a href="#__codelineno-0-1579">1579</a></span>
<span class="normal"><a href="#__codelineno-0-1580">1580</a></span>
<span class="normal"><a href="#__codelineno-0-1581">1581</a></span>
<span class="normal"><a href="#__codelineno-0-1582">1582</a></span>
<span class="normal"><a href="#__codelineno-0-1583">1583</a></span>
<span class="normal"><a href="#__codelineno-0-1584">1584</a></span>
<span class="normal"><a href="#__codelineno-0-1585">1585</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1472" name="__codelineno-0-1472"></a><span class="k">def</span><span class="w"> </span><span class="nf">datastructure_from_string</span><span class="p">(</span><span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataDict</span><span class="p">:</span>
<a id="__codelineno-0-1473" name="__codelineno-0-1473"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Construct a DataDict from a string description.</span>
<a id="__codelineno-0-1474" name="__codelineno-0-1474"></a>
<a id="__codelineno-0-1475" name="__codelineno-0-1475"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-1476" name="__codelineno-0-1476"></a><span class="sd">        * ``&quot;data[mV](x, y)&quot;`` results in a datadict with one dependent ``data`` with unit ``mV`` and</span>
<a id="__codelineno-0-1477" name="__codelineno-0-1477"></a><span class="sd">          two independents, ``x`` and ``y``, that do not have units.</span>
<a id="__codelineno-0-1478" name="__codelineno-0-1478"></a>
<a id="__codelineno-0-1479" name="__codelineno-0-1479"></a><span class="sd">        * ``&quot;data_1[mV](x, y); data_2[mA](x); x[mV]; y[nT]&quot;`` results in two dependents,</span>
<a id="__codelineno-0-1480" name="__codelineno-0-1480"></a><span class="sd">          one of them depening on ``x`` and ``y``, the other only on ``x``.</span>
<a id="__codelineno-0-1481" name="__codelineno-0-1481"></a><span class="sd">          Note that ``x`` and ``y`` have units. We can (but do not have to) omit them when specifying</span>
<a id="__codelineno-0-1482" name="__codelineno-0-1482"></a><span class="sd">          the dependencies.</span>
<a id="__codelineno-0-1483" name="__codelineno-0-1483"></a>
<a id="__codelineno-0-1484" name="__codelineno-0-1484"></a><span class="sd">        * ``&quot;data_1[mV](x[mV], y[nT]); data_2[mA](x[mV])&quot;``. Same result as the previous example.</span>
<a id="__codelineno-0-1485" name="__codelineno-0-1485"></a>
<a id="__codelineno-0-1486" name="__codelineno-0-1486"></a><span class="sd">    Rules:</span>
<a id="__codelineno-0-1487" name="__codelineno-0-1487"></a><span class="sd">        We recognize descriptions of the form ``field1[unit1](ax1, ax2, ...); field1[unit2](...); ...``.</span>
<a id="__codelineno-0-1488" name="__codelineno-0-1488"></a>
<a id="__codelineno-0-1489" name="__codelineno-0-1489"></a><span class="sd">        * Field names (like ``field1`` and ``field2`` above) have to start with a letter, and may contain</span>
<a id="__codelineno-0-1490" name="__codelineno-0-1490"></a><span class="sd">          word characters.</span>
<a id="__codelineno-0-1491" name="__codelineno-0-1491"></a><span class="sd">        * Field descriptors consist of the name, optional unit (presence signified by square brackets),</span>
<a id="__codelineno-0-1492" name="__codelineno-0-1492"></a><span class="sd">          and optional dependencies (presence signified by round brackets).</span>
<a id="__codelineno-0-1493" name="__codelineno-0-1493"></a><span class="sd">        * Dependencies (axes) are implicitly recognized as fields (and thus have the same naming restrictions as field</span>
<a id="__codelineno-0-1494" name="__codelineno-0-1494"></a><span class="sd">          names).</span>
<a id="__codelineno-0-1495" name="__codelineno-0-1495"></a><span class="sd">        * Axes are separated by commas.</span>
<a id="__codelineno-0-1496" name="__codelineno-0-1496"></a><span class="sd">        * Axes may have a unit when specified as dependency, but besides the name, square brackets, and commas no other</span>
<a id="__codelineno-0-1497" name="__codelineno-0-1497"></a><span class="sd">          characters are recognized within the round brackets that specify the dependency.</span>
<a id="__codelineno-0-1498" name="__codelineno-0-1498"></a><span class="sd">        * In addition to being specified as dependency for a field,</span>
<a id="__codelineno-0-1499" name="__codelineno-0-1499"></a><span class="sd">          axes may be specified also as additional field without dependency,</span>
<a id="__codelineno-0-1500" name="__codelineno-0-1500"></a><span class="sd">          for instance to specify the unit (may simplify the string). For example,</span>
<a id="__codelineno-0-1501" name="__codelineno-0-1501"></a><span class="sd">          ``z1[x, y]; z2[x, y]; x[V]; y[V]``.</span>
<a id="__codelineno-0-1502" name="__codelineno-0-1502"></a><span class="sd">        * Units may only consist of word characters.</span>
<a id="__codelineno-0-1503" name="__codelineno-0-1503"></a><span class="sd">        * Use of unexpected characters will result in the ignoring the part that contains the symbol.</span>
<a id="__codelineno-0-1504" name="__codelineno-0-1504"></a><span class="sd">        * The regular expression used to find field descriptors is:</span>
<a id="__codelineno-0-1505" name="__codelineno-0-1505"></a><span class="sd">          ``((?&lt;=\A)|(?&lt;=\;))[a-zA-Z]+\w*(\[\w*\])?(\(([a-zA-Z]+\w*(\[\w*\])?\,?)*\))?``</span>
<a id="__codelineno-0-1506" name="__codelineno-0-1506"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1507" name="__codelineno-0-1507"></a>
<a id="__codelineno-0-1508" name="__codelineno-0-1508"></a>    <span class="n">description</span> <span class="o">=</span> <span class="n">description</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1509" name="__codelineno-0-1509"></a>
<a id="__codelineno-0-1510" name="__codelineno-0-1510"></a>    <span class="n">data_name_pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;[a-zA-Z]+\w*(\[\w*\])?&quot;</span>
<a id="__codelineno-0-1511" name="__codelineno-0-1511"></a>    <span class="n">pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;((?&lt;=\A)|(?&lt;=\;))&quot;</span> <span class="o">+</span> <span class="n">data_name_pattern</span> <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;(\((&quot;</span> <span class="o">+</span> <span class="n">data_name_pattern</span> <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;\,?)*\))?&quot;</span>
<a id="__codelineno-0-1512" name="__codelineno-0-1512"></a>    <span class="n">r</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">pattern</span><span class="p">)</span>
<a id="__codelineno-0-1513" name="__codelineno-0-1513"></a>
<a id="__codelineno-0-1514" name="__codelineno-0-1514"></a>    <span class="n">data_fields</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1515" name="__codelineno-0-1515"></a>    <span class="k">while</span> <span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">description</span><span class="p">)):</span>
<a id="__codelineno-0-1516" name="__codelineno-0-1516"></a>        <span class="n">match</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">description</span><span class="p">)</span>
<a id="__codelineno-0-1517" name="__codelineno-0-1517"></a>        <span class="k">if</span> <span class="n">match</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">break</span>
<a id="__codelineno-0-1518" name="__codelineno-0-1518"></a>        <span class="n">data_fields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">description</span><span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="o">*</span><span class="n">match</span><span class="o">.</span><span class="n">span</span><span class="p">())])</span>
<a id="__codelineno-0-1519" name="__codelineno-0-1519"></a>        <span class="n">description</span> <span class="o">=</span> <span class="n">description</span><span class="p">[</span><span class="n">match</span><span class="o">.</span><span class="n">span</span><span class="p">()[</span><span class="mi">1</span><span class="p">]:]</span>
<a id="__codelineno-0-1520" name="__codelineno-0-1520"></a>
<a id="__codelineno-0-1521" name="__codelineno-0-1521"></a>    <span class="n">dd</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<a id="__codelineno-0-1522" name="__codelineno-0-1522"></a>
<a id="__codelineno-0-1523" name="__codelineno-0-1523"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_field</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]:</span>
<a id="__codelineno-0-1524" name="__codelineno-0-1524"></a>        <span class="n">has_unit</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="s1">&#39;[&#39;</span> <span class="ow">in</span> <span class="n">df</span> <span class="ow">and</span> <span class="s1">&#39;]&#39;</span> <span class="ow">in</span> <span class="n">df</span> <span class="k">else</span> <span class="kc">False</span>
<a id="__codelineno-0-1525" name="__codelineno-0-1525"></a>        <span class="n">has_dependencies</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="s1">&#39;(&#39;</span> <span class="ow">in</span> <span class="n">df</span> <span class="ow">and</span> <span class="s1">&#39;)&#39;</span> <span class="ow">in</span> <span class="n">df</span> <span class="k">else</span> <span class="kc">False</span>
<a id="__codelineno-0-1526" name="__codelineno-0-1526"></a>
<a id="__codelineno-0-1527" name="__codelineno-0-1527"></a>        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-1528" name="__codelineno-0-1528"></a>        <span class="n">unit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1529" name="__codelineno-0-1529"></a>        <span class="n">axes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1530" name="__codelineno-0-1530"></a>
<a id="__codelineno-0-1531" name="__codelineno-0-1531"></a>        <span class="k">if</span> <span class="n">has_unit</span><span class="p">:</span>
<a id="__codelineno-0-1532" name="__codelineno-0-1532"></a>            <span class="n">name</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;[&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1533" name="__codelineno-0-1533"></a>            <span class="n">unit</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;[&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;]&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1534" name="__codelineno-0-1534"></a>            <span class="k">if</span> <span class="n">has_dependencies</span><span class="p">:</span>
<a id="__codelineno-0-1535" name="__codelineno-0-1535"></a>                <span class="n">axes</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<a id="__codelineno-0-1536" name="__codelineno-0-1536"></a>        <span class="k">elif</span> <span class="n">has_dependencies</span><span class="p">:</span>
<a id="__codelineno-0-1537" name="__codelineno-0-1537"></a>            <span class="n">name</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1538" name="__codelineno-0-1538"></a>            <span class="n">axes</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<a id="__codelineno-0-1539" name="__codelineno-0-1539"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1540" name="__codelineno-0-1540"></a>            <span class="n">name</span> <span class="o">=</span> <span class="n">df</span>
<a id="__codelineno-0-1541" name="__codelineno-0-1541"></a>
<a id="__codelineno-0-1542" name="__codelineno-0-1542"></a>        <span class="k">if</span> <span class="n">axes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1543" name="__codelineno-0-1543"></a>            <span class="n">axes</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1544" name="__codelineno-0-1544"></a>        <span class="k">return</span> <span class="n">name</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">axes</span>
<a id="__codelineno-0-1545" name="__codelineno-0-1545"></a>
<a id="__codelineno-0-1546" name="__codelineno-0-1546"></a>    <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">data_fields</span><span class="p">:</span>
<a id="__codelineno-0-1547" name="__codelineno-0-1547"></a>        <span class="n">name</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">analyze_field</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<a id="__codelineno-0-1548" name="__codelineno-0-1548"></a>
<a id="__codelineno-0-1549" name="__codelineno-0-1549"></a>        <span class="c1"># double specifying is only allowed for independents.</span>
<a id="__codelineno-0-1550" name="__codelineno-0-1550"></a>        <span class="c1"># if an independent is specified multiple times, units must not collide</span>
<a id="__codelineno-0-1551" name="__codelineno-0-1551"></a>        <span class="c1"># (but units do not have to be specified more than once)</span>
<a id="__codelineno-0-1552" name="__codelineno-0-1552"></a>        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">dd</span><span class="p">:</span>
<a id="__codelineno-0-1553" name="__codelineno-0-1553"></a>            <span class="k">if</span> <span class="s1">&#39;axes&#39;</span> <span class="ow">in</span> <span class="n">dd</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="ow">or</span> <span class="n">axes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1554" name="__codelineno-0-1554"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1"> is specified more than once.&#39;</span><span class="p">)</span>
<a id="__codelineno-0-1555" name="__codelineno-0-1555"></a>            <span class="k">if</span> <span class="s1">&#39;unit&#39;</span> <span class="ow">in</span> <span class="n">dd</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="ow">and</span> <span class="n">unit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">dd</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;unit&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">unit</span><span class="p">:</span>
<a id="__codelineno-0-1556" name="__codelineno-0-1556"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;conflicting units for </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<a id="__codelineno-0-1557" name="__codelineno-0-1557"></a>
<a id="__codelineno-0-1558" name="__codelineno-0-1558"></a>        <span class="n">dd</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<a id="__codelineno-0-1559" name="__codelineno-0-1559"></a>        <span class="k">if</span> <span class="n">unit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1560" name="__codelineno-0-1560"></a>            <span class="n">dd</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;unit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">unit</span>
<a id="__codelineno-0-1561" name="__codelineno-0-1561"></a>
<a id="__codelineno-0-1562" name="__codelineno-0-1562"></a>        <span class="k">if</span> <span class="n">axes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1563" name="__codelineno-0-1563"></a>            <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
<a id="__codelineno-0-1564" name="__codelineno-0-1564"></a>                <span class="n">ax_name</span><span class="p">,</span> <span class="n">ax_unit</span><span class="p">,</span> <span class="n">ax_axes</span> <span class="o">=</span> <span class="n">analyze_field</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<a id="__codelineno-0-1565" name="__codelineno-0-1565"></a>
<a id="__codelineno-0-1566" name="__codelineno-0-1566"></a>                <span class="c1"># we do not allow nested dependencies.</span>
<a id="__codelineno-0-1567" name="__codelineno-0-1567"></a>                <span class="k">if</span> <span class="n">ax_axes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1568" name="__codelineno-0-1568"></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ax_name</span><span class="si">}</span><span class="s1"> is independent, may not have dependencies&#39;</span><span class="p">)</span>
<a id="__codelineno-0-1569" name="__codelineno-0-1569"></a>
<a id="__codelineno-0-1570" name="__codelineno-0-1570"></a>                <span class="c1"># we can add fields implicitly from dependencies.</span>
<a id="__codelineno-0-1571" name="__codelineno-0-1571"></a>                <span class="c1"># independents may be given both implicitly and explicitly, but only</span>
<a id="__codelineno-0-1572" name="__codelineno-0-1572"></a>                <span class="c1"># when units don&#39;t collide.</span>
<a id="__codelineno-0-1573" name="__codelineno-0-1573"></a>                <span class="k">if</span> <span class="n">ax_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dd</span><span class="p">:</span>
<a id="__codelineno-0-1574" name="__codelineno-0-1574"></a>                    <span class="n">dd</span><span class="p">[</span><span class="n">ax_name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<a id="__codelineno-0-1575" name="__codelineno-0-1575"></a>                    <span class="k">if</span> <span class="n">ax_unit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1576" name="__codelineno-0-1576"></a>                        <span class="n">dd</span><span class="p">[</span><span class="n">ax_name</span><span class="p">][</span><span class="s1">&#39;unit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ax_unit</span>
<a id="__codelineno-0-1577" name="__codelineno-0-1577"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1578" name="__codelineno-0-1578"></a>                    <span class="k">if</span> <span class="s1">&#39;unit&#39;</span> <span class="ow">in</span> <span class="n">dd</span><span class="p">[</span><span class="n">ax_name</span><span class="p">]</span> <span class="ow">and</span> <span class="n">ax_unit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">dd</span><span class="p">[</span><span class="n">ax_name</span><span class="p">][</span><span class="s1">&#39;unit&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">ax_unit</span><span class="p">:</span>
<a id="__codelineno-0-1579" name="__codelineno-0-1579"></a>                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;conflicting units for </span><span class="si">{</span><span class="n">ax_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<a id="__codelineno-0-1580" name="__codelineno-0-1580"></a>
<a id="__codelineno-0-1581" name="__codelineno-0-1581"></a>                <span class="k">if</span> <span class="s1">&#39;axes&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dd</span><span class="p">[</span><span class="n">name</span><span class="p">]:</span>
<a id="__codelineno-0-1582" name="__codelineno-0-1582"></a>                    <span class="n">dd</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;axes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1583" name="__codelineno-0-1583"></a>                <span class="n">dd</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;axes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ax_name</span><span class="p">)</span>
<a id="__codelineno-0-1584" name="__codelineno-0-1584"></a>
<a id="__codelineno-0-1585" name="__codelineno-0-1585"></a>    <span class="k">return</span> <span class="n">DataDict</span><span class="p">(</span><span class="o">**</span><span class="n">dd</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="labcore.data.datadict.dd2df" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">dd2df</span><span class="p">(</span><span class="n">dd</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>make a pandas Dataframe from a datadict.
Uses MultiIndex, and assumes that all data fields are compatible.</p>
<h4 id="labcore.data.datadict.dd2df--parameters">Parameters</h4>
<p>dd : DataDict
    source data</p>
<h4 id="labcore.data.datadict.dd2df--returns">Returns</h4>
<p>DataFrame
    pandas DataFrame</p>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1657">1657</a></span>
<span class="normal"><a href="#__codelineno-0-1658">1658</a></span>
<span class="normal"><a href="#__codelineno-0-1659">1659</a></span>
<span class="normal"><a href="#__codelineno-0-1660">1660</a></span>
<span class="normal"><a href="#__codelineno-0-1661">1661</a></span>
<span class="normal"><a href="#__codelineno-0-1662">1662</a></span>
<span class="normal"><a href="#__codelineno-0-1663">1663</a></span>
<span class="normal"><a href="#__codelineno-0-1664">1664</a></span>
<span class="normal"><a href="#__codelineno-0-1665">1665</a></span>
<span class="normal"><a href="#__codelineno-0-1666">1666</a></span>
<span class="normal"><a href="#__codelineno-0-1667">1667</a></span>
<span class="normal"><a href="#__codelineno-0-1668">1668</a></span>
<span class="normal"><a href="#__codelineno-0-1669">1669</a></span>
<span class="normal"><a href="#__codelineno-0-1670">1670</a></span>
<span class="normal"><a href="#__codelineno-0-1671">1671</a></span>
<span class="normal"><a href="#__codelineno-0-1672">1672</a></span>
<span class="normal"><a href="#__codelineno-0-1673">1673</a></span>
<span class="normal"><a href="#__codelineno-0-1674">1674</a></span>
<span class="normal"><a href="#__codelineno-0-1675">1675</a></span>
<span class="normal"><a href="#__codelineno-0-1676">1676</a></span>
<span class="normal"><a href="#__codelineno-0-1677">1677</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1657" name="__codelineno-0-1657"></a><span class="k">def</span><span class="w"> </span><span class="nf">dd2df</span><span class="p">(</span><span class="n">dd</span><span class="p">:</span> <span class="n">DataDict</span><span class="p">):</span>
<a id="__codelineno-0-1658" name="__codelineno-0-1658"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;make a pandas Dataframe from a datadict.</span>
<a id="__codelineno-0-1659" name="__codelineno-0-1659"></a><span class="sd">    Uses MultiIndex, and assumes that all data fields are compatible.</span>
<a id="__codelineno-0-1660" name="__codelineno-0-1660"></a>
<a id="__codelineno-0-1661" name="__codelineno-0-1661"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-1662" name="__codelineno-0-1662"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-1663" name="__codelineno-0-1663"></a><span class="sd">    dd : DataDict</span>
<a id="__codelineno-0-1664" name="__codelineno-0-1664"></a><span class="sd">        source data</span>
<a id="__codelineno-0-1665" name="__codelineno-0-1665"></a>
<a id="__codelineno-0-1666" name="__codelineno-0-1666"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-1667" name="__codelineno-0-1667"></a><span class="sd">    -------</span>
<a id="__codelineno-0-1668" name="__codelineno-0-1668"></a><span class="sd">    DataFrame</span>
<a id="__codelineno-0-1669" name="__codelineno-0-1669"></a><span class="sd">        pandas DataFrame</span>
<a id="__codelineno-0-1670" name="__codelineno-0-1670"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1671" name="__codelineno-0-1671"></a>    <span class="n">dd_flat</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<a id="__codelineno-0-1672" name="__codelineno-0-1672"></a>    <span class="n">idx</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">(</span>
<a id="__codelineno-0-1673" name="__codelineno-0-1673"></a>        <span class="p">[</span><span class="n">dd_flat</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">dd_flat</span><span class="o">.</span><span class="n">axes</span><span class="p">()],</span>
<a id="__codelineno-0-1674" name="__codelineno-0-1674"></a>        <span class="n">names</span> <span class="o">=</span> <span class="n">dd_flat</span><span class="o">.</span><span class="n">axes</span><span class="p">(),</span>
<a id="__codelineno-0-1675" name="__codelineno-0-1675"></a>    <span class="p">)</span>
<a id="__codelineno-0-1676" name="__codelineno-0-1676"></a>    <span class="n">vals</span> <span class="o">=</span> <span class="p">{</span><span class="n">d</span><span class="p">:</span> <span class="n">dd_flat</span><span class="p">[</span><span class="n">d</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dd_flat</span><span class="o">.</span><span class="n">dependents</span><span class="p">()}</span>
<a id="__codelineno-0-1677" name="__codelineno-0-1677"></a>    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">vals</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">idx</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="labcore.data.datadict.dd2xr" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">dd2xr</span><span class="p">(</span><span class="n">dd</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>makes an xarray Dataset from a MeshgridDataDict.</p>
<p>TODO: currently only supports 'regular' grides, i.e., all axes
    are independet of each other, and can be represented by 1d arrays.
    For each axis, the first slice is used as coordinate values.</p>
<h4 id="labcore.data.datadict.dd2xr--parameters">Parameters</h4>
<p>dd : MeshgridDataDict
    input data</p>
<h4 id="labcore.data.datadict.dd2xr--returns">Returns</h4>
<p>xr.Dataset
    xarray Dataset</p>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1680">1680</a></span>
<span class="normal"><a href="#__codelineno-0-1681">1681</a></span>
<span class="normal"><a href="#__codelineno-0-1682">1682</a></span>
<span class="normal"><a href="#__codelineno-0-1683">1683</a></span>
<span class="normal"><a href="#__codelineno-0-1684">1684</a></span>
<span class="normal"><a href="#__codelineno-0-1685">1685</a></span>
<span class="normal"><a href="#__codelineno-0-1686">1686</a></span>
<span class="normal"><a href="#__codelineno-0-1687">1687</a></span>
<span class="normal"><a href="#__codelineno-0-1688">1688</a></span>
<span class="normal"><a href="#__codelineno-0-1689">1689</a></span>
<span class="normal"><a href="#__codelineno-0-1690">1690</a></span>
<span class="normal"><a href="#__codelineno-0-1691">1691</a></span>
<span class="normal"><a href="#__codelineno-0-1692">1692</a></span>
<span class="normal"><a href="#__codelineno-0-1693">1693</a></span>
<span class="normal"><a href="#__codelineno-0-1694">1694</a></span>
<span class="normal"><a href="#__codelineno-0-1695">1695</a></span>
<span class="normal"><a href="#__codelineno-0-1696">1696</a></span>
<span class="normal"><a href="#__codelineno-0-1697">1697</a></span>
<span class="normal"><a href="#__codelineno-0-1698">1698</a></span>
<span class="normal"><a href="#__codelineno-0-1699">1699</a></span>
<span class="normal"><a href="#__codelineno-0-1700">1700</a></span>
<span class="normal"><a href="#__codelineno-0-1701">1701</a></span>
<span class="normal"><a href="#__codelineno-0-1702">1702</a></span>
<span class="normal"><a href="#__codelineno-0-1703">1703</a></span>
<span class="normal"><a href="#__codelineno-0-1704">1704</a></span>
<span class="normal"><a href="#__codelineno-0-1705">1705</a></span>
<span class="normal"><a href="#__codelineno-0-1706">1706</a></span>
<span class="normal"><a href="#__codelineno-0-1707">1707</a></span>
<span class="normal"><a href="#__codelineno-0-1708">1708</a></span>
<span class="normal"><a href="#__codelineno-0-1709">1709</a></span>
<span class="normal"><a href="#__codelineno-0-1710">1710</a></span>
<span class="normal"><a href="#__codelineno-0-1711">1711</a></span>
<span class="normal"><a href="#__codelineno-0-1712">1712</a></span>
<span class="normal"><a href="#__codelineno-0-1713">1713</a></span>
<span class="normal"><a href="#__codelineno-0-1714">1714</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1680" name="__codelineno-0-1680"></a><span class="k">def</span><span class="w"> </span><span class="nf">dd2xr</span><span class="p">(</span><span class="n">dd</span><span class="p">:</span> <span class="n">MeshgridDataDict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<a id="__codelineno-0-1681" name="__codelineno-0-1681"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;makes an xarray Dataset from a MeshgridDataDict.</span>
<a id="__codelineno-0-1682" name="__codelineno-0-1682"></a>
<a id="__codelineno-0-1683" name="__codelineno-0-1683"></a><span class="sd">    TODO: currently only supports &#39;regular&#39; grides, i.e., all axes</span>
<a id="__codelineno-0-1684" name="__codelineno-0-1684"></a><span class="sd">        are independet of each other, and can be represented by 1d arrays.</span>
<a id="__codelineno-0-1685" name="__codelineno-0-1685"></a><span class="sd">        For each axis, the first slice is used as coordinate values.</span>
<a id="__codelineno-0-1686" name="__codelineno-0-1686"></a>
<a id="__codelineno-0-1687" name="__codelineno-0-1687"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-1688" name="__codelineno-0-1688"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-1689" name="__codelineno-0-1689"></a><span class="sd">    dd : MeshgridDataDict</span>
<a id="__codelineno-0-1690" name="__codelineno-0-1690"></a><span class="sd">        input data</span>
<a id="__codelineno-0-1691" name="__codelineno-0-1691"></a>
<a id="__codelineno-0-1692" name="__codelineno-0-1692"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-1693" name="__codelineno-0-1693"></a><span class="sd">    -------</span>
<a id="__codelineno-0-1694" name="__codelineno-0-1694"></a><span class="sd">    xr.Dataset</span>
<a id="__codelineno-0-1695" name="__codelineno-0-1695"></a><span class="sd">        xarray Dataset</span>
<a id="__codelineno-0-1696" name="__codelineno-0-1696"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1697" name="__codelineno-0-1697"></a>    <span class="n">axes</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
<a id="__codelineno-0-1698" name="__codelineno-0-1698"></a>    <span class="n">coords</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1699" name="__codelineno-0-1699"></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axes</span><span class="p">):</span>
<a id="__codelineno-0-1700" name="__codelineno-0-1700"></a>        <span class="n">slices</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span>
<a id="__codelineno-0-1701" name="__codelineno-0-1701"></a>        <span class="n">slices</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-1702" name="__codelineno-0-1702"></a>        <span class="n">coords</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">dd</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">][</span><span class="nb">tuple</span><span class="p">(</span><span class="n">slices</span><span class="p">)]</span>
<a id="__codelineno-0-1703" name="__codelineno-0-1703"></a>
<a id="__codelineno-0-1704" name="__codelineno-0-1704"></a>    <span class="n">xds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span>
<a id="__codelineno-0-1705" name="__codelineno-0-1705"></a>        <span class="p">{</span><span class="n">d</span><span class="p">:</span> <span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">dd</span><span class="p">[</span><span class="n">d</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dd</span><span class="o">.</span><span class="n">dependents</span><span class="p">()},</span>
<a id="__codelineno-0-1706" name="__codelineno-0-1706"></a>        <span class="n">coords</span><span class="o">=</span><span class="n">coords</span><span class="p">,</span>
<a id="__codelineno-0-1707" name="__codelineno-0-1707"></a>    <span class="p">)</span>
<a id="__codelineno-0-1708" name="__codelineno-0-1708"></a>
<a id="__codelineno-0-1709" name="__codelineno-0-1709"></a>    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">xds</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
<a id="__codelineno-0-1710" name="__codelineno-0-1710"></a>        <span class="n">xds</span><span class="p">[</span><span class="n">d</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dd</span><span class="p">[</span><span class="n">d</span><span class="p">][</span><span class="s1">&#39;unit&#39;</span><span class="p">]</span>
<a id="__codelineno-0-1711" name="__codelineno-0-1711"></a>    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">xds</span><span class="o">.</span><span class="n">dims</span><span class="p">:</span>
<a id="__codelineno-0-1712" name="__codelineno-0-1712"></a>        <span class="n">xds</span><span class="p">[</span><span class="n">d</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dd</span><span class="p">[</span><span class="n">d</span><span class="p">][</span><span class="s1">&#39;unit&#39;</span><span class="p">]</span>
<a id="__codelineno-0-1713" name="__codelineno-0-1713"></a>
<a id="__codelineno-0-1714" name="__codelineno-0-1714"></a>    <span class="k">return</span> <span class="n">xds</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="labcore.data.datadict.guess_shape_from_datadict" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">guess_shape_from_datadict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Try to guess the shape of the datadict dependents from the axes values.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="labcore.data.datadict.DataDict" href="#labcore.data.datadict.DataDict">DataDict</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dataset to examine.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Union">Union</span>[None, <span title="typing.Tuple">Tuple</span>[<span title="typing.List">List</span>[str], <span title="typing.Tuple">Tuple</span>[int, ...]]]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary with the dependents as keys, and inferred shapes as values. Value is <code>None</code>, if the shape could not be inferred.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1253">1253</a></span>
<span class="normal"><a href="#__codelineno-0-1254">1254</a></span>
<span class="normal"><a href="#__codelineno-0-1255">1255</a></span>
<span class="normal"><a href="#__codelineno-0-1256">1256</a></span>
<span class="normal"><a href="#__codelineno-0-1257">1257</a></span>
<span class="normal"><a href="#__codelineno-0-1258">1258</a></span>
<span class="normal"><a href="#__codelineno-0-1259">1259</a></span>
<span class="normal"><a href="#__codelineno-0-1260">1260</a></span>
<span class="normal"><a href="#__codelineno-0-1261">1261</a></span>
<span class="normal"><a href="#__codelineno-0-1262">1262</a></span>
<span class="normal"><a href="#__codelineno-0-1263">1263</a></span>
<span class="normal"><a href="#__codelineno-0-1264">1264</a></span>
<span class="normal"><a href="#__codelineno-0-1265">1265</a></span>
<span class="normal"><a href="#__codelineno-0-1266">1266</a></span>
<span class="normal"><a href="#__codelineno-0-1267">1267</a></span>
<span class="normal"><a href="#__codelineno-0-1268">1268</a></span>
<span class="normal"><a href="#__codelineno-0-1269">1269</a></span>
<span class="normal"><a href="#__codelineno-0-1270">1270</a></span>
<span class="normal"><a href="#__codelineno-0-1271">1271</a></span>
<span class="normal"><a href="#__codelineno-0-1272">1272</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1253" name="__codelineno-0-1253"></a><span class="k">def</span><span class="w"> </span><span class="nf">guess_shape_from_datadict</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">DataDict</span><span class="p">)</span> <span class="o">-&gt;</span> \
<a id="__codelineno-0-1254" name="__codelineno-0-1254"></a>        <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]]]]:</span>
<a id="__codelineno-0-1255" name="__codelineno-0-1255"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1256" name="__codelineno-0-1256"></a><span class="sd">    Try to guess the shape of the datadict dependents from the axes values.</span>
<a id="__codelineno-0-1257" name="__codelineno-0-1257"></a>
<a id="__codelineno-0-1258" name="__codelineno-0-1258"></a><span class="sd">    :param data: Dataset to examine.</span>
<a id="__codelineno-0-1259" name="__codelineno-0-1259"></a><span class="sd">    :return: A dictionary with the dependents as keys, and inferred shapes as</span>
<a id="__codelineno-0-1260" name="__codelineno-0-1260"></a><span class="sd">             values. Value is ``None``, if the shape could not be inferred.</span>
<a id="__codelineno-0-1261" name="__codelineno-0-1261"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1262" name="__codelineno-0-1262"></a>
<a id="__codelineno-0-1263" name="__codelineno-0-1263"></a>    <span class="n">shapes</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1264" name="__codelineno-0-1264"></a>    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">dependents</span><span class="p">():</span>
<a id="__codelineno-0-1265" name="__codelineno-0-1265"></a>        <span class="n">axnames</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<a id="__codelineno-0-1266" name="__codelineno-0-1266"></a>        <span class="n">axes</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1267" name="__codelineno-0-1267"></a>        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">axnames</span><span class="p">:</span>
<a id="__codelineno-0-1268" name="__codelineno-0-1268"></a>            <span class="n">axdata</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">data_vals</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<a id="__codelineno-0-1269" name="__codelineno-0-1269"></a>            <span class="n">axes</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">axdata</span>
<a id="__codelineno-0-1270" name="__codelineno-0-1270"></a>        <span class="n">shapes</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="n">num</span><span class="o">.</span><span class="n">guess_grid_from_sweep_direction</span><span class="p">(</span><span class="o">**</span><span class="n">axes</span><span class="p">)</span>
<a id="__codelineno-0-1271" name="__codelineno-0-1271"></a>
<a id="__codelineno-0-1272" name="__codelineno-0-1272"></a>    <span class="k">return</span> <span class="n">shapes</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="labcore.data.datadict.is_meta_key" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">is_meta_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Checks if <code>key</code> is meta information.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>key</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The <code>key</code> we are checking.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p><code>True</code> if it is, <code>False</code> if it isn't.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="k">def</span><span class="w"> </span><span class="nf">is_meta_key</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Checks if ``key`` is meta information.</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">    :param key: The ``key`` we are checking.</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">    :return: ``True`` if it is, ``False`` if it isn&#39;t.</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>    <span class="k">if</span> <span class="n">key</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;__&#39;</span> <span class="ow">and</span> <span class="n">key</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span> <span class="o">==</span> <span class="s1">&#39;__&#39;</span><span class="p">:</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>        <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="labcore.data.datadict.meshgrid_to_datadict" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">meshgrid_to_datadict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Make a DataDict from a MeshgridDataDict by reshaping the data.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="labcore.data.datadict.MeshgridDataDict" href="#labcore.data.datadict.MeshgridDataDict">MeshgridDataDict</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Input <code>MeshgridDataDict</code>.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="labcore.data.datadict.DataDict" href="#labcore.data.datadict.DataDict">DataDict</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Flattened <code>DataDict</code>.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1354">1354</a></span>
<span class="normal"><a href="#__codelineno-0-1355">1355</a></span>
<span class="normal"><a href="#__codelineno-0-1356">1356</a></span>
<span class="normal"><a href="#__codelineno-0-1357">1357</a></span>
<span class="normal"><a href="#__codelineno-0-1358">1358</a></span>
<span class="normal"><a href="#__codelineno-0-1359">1359</a></span>
<span class="normal"><a href="#__codelineno-0-1360">1360</a></span>
<span class="normal"><a href="#__codelineno-0-1361">1361</a></span>
<span class="normal"><a href="#__codelineno-0-1362">1362</a></span>
<span class="normal"><a href="#__codelineno-0-1363">1363</a></span>
<span class="normal"><a href="#__codelineno-0-1364">1364</a></span>
<span class="normal"><a href="#__codelineno-0-1365">1365</a></span>
<span class="normal"><a href="#__codelineno-0-1366">1366</a></span>
<span class="normal"><a href="#__codelineno-0-1367">1367</a></span>
<span class="normal"><a href="#__codelineno-0-1368">1368</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1354" name="__codelineno-0-1354"></a><span class="k">def</span><span class="w"> </span><span class="nf">meshgrid_to_datadict</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">MeshgridDataDict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataDict</span><span class="p">:</span>
<a id="__codelineno-0-1355" name="__codelineno-0-1355"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1356" name="__codelineno-0-1356"></a><span class="sd">    Make a DataDict from a MeshgridDataDict by reshaping the data.</span>
<a id="__codelineno-0-1357" name="__codelineno-0-1357"></a>
<a id="__codelineno-0-1358" name="__codelineno-0-1358"></a><span class="sd">    :param data: Input ``MeshgridDataDict``.</span>
<a id="__codelineno-0-1359" name="__codelineno-0-1359"></a><span class="sd">    :return: Flattened ``DataDict``.</span>
<a id="__codelineno-0-1360" name="__codelineno-0-1360"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1361" name="__codelineno-0-1361"></a>    <span class="n">newdata</span> <span class="o">=</span> <span class="n">DataDict</span><span class="p">(</span><span class="o">**</span><span class="n">misc</span><span class="o">.</span><span class="n">unwrap_optional</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">structure</span><span class="p">(</span><span class="n">add_shape</span><span class="o">=</span><span class="kc">False</span><span class="p">)))</span>
<a id="__codelineno-0-1362" name="__codelineno-0-1362"></a>    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-1363" name="__codelineno-0-1363"></a>        <span class="n">val</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-1364" name="__codelineno-0-1364"></a>        <span class="n">newdata</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
<a id="__codelineno-0-1365" name="__codelineno-0-1365"></a>
<a id="__codelineno-0-1366" name="__codelineno-0-1366"></a>    <span class="n">newdata</span> <span class="o">=</span> <span class="n">newdata</span><span class="o">.</span><span class="n">sanitize</span><span class="p">()</span>
<a id="__codelineno-0-1367" name="__codelineno-0-1367"></a>    <span class="n">newdata</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
<a id="__codelineno-0-1368" name="__codelineno-0-1368"></a>    <span class="k">return</span> <span class="n">newdata</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="labcore.data.datadict.meta_key_to_name" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">meta_key_to_name</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Converts a meta data key to just the name.
E.g: for <code>key</code>: "<strong>meta</strong>" returns "meta"</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>key</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The key that is being converted</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the key.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="k">def</span><span class="w"> </span><span class="nf">meta_key_to_name</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">    Converts a meta data key to just the name.</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">    E.g: for ``key``: &quot;__meta__&quot; returns &quot;meta&quot;</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">    :param key: The key that is being converted</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">    :return: The name of the key.</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">    :raises: ``ValueError`` if the ``key`` is not a meta key.</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="k">if</span> <span class="n">is_meta_key</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>        <span class="k">return</span> <span class="n">key</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1"> is not a meta key.&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="labcore.data.datadict.meta_name_to_key" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">meta_name_to_key</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Converts <code>name</code> into a meta data key. E.g: "meta" gets converted to "<strong>meta</strong>"</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name that is being converted.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The meta data key based on <code>name</code>.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="k">def</span><span class="w"> </span><span class="nf">meta_name_to_key</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">    Converts ``name`` into a meta data key. E.g: &quot;meta&quot; gets converted to &quot;__meta__&quot;</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">    :param name: The name that is being converted.</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">    :return: The meta data key based on ``name``.</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="k">return</span> <span class="s1">&#39;__&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;__&#39;</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div><h3 id="datadict-storage_1">Datadict Storage</h3>


<div class="doc doc-object doc-module">



<a id="labcore.data.datadict_storage"></a>
  <div class="doc doc-contents first">
  
      <p>plottr.data.datadict_storage</p>
<p>Provides file-storage tools for the DataDict class.</p>
<p>.. note::
    Any function in this module that interacts with a ddh5 file, will create a lock file while it is using the file.
    The lock file has the following format: ~<file_name>.lock. The file lock will get deleted even if the program
    crashes. If the process is suddenly stopped however, we cannot guarantee that the file lock will be deleted.</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h2 id="labcore.data.datadict_storage.AppendMode" class="doc doc-heading">
          <code>AppendMode</code>


</h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="enum.Enum">Enum</span></code></p>

  
      <p>How/Whether to append data to existing data.</p>

            <details class="quote">
              <summary>Source code in <code>labcore/data/datadict_storage.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="k">class</span><span class="w"> </span><span class="nc">AppendMode</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;How/Whether to append data to existing data.&quot;&quot;&quot;</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="c1">#: Data that is additional compared to already existing data is appended.</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>    <span class="n">new</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="c1">#: All data is appended to existing data.</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="nb">all</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>    <span class="c1">#: Data is overwritten.</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="n">none</span> <span class="o">=</span> <span class="mi">2</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="labcore.data.datadict_storage.DDH5Writer" class="doc doc-heading">
          <code>DDH5Writer</code>


</h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code>object</code></p>

  
      <p>Context manager for writing data to DDH5.
Based on typical needs in taking data in an experimental physics lab.</p>
<p>Creates lock file when writing data.</p>
<p>Can be used in safe_write_mode to make sure the experiment and data will be saved even if the ddh5 is being used by
other programs. In this mode, the data is individually saved in files in a .tmp folder. When the experiment is
finished, the data is unified and saved in the original file.
If the data is correctly reconstructed, the .tmp folder is deleted. If not you can use the function unify_safe_write_data
to reconstruct the data.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>basedir</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, <span title="pathlib.Path">Path</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The root directory in which data is stored. :meth:<code>.create_file_structure</code> is creating the structure inside this root and determines the file name of the data. The default structure implemented here is <code>&lt;root&gt;/YYYY-MM-DD/YYYY-mm-dd_THHMMSS_&lt;ID&gt;-&lt;name&gt;/&lt;filename&gt;.ddh5</code>, where <ID> is a short identifier string and <name> is the value of parameter <code>name</code>. To change this, re-implement :meth:<code>.data_folder</code> and/or :meth:<code>.create_file_structure</code>.</p>
            </div>
          </td>
          <td>
                <code>&#39;.&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>datadict</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="labcore.data.datadict.DataDict" href="#labcore.data.datadict.DataDict">DataDict</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initial data object. Must contain at least the structure of the data to be able to use :meth:<code>add_data</code> to add data.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>groupname</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of the top-level group in the file container. An existing group of that name will be deleted.</p>
            </div>
          </td>
          <td>
                <code>&#39;data&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of this dataset. Used in path/file creation and added as meta data.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>filename</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Filename to use. Defaults to 'data.ddh5'.</p>
            </div>
          </td>
          <td>
                <code>&#39;data&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>file_timeout</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[float]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>How long the function will wait for the ddh5 file to unlock. If none uses the default value from the :class:<code>FileOpener</code>.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>safe_write_mode</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[bool]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, will save the data in the safe writing mode. Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

            <details class="quote">
              <summary>Source code in <code>labcore/data/datadict_storage.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span>
<span class="normal"><a href="#__codelineno-0-688">688</a></span>
<span class="normal"><a href="#__codelineno-0-689">689</a></span>
<span class="normal"><a href="#__codelineno-0-690">690</a></span>
<span class="normal"><a href="#__codelineno-0-691">691</a></span>
<span class="normal"><a href="#__codelineno-0-692">692</a></span>
<span class="normal"><a href="#__codelineno-0-693">693</a></span>
<span class="normal"><a href="#__codelineno-0-694">694</a></span>
<span class="normal"><a href="#__codelineno-0-695">695</a></span>
<span class="normal"><a href="#__codelineno-0-696">696</a></span>
<span class="normal"><a href="#__codelineno-0-697">697</a></span>
<span class="normal"><a href="#__codelineno-0-698">698</a></span>
<span class="normal"><a href="#__codelineno-0-699">699</a></span>
<span class="normal"><a href="#__codelineno-0-700">700</a></span>
<span class="normal"><a href="#__codelineno-0-701">701</a></span>
<span class="normal"><a href="#__codelineno-0-702">702</a></span>
<span class="normal"><a href="#__codelineno-0-703">703</a></span>
<span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span>
<span class="normal"><a href="#__codelineno-0-709">709</a></span>
<span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span>
<span class="normal"><a href="#__codelineno-0-716">716</a></span>
<span class="normal"><a href="#__codelineno-0-717">717</a></span>
<span class="normal"><a href="#__codelineno-0-718">718</a></span>
<span class="normal"><a href="#__codelineno-0-719">719</a></span>
<span class="normal"><a href="#__codelineno-0-720">720</a></span>
<span class="normal"><a href="#__codelineno-0-721">721</a></span>
<span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span>
<span class="normal"><a href="#__codelineno-0-725">725</a></span>
<span class="normal"><a href="#__codelineno-0-726">726</a></span>
<span class="normal"><a href="#__codelineno-0-727">727</a></span>
<span class="normal"><a href="#__codelineno-0-728">728</a></span>
<span class="normal"><a href="#__codelineno-0-729">729</a></span>
<span class="normal"><a href="#__codelineno-0-730">730</a></span>
<span class="normal"><a href="#__codelineno-0-731">731</a></span>
<span class="normal"><a href="#__codelineno-0-732">732</a></span>
<span class="normal"><a href="#__codelineno-0-733">733</a></span>
<span class="normal"><a href="#__codelineno-0-734">734</a></span>
<span class="normal"><a href="#__codelineno-0-735">735</a></span>
<span class="normal"><a href="#__codelineno-0-736">736</a></span>
<span class="normal"><a href="#__codelineno-0-737">737</a></span>
<span class="normal"><a href="#__codelineno-0-738">738</a></span>
<span class="normal"><a href="#__codelineno-0-739">739</a></span>
<span class="normal"><a href="#__codelineno-0-740">740</a></span>
<span class="normal"><a href="#__codelineno-0-741">741</a></span>
<span class="normal"><a href="#__codelineno-0-742">742</a></span>
<span class="normal"><a href="#__codelineno-0-743">743</a></span>
<span class="normal"><a href="#__codelineno-0-744">744</a></span>
<span class="normal"><a href="#__codelineno-0-745">745</a></span>
<span class="normal"><a href="#__codelineno-0-746">746</a></span>
<span class="normal"><a href="#__codelineno-0-747">747</a></span>
<span class="normal"><a href="#__codelineno-0-748">748</a></span>
<span class="normal"><a href="#__codelineno-0-749">749</a></span>
<span class="normal"><a href="#__codelineno-0-750">750</a></span>
<span class="normal"><a href="#__codelineno-0-751">751</a></span>
<span class="normal"><a href="#__codelineno-0-752">752</a></span>
<span class="normal"><a href="#__codelineno-0-753">753</a></span>
<span class="normal"><a href="#__codelineno-0-754">754</a></span>
<span class="normal"><a href="#__codelineno-0-755">755</a></span>
<span class="normal"><a href="#__codelineno-0-756">756</a></span>
<span class="normal"><a href="#__codelineno-0-757">757</a></span>
<span class="normal"><a href="#__codelineno-0-758">758</a></span>
<span class="normal"><a href="#__codelineno-0-759">759</a></span>
<span class="normal"><a href="#__codelineno-0-760">760</a></span>
<span class="normal"><a href="#__codelineno-0-761">761</a></span>
<span class="normal"><a href="#__codelineno-0-762">762</a></span>
<span class="normal"><a href="#__codelineno-0-763">763</a></span>
<span class="normal"><a href="#__codelineno-0-764">764</a></span>
<span class="normal"><a href="#__codelineno-0-765">765</a></span>
<span class="normal"><a href="#__codelineno-0-766">766</a></span>
<span class="normal"><a href="#__codelineno-0-767">767</a></span>
<span class="normal"><a href="#__codelineno-0-768">768</a></span>
<span class="normal"><a href="#__codelineno-0-769">769</a></span>
<span class="normal"><a href="#__codelineno-0-770">770</a></span>
<span class="normal"><a href="#__codelineno-0-771">771</a></span>
<span class="normal"><a href="#__codelineno-0-772">772</a></span>
<span class="normal"><a href="#__codelineno-0-773">773</a></span>
<span class="normal"><a href="#__codelineno-0-774">774</a></span>
<span class="normal"><a href="#__codelineno-0-775">775</a></span>
<span class="normal"><a href="#__codelineno-0-776">776</a></span>
<span class="normal"><a href="#__codelineno-0-777">777</a></span>
<span class="normal"><a href="#__codelineno-0-778">778</a></span>
<span class="normal"><a href="#__codelineno-0-779">779</a></span>
<span class="normal"><a href="#__codelineno-0-780">780</a></span>
<span class="normal"><a href="#__codelineno-0-781">781</a></span>
<span class="normal"><a href="#__codelineno-0-782">782</a></span>
<span class="normal"><a href="#__codelineno-0-783">783</a></span>
<span class="normal"><a href="#__codelineno-0-784">784</a></span>
<span class="normal"><a href="#__codelineno-0-785">785</a></span>
<span class="normal"><a href="#__codelineno-0-786">786</a></span>
<span class="normal"><a href="#__codelineno-0-787">787</a></span>
<span class="normal"><a href="#__codelineno-0-788">788</a></span>
<span class="normal"><a href="#__codelineno-0-789">789</a></span>
<span class="normal"><a href="#__codelineno-0-790">790</a></span>
<span class="normal"><a href="#__codelineno-0-791">791</a></span>
<span class="normal"><a href="#__codelineno-0-792">792</a></span>
<span class="normal"><a href="#__codelineno-0-793">793</a></span>
<span class="normal"><a href="#__codelineno-0-794">794</a></span>
<span class="normal"><a href="#__codelineno-0-795">795</a></span>
<span class="normal"><a href="#__codelineno-0-796">796</a></span>
<span class="normal"><a href="#__codelineno-0-797">797</a></span>
<span class="normal"><a href="#__codelineno-0-798">798</a></span>
<span class="normal"><a href="#__codelineno-0-799">799</a></span>
<span class="normal"><a href="#__codelineno-0-800">800</a></span>
<span class="normal"><a href="#__codelineno-0-801">801</a></span>
<span class="normal"><a href="#__codelineno-0-802">802</a></span>
<span class="normal"><a href="#__codelineno-0-803">803</a></span>
<span class="normal"><a href="#__codelineno-0-804">804</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-512" name="__codelineno-0-512"></a><span class="k">class</span><span class="w"> </span><span class="nc">DDH5Writer</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Context manager for writing data to DDH5.</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a><span class="sd">    Based on typical needs in taking data in an experimental physics lab.</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a><span class="sd">    Creates lock file when writing data.</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a><span class="sd">    Can be used in safe_write_mode to make sure the experiment and data will be saved even if the ddh5 is being used by</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a><span class="sd">    other programs. In this mode, the data is individually saved in files in a .tmp folder. When the experiment is</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a><span class="sd">    finished, the data is unified and saved in the original file.</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a><span class="sd">    If the data is correctly reconstructed, the .tmp folder is deleted. If not you can use the function unify_safe_write_data</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a><span class="sd">    to reconstruct the data.</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a><span class="sd">    :param basedir: The root directory in which data is stored.</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a><span class="sd">        :meth:`.create_file_structure` is creating the structure inside this root and</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a><span class="sd">        determines the file name of the data. The default structure implemented here is</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a><span class="sd">        ``&lt;root&gt;/YYYY-MM-DD/YYYY-mm-dd_THHMMSS_&lt;ID&gt;-&lt;name&gt;/&lt;filename&gt;.ddh5``,</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a><span class="sd">        where &lt;ID&gt; is a short identifier string and &lt;name&gt; is the value of parameter `name`.</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a><span class="sd">        To change this, re-implement :meth:`.data_folder` and/or</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a><span class="sd">        :meth:`.create_file_structure`.</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a><span class="sd">    :param datadict: Initial data object. Must contain at least the structure of the</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a><span class="sd">        data to be able to use :meth:`add_data` to add data.</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a><span class="sd">    :param groupname: Name of the top-level group in the file container. An existing</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a><span class="sd">        group of that name will be deleted.</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a><span class="sd">    :param name: Name of this dataset. Used in path/file creation and added as meta data.</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a><span class="sd">    :param filename: Filename to use. Defaults to &#39;data.ddh5&#39;.</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a><span class="sd">    :param file_timeout: How long the function will wait for the ddh5 file to unlock. If none uses the default</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a><span class="sd">        value from the :class:`FileOpener`.</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a><span class="sd">    :param safe_write_mode: If True, will save the data in the safe writing mode. Defaults to False.</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>    <span class="c1"># TODO: need an operation mode for not keeping data in memory.</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>    <span class="c1"># TODO: a mode for working with pre-allocated data</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>    <span class="c1"># Sets how many files before the writer creates a new folder in its safe writing mode</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>    <span class="n">n_files_per_dir</span> <span class="o">=</span> <span class="mi">1000</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>    <span class="c1"># Controls how often the writer reconstructs the data in its safe writing mode.</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>    <span class="c1"># It will reconstruct the data every `n_files_per_reconstruction` files or every `n_seconds_per_reconstruction`</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>    <span class="c1"># seconds, whichever comes first.</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>    <span class="n">n_files_per_reconstruction</span> <span class="o">=</span> <span class="mi">1000</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>    <span class="n">n_seconds_per_reconstruction</span> <span class="o">=</span> <span class="mi">10</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>        <span class="n">datadict</span><span class="p">:</span> <span class="n">DataDict</span><span class="p">,</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>        <span class="n">basedir</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>        <span class="n">groupname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;data&quot;</span><span class="p">,</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>        <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>        <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;data&quot;</span><span class="p">,</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>        <span class="n">filepath</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>        <span class="n">file_timeout</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>        <span class="n">safe_write_mode</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>    <span class="p">):</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Constructor for :class:`.DDH5Writer`&quot;&quot;&quot;</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">basedir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">basedir</span><span class="p">)</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">datadict</span> <span class="o">=</span> <span class="n">datadict</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>            <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">groupname</span> <span class="o">=</span> <span class="n">groupname</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a>        <span class="k">if</span> <span class="n">filepath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">filepath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">datadict</span><span class="o">.</span><span class="n">add_meta</span><span class="p">(</span><span class="s2">&quot;dataset.name&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">file_timeout</span> <span class="o">=</span> <span class="n">file_timeout</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">uuid</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid1</span><span class="p">()</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">safe_write_mode</span> <span class="o">=</span> <span class="n">safe_write_mode</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a>        <span class="c1"># Stores how many individual data files have been written for safe_write_mode</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_files</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_update_n_files</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_reconstruction_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DDH5Writer&quot;</span><span class="p">:</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filepath</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">filepath</span> <span class="o">=</span> <span class="n">_data_file_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_file_path</span><span class="p">(),</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data location: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a>        <span class="n">nrecords</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">datadict</span><span class="o">.</span><span class="n">nrecords</span><span class="p">()</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>        <span class="k">if</span> <span class="n">nrecords</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">nrecords</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a>            <span class="n">datadict_to_hdf5</span><span class="p">(</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">datadict</span><span class="p">,</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a>                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="p">),</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a>                <span class="n">groupname</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">groupname</span><span class="p">,</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a>                <span class="n">append_mode</span><span class="o">=</span><span class="n">AppendMode</span><span class="o">.</span><span class="n">none</span><span class="p">,</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>                <span class="n">file_timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_timeout</span><span class="p">,</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a>            <span class="p">)</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a>        <span class="k">return</span> <span class="bp">self</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__exit__</span><span class="p">(</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a>        <span class="n">exc_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="ne">BaseException</span><span class="p">]],</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a>        <span class="n">exc_value</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="ne">BaseException</span><span class="p">],</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a>        <span class="n">exc_traceback</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">TracebackType</span><span class="p">],</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">filepath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">safe_write_mode</span><span class="p">:</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Starting reconstruction of data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a>                <span class="n">dd</span> <span class="o">=</span> <span class="n">reconstruct_safe_write_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="p">,</span> <span class="n">file_timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_timeout</span><span class="p">)</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a>                <span class="c1"># Makes sure the reconstructed data matches the one in the .tmp folder</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a>                <span class="k">assert</span> <span class="n">datasets_are_equal</span><span class="p">(</span><span class="n">dd</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">datadict</span><span class="p">,</span> <span class="n">ignore_meta</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a>                <span class="n">datadict_to_hdf5</span><span class="p">(</span><span class="n">dd</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="p">,</span> <span class="n">groupname</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">groupname</span><span class="p">,</span> <span class="n">file_timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_timeout</span><span class="p">,</span> <span class="n">append_mode</span><span class="o">=</span><span class="n">AppendMode</span><span class="o">.</span><span class="n">none</span><span class="p">)</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a>                <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">&quot;.tmp&quot;</span><span class="p">)</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error while unifying data. Data should be located in the .tmp directory: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">add_tag</span><span class="p">(</span><span class="s2">&quot;__not_reconstructed__&quot;</span><span class="p">)</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a>                <span class="k">raise</span> <span class="n">e</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a>        <span class="k">with</span> <span class="n">FileOpener</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_timeout</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a>            <span class="n">add_cur_time_attr</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">require_group</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">groupname</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;close&quot;</span><span class="p">)</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a>        <span class="k">if</span> <span class="n">exc_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a>            <span class="c1"># exiting because the measurement is complete</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">add_tag</span><span class="p">(</span><span class="s2">&quot;__complete__&quot;</span><span class="p">)</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a>            <span class="c1"># exiting because of an exception</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">add_tag</span><span class="p">(</span><span class="s2">&quot;__interrupted__&quot;</span><span class="p">)</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">data_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the folder, relative to the data root path, in which data will</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a><span class="sd">        be saved.</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a><span class="sd">        Default format:</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a><span class="sd">        ``&lt;basedir&gt;/YYYY-MM-DD/YYYY-mm-ddTHHMMSS_&lt;ID&gt;-&lt;name&gt;``.</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a><span class="sd">        In this implementation we use the first 8 characters of a UUID as ID.</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a><span class="sd">        :returns: The folder path.</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a>        <span class="n">ID</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a>        <span class="n">parent</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">microsecond</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">ID</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a>            <span class="n">parent</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a>        <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">),</span> <span class="n">parent</span><span class="p">)</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a>        <span class="k">return</span> <span class="n">path</span>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">data_file_path</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Determine the filepath of the data file.</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a><span class="sd">        :returns: The filepath of the data file.</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a>        <span class="n">data_folder_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">basedir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_folder</span><span class="p">())</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a>        <span class="n">appendix</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a>        <span class="n">idx</span> <span class="o">=</span> <span class="mi">2</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a>        <span class="k">while</span> <span class="n">data_folder_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>            <span class="n">appendix</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;-</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a>            <span class="n">data_folder_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">basedir</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_folder</span><span class="p">())</span> <span class="o">+</span> <span class="n">appendix</span><span class="p">)</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>            <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a>        <span class="k">return</span> <span class="n">Path</span><span class="p">(</span><span class="n">data_folder_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_generate_next_safe_write_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a><span class="sd">        Generates the next path for the data to be saved in the safe writing mode. Should not be used for other things.</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a>        <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>        <span class="c1"># Creates tmp folder</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>        <span class="n">tmp_folder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">&quot;.tmp&quot;</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>        <span class="n">tmp_folder</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a>        <span class="c1"># Creates today folder</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>        <span class="n">today_folder</span> <span class="o">=</span> <span class="n">tmp_folder</span> <span class="o">/</span> <span class="n">now</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a>        <span class="n">today_folder</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a>        <span class="c1"># Creates hour folder</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a>        <span class="n">hour_folder</span> <span class="o">=</span> <span class="n">today_folder</span> <span class="o">/</span> <span class="n">now</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%H&quot;</span><span class="p">)</span>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a>        <span class="n">hour_folder</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a>        <span class="c1"># Creates minute folder</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a>        <span class="n">minute_folder</span> <span class="o">=</span> <span class="n">hour_folder</span> <span class="o">/</span> <span class="n">now</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%M&quot;</span><span class="p">)</span>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a>        <span class="n">minute_folder</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a>        <span class="n">n_secs</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a>        <span class="n">second_folder</span> <span class="o">=</span> <span class="n">minute_folder</span> <span class="o">/</span> <span class="p">(</span><span class="n">now</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%S&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;_#</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">n_secs</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a>        <span class="k">if</span> <span class="n">second_folder</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a>            <span class="n">n_data_files</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">second_folder</span><span class="o">.</span><span class="n">iterdir</span><span class="p">()))</span> <span class="o">+</span> <span class="mi">1</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a>            <span class="k">if</span> <span class="n">n_data_files</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_files_per_dir</span><span class="p">:</span>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a>                <span class="n">keep_searching</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a>                <span class="k">while</span> <span class="n">keep_searching</span><span class="p">:</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a>                    <span class="n">n_secs</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a>                    <span class="n">second_folder</span> <span class="o">=</span> <span class="n">minute_folder</span> <span class="o">/</span> <span class="p">(</span><span class="n">now</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%S&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;_#</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">n_secs</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">second_folder</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a>                        <span class="n">keep_searching</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a>                        <span class="n">second_folder</span><span class="o">.</span><span class="n">mkdir</span><span class="p">()</span>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a>                    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a>                        <span class="n">n_data_files</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">second_folder</span><span class="o">.</span><span class="n">iterdir</span><span class="p">()))</span> <span class="o">+</span> <span class="mi">1</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a>                        <span class="k">if</span> <span class="n">n_data_files</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_files_per_dir</span><span class="p">:</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a>                            <span class="n">keep_searching</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a>        <span class="c1"># Creates the filename that follows the structure: yyyy-mm-dd-HHMM-SS#_#&lt;total_number_of_files&gt;.ddh5</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a>        <span class="n">filename</span> <span class="o">=</span> <span class="n">now</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">-%H_%M_%S&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;_</span><span class="si">{</span><span class="n">n_secs</span><span class="si">}</span><span class="s2">_#</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_files</span><span class="si">}</span><span class="s2">.ddh5&quot;</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_files</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a>        <span class="k">return</span> <span class="n">second_folder</span><span class="o">/</span><span class="n">filename</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Add data to the file (and the internal `DataDict`).</span>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a><span class="sd">        Requires one keyword argument per data field in the `DataDict`, with</span>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a><span class="sd">        the key being the name, and value the data to add. It is required that</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a><span class="sd">        all added data has the same number of &#39;rows&#39;, i.e., the most outer dimension</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a><span class="sd">        has to match for data to be inserted faithfully.</span>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a><span class="sd">        If some data is scalar and others are not, then the data should be reshaped</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a><span class="sd">        to (1, ) for the scalar data, and (1, ...) for the others; in other words,</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a><span class="sd">        an outer dimension with length 1 is added for all.</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">datadict</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">safe_write_mode</span><span class="p">:</span>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a>            <span class="n">clean_dd_copy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">datadict</span><span class="o">.</span><span class="n">structure</span><span class="p">()</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a>            <span class="n">clean_dd_copy</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a>            <span class="n">filepath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_next_safe_write_path</span><span class="p">()</span>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a>            <span class="n">datadict_to_hdf5</span><span class="p">(</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a>                <span class="n">clean_dd_copy</span><span class="p">,</span>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a>                <span class="n">filepath</span><span class="p">,</span>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a>                <span class="n">groupname</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">groupname</span><span class="p">,</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a>                <span class="n">append_mode</span><span class="o">=</span><span class="n">AppendMode</span><span class="o">.</span><span class="n">new</span><span class="p">,</span>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a>                <span class="n">file_timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_timeout</span><span class="p">,</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a>            <span class="p">)</span>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a>            <span class="n">delta_t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_reconstruction_time</span>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a>            <span class="c1"># Reconstructs the data every n_files_per_reconstruction files or every n_seconds_per_reconstruction seconds</span>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a>            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_files</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_update_n_files</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_files_per_reconstruction</span> <span class="ow">or</span>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a>                    <span class="n">delta_t</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_seconds_per_reconstruction</span><span class="p">):</span>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a>                <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a>                    <span class="n">dd</span> <span class="o">=</span> <span class="n">reconstruct_safe_write_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="p">,</span> <span class="n">unification_from_scratch</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a>                                                     <span class="n">file_timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_timeout</span><span class="p">)</span>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a>                    <span class="n">datadict_to_hdf5</span><span class="p">(</span><span class="n">dd</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="p">,</span> <span class="n">groupname</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">groupname</span><span class="p">,</span> <span class="n">file_timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_timeout</span><span class="p">,</span> <span class="n">append_mode</span><span class="o">=</span><span class="n">AppendMode</span><span class="o">.</span><span class="n">none</span><span class="p">)</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a>                <span class="k">except</span> <span class="ne">RuntimeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error while unifying data: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">Data is still getting saved in .tmp directory.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a>                <span class="k">with</span> <span class="n">FileOpener</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_timeout</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a>                    <span class="n">add_cur_time_attr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;last_change&quot;</span><span class="p">)</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a>                    <span class="n">add_cur_time_attr</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">groupname</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;last_change&quot;</span><span class="p">)</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a>                <span class="c1"># Even if I fail at reconstruction, I want to wait the same amount as if it was successful to try again.</span>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">last_reconstruction_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">last_update_n_files</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_files</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a>            <span class="n">nrecords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">datadict</span><span class="o">.</span><span class="n">nrecords</span><span class="p">()</span>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a>            <span class="k">if</span> <span class="n">nrecords</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">nrecords</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a>                <span class="n">datadict_to_hdf5</span><span class="p">(</span>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">datadict</span><span class="p">,</span>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a>                    <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="p">),</span>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a>                    <span class="n">groupname</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">groupname</span><span class="p">,</span>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a>                    <span class="n">file_timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_timeout</span><span class="p">,</span>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a>                <span class="p">)</span>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a>                <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">filepath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a>                <span class="k">with</span> <span class="n">FileOpener</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_timeout</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a>                    <span class="n">add_cur_time_attr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;last_change&quot;</span><span class="p">)</span>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a>                    <span class="n">add_cur_time_attr</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">groupname</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;last_change&quot;</span><span class="p">)</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a>    <span class="c1"># convenience methods for saving things in the same directory as the ddh5 file</span>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_tag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tags</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a>        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">filepath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tags</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a>            <span class="n">tags</span> <span class="o">=</span> <span class="p">[</span><span class="n">tags</span><span class="p">]</span>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a>        <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">tags</span><span class="p">:</span>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a>            <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tag</span><span class="si">}</span><span class="s2">.tag&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">backup_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">paths</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a>        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">filepath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">paths</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a>            <span class="n">paths</span> <span class="o">=</span> <span class="p">[</span><span class="n">paths</span><span class="p">]</span>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a>        <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">:</span>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a>            <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">save_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a>        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">filepath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="n">name</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a>            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">save_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a>        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">filepath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-803" name="__codelineno-0-803"></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="n">name</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-804" name="__codelineno-0-804"></a>            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">ensure_ascii</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">NumpyEncoder</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict_storage.DDH5Writer.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">datadict</span><span class="p">,</span> <span class="n">basedir</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">groupname</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">filepath</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">file_timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">safe_write_mode</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Constructor for :class:<code>.DDH5Writer</code></p>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict_storage.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-555" name="__codelineno-0-555"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>    <span class="n">datadict</span><span class="p">:</span> <span class="n">DataDict</span><span class="p">,</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>    <span class="n">basedir</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>    <span class="n">groupname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;data&quot;</span><span class="p">,</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>    <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>    <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;data&quot;</span><span class="p">,</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>    <span class="n">filepath</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>    <span class="n">file_timeout</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>    <span class="n">safe_write_mode</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a><span class="p">):</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Constructor for :class:`.DDH5Writer`&quot;&quot;&quot;</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">basedir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">basedir</span><span class="p">)</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">datadict</span> <span class="o">=</span> <span class="n">datadict</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>    <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">groupname</span> <span class="o">=</span> <span class="n">groupname</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a>    <span class="k">if</span> <span class="n">filepath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">filepath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">datadict</span><span class="o">.</span><span class="n">add_meta</span><span class="p">(</span><span class="s2">&quot;dataset.name&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">file_timeout</span> <span class="o">=</span> <span class="n">file_timeout</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">uuid</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid1</span><span class="p">()</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">safe_write_mode</span> <span class="o">=</span> <span class="n">safe_write_mode</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a>    <span class="c1"># Stores how many individual data files have been written for safe_write_mode</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">n_files</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">last_update_n_files</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">last_reconstruction_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict_storage.DDH5Writer.add_data" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">add_data</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Add data to the file (and the internal <code>DataDict</code>).</p>
<p>Requires one keyword argument per data field in the <code>DataDict</code>, with
the key being the name, and value the data to add. It is required that
all added data has the same number of 'rows', i.e., the most outer dimension
has to match for data to be inserted faithfully.
If some data is scalar and others are not, then the data should be reshaped
to (1, ) for the scalar data, and (1, ...) for the others; in other words,
an outer dimension with length 1 is added for all.</p>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict_storage.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-719">719</a></span>
<span class="normal"><a href="#__codelineno-0-720">720</a></span>
<span class="normal"><a href="#__codelineno-0-721">721</a></span>
<span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span>
<span class="normal"><a href="#__codelineno-0-725">725</a></span>
<span class="normal"><a href="#__codelineno-0-726">726</a></span>
<span class="normal"><a href="#__codelineno-0-727">727</a></span>
<span class="normal"><a href="#__codelineno-0-728">728</a></span>
<span class="normal"><a href="#__codelineno-0-729">729</a></span>
<span class="normal"><a href="#__codelineno-0-730">730</a></span>
<span class="normal"><a href="#__codelineno-0-731">731</a></span>
<span class="normal"><a href="#__codelineno-0-732">732</a></span>
<span class="normal"><a href="#__codelineno-0-733">733</a></span>
<span class="normal"><a href="#__codelineno-0-734">734</a></span>
<span class="normal"><a href="#__codelineno-0-735">735</a></span>
<span class="normal"><a href="#__codelineno-0-736">736</a></span>
<span class="normal"><a href="#__codelineno-0-737">737</a></span>
<span class="normal"><a href="#__codelineno-0-738">738</a></span>
<span class="normal"><a href="#__codelineno-0-739">739</a></span>
<span class="normal"><a href="#__codelineno-0-740">740</a></span>
<span class="normal"><a href="#__codelineno-0-741">741</a></span>
<span class="normal"><a href="#__codelineno-0-742">742</a></span>
<span class="normal"><a href="#__codelineno-0-743">743</a></span>
<span class="normal"><a href="#__codelineno-0-744">744</a></span>
<span class="normal"><a href="#__codelineno-0-745">745</a></span>
<span class="normal"><a href="#__codelineno-0-746">746</a></span>
<span class="normal"><a href="#__codelineno-0-747">747</a></span>
<span class="normal"><a href="#__codelineno-0-748">748</a></span>
<span class="normal"><a href="#__codelineno-0-749">749</a></span>
<span class="normal"><a href="#__codelineno-0-750">750</a></span>
<span class="normal"><a href="#__codelineno-0-751">751</a></span>
<span class="normal"><a href="#__codelineno-0-752">752</a></span>
<span class="normal"><a href="#__codelineno-0-753">753</a></span>
<span class="normal"><a href="#__codelineno-0-754">754</a></span>
<span class="normal"><a href="#__codelineno-0-755">755</a></span>
<span class="normal"><a href="#__codelineno-0-756">756</a></span>
<span class="normal"><a href="#__codelineno-0-757">757</a></span>
<span class="normal"><a href="#__codelineno-0-758">758</a></span>
<span class="normal"><a href="#__codelineno-0-759">759</a></span>
<span class="normal"><a href="#__codelineno-0-760">760</a></span>
<span class="normal"><a href="#__codelineno-0-761">761</a></span>
<span class="normal"><a href="#__codelineno-0-762">762</a></span>
<span class="normal"><a href="#__codelineno-0-763">763</a></span>
<span class="normal"><a href="#__codelineno-0-764">764</a></span>
<span class="normal"><a href="#__codelineno-0-765">765</a></span>
<span class="normal"><a href="#__codelineno-0-766">766</a></span>
<span class="normal"><a href="#__codelineno-0-767">767</a></span>
<span class="normal"><a href="#__codelineno-0-768">768</a></span>
<span class="normal"><a href="#__codelineno-0-769">769</a></span>
<span class="normal"><a href="#__codelineno-0-770">770</a></span>
<span class="normal"><a href="#__codelineno-0-771">771</a></span>
<span class="normal"><a href="#__codelineno-0-772">772</a></span>
<span class="normal"><a href="#__codelineno-0-773">773</a></span>
<span class="normal"><a href="#__codelineno-0-774">774</a></span>
<span class="normal"><a href="#__codelineno-0-775">775</a></span>
<span class="normal"><a href="#__codelineno-0-776">776</a></span>
<span class="normal"><a href="#__codelineno-0-777">777</a></span>
<span class="normal"><a href="#__codelineno-0-778">778</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-719" name="__codelineno-0-719"></a><span class="k">def</span><span class="w"> </span><span class="nf">add_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Add data to the file (and the internal `DataDict`).</span>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a><span class="sd">    Requires one keyword argument per data field in the `DataDict`, with</span>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a><span class="sd">    the key being the name, and value the data to add. It is required that</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a><span class="sd">    all added data has the same number of &#39;rows&#39;, i.e., the most outer dimension</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a><span class="sd">    has to match for data to be inserted faithfully.</span>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a><span class="sd">    If some data is scalar and others are not, then the data should be reshaped</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a><span class="sd">    to (1, ) for the scalar data, and (1, ...) for the others; in other words,</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a><span class="sd">    an outer dimension with length 1 is added for all.</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">datadict</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">safe_write_mode</span><span class="p">:</span>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a>        <span class="n">clean_dd_copy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">datadict</span><span class="o">.</span><span class="n">structure</span><span class="p">()</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a>        <span class="n">clean_dd_copy</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a>        <span class="n">filepath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_next_safe_write_path</span><span class="p">()</span>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a>        <span class="n">datadict_to_hdf5</span><span class="p">(</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a>            <span class="n">clean_dd_copy</span><span class="p">,</span>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a>            <span class="n">filepath</span><span class="p">,</span>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a>            <span class="n">groupname</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">groupname</span><span class="p">,</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a>            <span class="n">append_mode</span><span class="o">=</span><span class="n">AppendMode</span><span class="o">.</span><span class="n">new</span><span class="p">,</span>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a>            <span class="n">file_timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_timeout</span><span class="p">,</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a>        <span class="p">)</span>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a>        <span class="n">delta_t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_reconstruction_time</span>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a>        <span class="c1"># Reconstructs the data every n_files_per_reconstruction files or every n_seconds_per_reconstruction seconds</span>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a>        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_files</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_update_n_files</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_files_per_reconstruction</span> <span class="ow">or</span>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a>                <span class="n">delta_t</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_seconds_per_reconstruction</span><span class="p">):</span>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a>                <span class="n">dd</span> <span class="o">=</span> <span class="n">reconstruct_safe_write_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="p">,</span> <span class="n">unification_from_scratch</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a>                                                 <span class="n">file_timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_timeout</span><span class="p">)</span>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a>                <span class="n">datadict_to_hdf5</span><span class="p">(</span><span class="n">dd</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="p">,</span> <span class="n">groupname</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">groupname</span><span class="p">,</span> <span class="n">file_timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_timeout</span><span class="p">,</span> <span class="n">append_mode</span><span class="o">=</span><span class="n">AppendMode</span><span class="o">.</span><span class="n">none</span><span class="p">)</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a>            <span class="k">except</span> <span class="ne">RuntimeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error while unifying data: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">Data is still getting saved in .tmp directory.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a>            <span class="k">with</span> <span class="n">FileOpener</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_timeout</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a>                <span class="n">add_cur_time_attr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;last_change&quot;</span><span class="p">)</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a>                <span class="n">add_cur_time_attr</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">groupname</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;last_change&quot;</span><span class="p">)</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a>            <span class="c1"># Even if I fail at reconstruction, I want to wait the same amount as if it was successful to try again.</span>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">last_reconstruction_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">last_update_n_files</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_files</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a>        <span class="n">nrecords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">datadict</span><span class="o">.</span><span class="n">nrecords</span><span class="p">()</span>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a>        <span class="k">if</span> <span class="n">nrecords</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">nrecords</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a>            <span class="n">datadict_to_hdf5</span><span class="p">(</span>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">datadict</span><span class="p">,</span>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a>                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="p">),</span>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a>                <span class="n">groupname</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">groupname</span><span class="p">,</span>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a>                <span class="n">file_timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_timeout</span><span class="p">,</span>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a>            <span class="p">)</span>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a>            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">filepath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a>            <span class="k">with</span> <span class="n">FileOpener</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_timeout</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a>                <span class="n">add_cur_time_attr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;last_change&quot;</span><span class="p">)</span>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a>                <span class="n">add_cur_time_attr</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">groupname</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;last_change&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict_storage.DDH5Writer.data_file_path" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">data_file_path</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Determine the filepath of the data file.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The filepath of the data file.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict_storage.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-658" name="__codelineno-0-658"></a><span class="k">def</span><span class="w"> </span><span class="nf">data_file_path</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Determine the filepath of the data file.</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a><span class="sd">    :returns: The filepath of the data file.</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a>    <span class="n">data_folder_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">basedir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_folder</span><span class="p">())</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a>    <span class="n">appendix</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a>    <span class="n">idx</span> <span class="o">=</span> <span class="mi">2</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a>    <span class="k">while</span> <span class="n">data_folder_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>        <span class="n">appendix</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;-</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a>        <span class="n">data_folder_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">basedir</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_folder</span><span class="p">())</span> <span class="o">+</span> <span class="n">appendix</span><span class="p">)</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>        <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a>    <span class="k">return</span> <span class="n">Path</span><span class="p">(</span><span class="n">data_folder_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="labcore.data.datadict_storage.DDH5Writer.data_folder" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">data_folder</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Return the folder, relative to the data root path, in which data will
be saved.</p>
<p>Default format:
<code>&lt;basedir&gt;/YYYY-MM-DD/YYYY-mm-ddTHHMMSS_&lt;ID&gt;-&lt;name&gt;</code>.
In this implementation we use the first 8 characters of a UUID as ID.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The folder path.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict_storage.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-641" name="__codelineno-0-641"></a><span class="k">def</span><span class="w"> </span><span class="nf">data_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the folder, relative to the data root path, in which data will</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a><span class="sd">    be saved.</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a><span class="sd">    Default format:</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a><span class="sd">    ``&lt;basedir&gt;/YYYY-MM-DD/YYYY-mm-ddTHHMMSS_&lt;ID&gt;-&lt;name&gt;``.</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a><span class="sd">    In this implementation we use the first 8 characters of a UUID as ID.</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a><span class="sd">    :returns: The folder path.</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a>    <span class="n">ID</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a>    <span class="n">parent</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">microsecond</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">ID</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a>        <span class="n">parent</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a>    <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">),</span> <span class="n">parent</span><span class="p">)</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a>    <span class="k">return</span> <span class="n">path</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="labcore.data.datadict_storage.FileOpener" class="doc doc-heading">
          <code>FileOpener</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>Context manager for opening files, creates its own file lock to indicate other programs that the file is being
used. The lock file follows the following structure: "~<file_name>.lock".</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>path</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="pathlib.Path">Path</span>, str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The file path.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>mode</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The opening file mode. Only the following modes are supported: 'r', 'w', 'w-', 'a'. Defaults to 'r'.</p>
            </div>
          </td>
          <td>
                <code>&#39;r&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>timeout</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[float]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Time, in seconds, the context manager waits for the file to unlock. Defaults to 30.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>test_delay</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Length of time in between checks. I.e. how long the FileOpener waits to see if a file got unlocked again</p>
            </div>
          </td>
          <td>
                <code>0.1</code>
          </td>
        </tr>
    </tbody>
  </table>

            <details class="quote">
              <summary>Source code in <code>labcore/data/datadict_storage.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="k">class</span><span class="w"> </span><span class="nc">FileOpener</span><span class="p">:</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a><span class="sd">    Context manager for opening files, creates its own file lock to indicate other programs that the file is being</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a><span class="sd">    used. The lock file follows the following structure: &quot;~&lt;file_name&gt;.lock&quot;.</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a><span class="sd">    :param path: The file path.</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a><span class="sd">    :param mode: The opening file mode. Only the following modes are supported: &#39;r&#39;, &#39;w&#39;, &#39;w-&#39;, &#39;a&#39;. Defaults to &#39;r&#39;.</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a><span class="sd">    :param timeout: Time, in seconds, the context manager waits for the file to unlock. Defaults to 30.</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a><span class="sd">    :param test_delay: Length of time in between checks. I.e. how long the FileOpener waits to see if a file got</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a><span class="sd">        unlocked again</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>        <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>        <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>        <span class="n">timeout</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>        <span class="n">test_delay</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>    <span class="p">):</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lock_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s2">&quot;~&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">stem</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.lock&quot;</span><span class="p">)</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;w-&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Only &#39;r&#39;, &#39;w&#39;, &#39;w-&#39;, &#39;a&#39; modes are supported.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">default_timeout</span> <span class="o">=</span> <span class="mf">300.0</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>        <span class="k">if</span> <span class="n">timeout</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_timeout</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span> <span class="o">=</span> <span class="n">timeout</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">test_delay</span> <span class="o">=</span> <span class="n">test_delay</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">:</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">open_when_unlocked</span><span class="p">()</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__exit__</span><span class="p">(</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>        <span class="n">exc_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="ne">BaseException</span><span class="p">]],</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>        <span class="n">exc_value</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="ne">BaseException</span><span class="p">],</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>        <span class="n">exc_traceback</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">TracebackType</span><span class="p">],</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>        <span class="k">finally</span><span class="p">:</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lock_path</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">lock_path</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">open_when_unlocked</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">:</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">lock_path</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>                <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">lock_path</span><span class="o">.</span><span class="n">touch</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>                <span class="c1"># This happens if some other process beat this one and created the file beforehand</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>                <span class="k">except</span> <span class="ne">FileExistsError</span><span class="p">:</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>                    <span class="k">continue</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>                    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>                        <span class="n">f</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">)</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>                        <span class="k">return</span> <span class="n">f</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>                    <span class="k">except</span> <span class="p">(</span><span class="ne">OSError</span><span class="p">,</span> <span class="ne">PermissionError</span><span class="p">,</span> <span class="ne">RuntimeError</span><span class="p">):</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>                        <span class="k">pass</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>                    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">test_delay</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>                    <span class="p">)</span>  <span class="c1"># don&#39;t overwhelm the FS by very fast repeated calls.</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>                    <span class="k">if</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span><span class="p">:</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>                        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Waiting or file unlock timeout&quot;</span><span class="p">)</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">test_delay</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>            <span class="p">)</span>  <span class="c1"># don&#39;t overwhelm the FS by very fast repeated calls.</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>            <span class="k">if</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span><span class="p">:</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Lock file remained for longer than timeout time&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>



<div class="doc doc-object doc-function">




<h2 id="labcore.data.datadict_storage.add_cur_time_attr" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">add_cur_time_attr</span><span class="p">(</span><span class="n">h5obj</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;creation&#39;</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;__&#39;</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;__&#39;</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Add current time information to the given HDF5 object, following the format of:
<code>&lt;prefix&gt;&lt;name&gt;_time_sec&lt;suffix&gt;</code>.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>h5obj</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The HDF5 object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the attribute.</p>
            </div>
          </td>
          <td>
                <code>&#39;creation&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>prefix</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Prefix of the attribute.</p>
            </div>
          </td>
          <td>
                <code>&#39;__&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>suffix</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Suffix of the attribute.</p>
            </div>
          </td>
          <td>
                <code>&#39;__&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict_storage.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="k">def</span><span class="w"> </span><span class="nf">add_cur_time_attr</span><span class="p">(</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>    <span class="n">h5obj</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;creation&quot;</span><span class="p">,</span> <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;__&quot;</span><span class="p">,</span> <span class="n">suffix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;__&quot;</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Add current time information to the given HDF5 object, following the format of:</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">    ``&lt;prefix&gt;&lt;name&gt;_time_sec&lt;suffix&gt;``.</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">    :param h5obj: The HDF5 object.</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">    :param name: The name of the attribute.</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">    :param prefix: Prefix of the attribute.</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">    :param suffix: Suffix of the attribute.</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>    <span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">localtime</span><span class="p">()</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>    <span class="n">tsec</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">mktime</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>    <span class="n">tstr</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">TIMESTRFORMAT</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>    <span class="n">set_attr</span><span class="p">(</span><span class="n">h5obj</span><span class="p">,</span> <span class="n">prefix</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_time_sec&quot;</span> <span class="o">+</span> <span class="n">suffix</span><span class="p">,</span> <span class="n">tsec</span><span class="p">)</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>    <span class="n">set_attr</span><span class="p">(</span><span class="n">h5obj</span><span class="p">,</span> <span class="n">prefix</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_time_str&quot;</span> <span class="o">+</span> <span class="n">suffix</span><span class="p">,</span> <span class="n">tstr</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="labcore.data.datadict_storage.all_datadicts_from_hdf5" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">all_datadicts_from_hdf5</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">file_timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Loads all the DataDicts contained on a single HDF5 file. Returns a dictionary with the group names as keys and
the DataDicts as the values of that key.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>path</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, <span title="pathlib.Path">Path</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path of the HDF5 file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>file_timeout</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[float]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>How long the function will wait for the ddh5 file to unlock. If none uses the default value from the :class:<code>FileOpener</code>.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with group names as key, and the DataDicts inside them as values.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict_storage.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="k">def</span><span class="w"> </span><span class="nf">all_datadicts_from_hdf5</span><span class="p">(</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>    <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span> <span class="n">file_timeout</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="sd">    Loads all the DataDicts contained on a single HDF5 file. Returns a dictionary with the group names as keys and</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a><span class="sd">    the DataDicts as the values of that key.</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a><span class="sd">    :param path: The path of the HDF5 file.</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a><span class="sd">    :param file_timeout: How long the function will wait for the ddh5 file to unlock. If none uses the default</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a><span class="sd">        value from the :class:`FileOpener`.</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a><span class="sd">    :return: Dictionary with group names as key, and the DataDicts inside them as values.</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>    <span class="n">filepath</span> <span class="o">=</span> <span class="n">_data_file_path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filepath</span><span class="p">):</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Specified file does not exist.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>    <span class="n">ret</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>    <span class="k">with</span> <span class="n">FileOpener</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">file_timeout</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>        <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>        <span class="n">ret</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">datadict_from_hdf5</span><span class="p">(</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>            <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="n">groupname</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="n">file_timeout</span><span class="o">=</span><span class="n">file_timeout</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>        <span class="p">)</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>    <span class="k">return</span> <span class="n">ret</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="labcore.data.datadict_storage.datadict_from_hdf5" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">datadict_from_hdf5</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">groupname</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">startidx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stopidx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">structure_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ignore_unequal_lengths</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">file_timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Load a DataDict from file.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>path</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, <span title="pathlib.Path">Path</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Full filepath without the file extension.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>groupname</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of hdf5 group.</p>
            </div>
          </td>
          <td>
                <code>&#39;data&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>startidx</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[int, None]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Start row.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>stopidx</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[int, None]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>End row + 1.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>structure_only</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>True</code>, don't load the data values.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>ignore_unequal_lengths</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>True</code>, don't fail when the rows have unequal length; will return the longest consistent DataDict possible.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>file_timeout</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[float]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>How long the function will wait for the ddh5 file to unlock. If none uses the default value from the :class:<code>FileOpener</code>.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="labcore.data.datadict.DataDict" href="#labcore.data.datadict.DataDict">DataDict</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Validated DataDict.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict_storage.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="k">def</span><span class="w"> </span><span class="nf">datadict_from_hdf5</span><span class="p">(</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>    <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>    <span class="n">groupname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;data&quot;</span><span class="p">,</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>    <span class="n">startidx</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>    <span class="n">stopidx</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>    <span class="n">structure_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>    <span class="n">ignore_unequal_lengths</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>    <span class="n">file_timeout</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataDict</span><span class="p">:</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Load a DataDict from file.</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="sd">    :param path: Full filepath without the file extension.</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="sd">    :param groupname: Name of hdf5 group.</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="sd">    :param startidx: Start row.</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a><span class="sd">    :param stopidx: End row + 1.</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="sd">    :param structure_only: If `True`, don&#39;t load the data values.</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="sd">    :param ignore_unequal_lengths: If `True`, don&#39;t fail when the rows have</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="sd">        unequal length; will return the longest consistent DataDict possible.</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="sd">    :param file_timeout: How long the function will wait for the ddh5 file to unlock. If none uses the default</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="sd">        value from the :class:`FileOpener`.</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="sd">    :return: Validated DataDict.</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>    <span class="n">filepath</span> <span class="o">=</span> <span class="n">_data_file_path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">filepath</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Specified file &#39;</span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2">&#39; does not exist.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>    <span class="k">if</span> <span class="n">startidx</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>        <span class="n">startidx</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>    <span class="n">res</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>    <span class="k">with</span> <span class="n">FileOpener</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">file_timeout</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>        <span class="k">if</span> <span class="n">groupname</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Group does not exist.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>        <span class="n">grp</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="n">groupname</span><span class="p">]</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>        <span class="n">keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">grp</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>        <span class="n">lens</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">grp</span><span class="p">[</span><span class="n">k</span><span class="p">][:])</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">]</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">lens</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">ignore_unequal_lengths</span><span class="p">:</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Unequal lengths in the datasets.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>            <span class="k">if</span> <span class="n">stopidx</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">stopidx</span> <span class="o">&gt;</span> <span class="nb">min</span><span class="p">(</span><span class="n">lens</span><span class="p">):</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>                <span class="n">stopidx</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">lens</span><span class="p">)</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>            <span class="k">if</span> <span class="n">stopidx</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">stopidx</span> <span class="o">&gt;</span> <span class="n">lens</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>                <span class="n">stopidx</span> <span class="o">=</span> <span class="n">lens</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">grp</span><span class="o">.</span><span class="n">attrs</span><span class="p">:</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>            <span class="k">if</span> <span class="n">is_meta_key</span><span class="p">(</span><span class="n">attr</span><span class="p">):</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>                <span class="n">res</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="n">deh5ify</span><span class="p">(</span><span class="n">grp</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="n">attr</span><span class="p">])</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>            <span class="n">ds</span> <span class="o">=</span> <span class="n">grp</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>            <span class="n">entry</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">Collection</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>                <span class="n">values</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>            <span class="p">)</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>            <span class="k">if</span> <span class="s2">&quot;axes&quot;</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">attrs</span><span class="p">:</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>                <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;axes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">deh5ify</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;axes&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>                <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;axes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>            <span class="k">if</span> <span class="s2">&quot;unit&quot;</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">attrs</span><span class="p">:</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>                <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;unit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">deh5ify</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;unit&quot;</span><span class="p">])</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">structure_only</span><span class="p">:</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>                <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;values&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="n">startidx</span><span class="p">:</span><span class="n">stopidx</span><span class="p">]</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>            <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;__shape__&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[:]</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>            <span class="c1"># and now the meta data</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>            <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">attrs</span><span class="p">:</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>                <span class="k">if</span> <span class="n">is_meta_key</span><span class="p">(</span><span class="n">attr</span><span class="p">):</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>                    <span class="n">_val</span> <span class="o">=</span> <span class="n">deh5ify</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="n">attr</span><span class="p">])</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>                    <span class="n">entry</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="n">deh5ify</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="n">attr</span><span class="p">])</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>            <span class="n">res</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">entry</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>    <span class="n">dd</span> <span class="o">=</span> <span class="n">DataDict</span><span class="p">(</span><span class="o">**</span><span class="n">res</span><span class="p">)</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>    <span class="n">dd</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>    <span class="k">return</span> <span class="n">dd</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="labcore.data.datadict_storage.datadict_to_hdf5" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">datadict_to_hdf5</span><span class="p">(</span><span class="n">datadict</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">groupname</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">append_mode</span><span class="o">=</span><span class="n">AppendMode</span><span class="o">.</span><span class="n">new</span><span class="p">,</span> <span class="n">file_timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Write a DataDict to DDH5</p>
<p>Note: Meta data is only written during initial writing of the dataset.
If we're appending to existing datasets, we're not setting meta
data anymore.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>datadict</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="labcore.data.datadict.DataDict" href="#labcore.data.datadict.DataDict">DataDict</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Datadict to write to disk.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>path</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, <span title="pathlib.Path">Path</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Path of the file (extension may be omitted).</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>groupname</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of the top level group to store the data in.</p>
            </div>
          </td>
          <td>
                <code>&#39;data&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>append_mode</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="labcore.data.datadict_storage.AppendMode" href="#labcore.data.datadict_storage.AppendMode">AppendMode</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <ul>
<li><code>AppendMode.none</code> : Delete and re-create group. - <code>AppendMode.new</code> : Append rows in the datadict that exceed the number of existing rows in the dataset already stored. Note: we're not checking for content, only length!  - <code>AppendMode.all</code> : Append all data in datadict to file data sets.</li>
</ul>
            </div>
          </td>
          <td>
                <code><span title="labcore.data.datadict_storage.AppendMode.new">new</span></code>
          </td>
        </tr>
        <tr>
          <td><code>file_timeout</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[float]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>How long the function will wait for the ddh5 file to unlock. Only relevant if you are writing to a file that already exists and some other program is trying to read it at the same time. If none uses the default value from the :class:<code>FileOpener</code>.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict_storage.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="k">def</span><span class="w"> </span><span class="nf">datadict_to_hdf5</span><span class="p">(</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>    <span class="n">datadict</span><span class="p">:</span> <span class="n">DataDict</span><span class="p">,</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>    <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>    <span class="n">groupname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;data&quot;</span><span class="p">,</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>    <span class="n">append_mode</span><span class="p">:</span> <span class="n">AppendMode</span> <span class="o">=</span> <span class="n">AppendMode</span><span class="o">.</span><span class="n">new</span><span class="p">,</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>    <span class="n">file_timeout</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Write a DataDict to DDH5</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">    Note: Meta data is only written during initial writing of the dataset.</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">    If we&#39;re appending to existing datasets, we&#39;re not setting meta</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">    data anymore.</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">    :param datadict: Datadict to write to disk.</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">    :param path: Path of the file (extension may be omitted).</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">    :param groupname: Name of the top level group to store the data in.</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">    :param append_mode:</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">        - `AppendMode.none` : Delete and re-create group.</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">        - `AppendMode.new` : Append rows in the datadict that exceed</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">          the number of existing rows in the dataset already stored.</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">          Note: we&#39;re not checking for content, only length!</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">        - `AppendMode.all` : Append all data in datadict to file data sets.</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">    :param file_timeout: How long the function will wait for the ddh5 file to unlock. Only relevant if you are</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">        writing to a file that already exists and some other program is trying to read it at the same time.</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">        If none uses the default value from the :class:`FileOpener`.</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>    <span class="n">filepath</span> <span class="o">=</span> <span class="n">_data_file_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">filepath</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>        <span class="n">append_mode</span> <span class="o">=</span> <span class="n">AppendMode</span><span class="o">.</span><span class="n">none</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>    <span class="k">with</span> <span class="n">FileOpener</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">file_timeout</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>        <span class="k">if</span> <span class="n">append_mode</span> <span class="ow">is</span> <span class="n">AppendMode</span><span class="o">.</span><span class="n">none</span><span class="p">:</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>            <span class="n">init_file</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">groupname</span><span class="p">)</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>        <span class="k">assert</span> <span class="n">groupname</span> <span class="ow">in</span> <span class="n">f</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>        <span class="n">grp</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="n">groupname</span><span class="p">]</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>        <span class="c1"># add top-level meta data.</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">datadict</span><span class="o">.</span><span class="n">meta_items</span><span class="p">(</span><span class="n">clean_keys</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>            <span class="n">set_attr</span><span class="p">(</span><span class="n">grp</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">datadict</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>            <span class="n">data</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="s2">&quot;values&quot;</span><span class="p">]</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>            <span class="n">shp</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>            <span class="n">nrows</span> <span class="o">=</span> <span class="n">shp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>            <span class="c1"># create new dataset, add axes and unit metadata</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>            <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">grp</span><span class="p">:</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>                <span class="n">maxshp</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="kc">None</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">shp</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>                <span class="n">ds</span> <span class="o">=</span> <span class="n">grp</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">maxshape</span><span class="o">=</span><span class="n">maxshp</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>                <span class="c1"># add meta data</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>                <span class="n">add_cur_time_attr</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>                <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;axes&quot;</span><span class="p">,</span> <span class="p">[]):</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>                    <span class="n">set_attr</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="s2">&quot;axes&quot;</span><span class="p">,</span> <span class="n">v</span><span class="p">[</span><span class="s2">&quot;axes&quot;</span><span class="p">])</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>                <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;unit&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>                    <span class="n">set_attr</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="s2">&quot;unit&quot;</span><span class="p">,</span> <span class="n">v</span><span class="p">[</span><span class="s2">&quot;unit&quot;</span><span class="p">])</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>                <span class="k">for</span> <span class="n">kk</span><span class="p">,</span> <span class="n">vv</span> <span class="ow">in</span> <span class="n">datadict</span><span class="o">.</span><span class="n">meta_items</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">clean_keys</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>                    <span class="n">set_attr</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">kk</span><span class="p">,</span> <span class="n">vv</span><span class="p">)</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>                <span class="n">ds</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>            <span class="c1"># if the dataset already exits, append data according to</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>            <span class="c1"># chosen append mode.</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>                <span class="n">ds</span> <span class="o">=</span> <span class="n">grp</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>                <span class="n">dslen</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>                <span class="k">if</span> <span class="n">append_mode</span> <span class="o">==</span> <span class="n">AppendMode</span><span class="o">.</span><span class="n">new</span><span class="p">:</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>                    <span class="n">newshp</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="n">nrows</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">shp</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>                    <span class="n">ds</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">newshp</span><span class="p">)</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>                    <span class="n">ds</span><span class="p">[</span><span class="n">dslen</span><span class="p">:]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">dslen</span><span class="p">:]</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>                <span class="k">elif</span> <span class="n">append_mode</span> <span class="o">==</span> <span class="n">AppendMode</span><span class="o">.</span><span class="n">all</span><span class="p">:</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>                    <span class="n">newshp</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="n">dslen</span> <span class="o">+</span> <span class="n">nrows</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">shp</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>                    <span class="n">ds</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">newshp</span><span class="p">)</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>                    <span class="n">ds</span><span class="p">[</span><span class="n">dslen</span><span class="p">:]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:]</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>                <span class="n">ds</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="labcore.data.datadict_storage.deh5ify" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">deh5ify</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Convert slightly mangled types back to more handy ones.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>obj</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Input object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Object</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict_storage.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="k">def</span><span class="w"> </span><span class="nf">deh5ify</span><span class="p">(</span><span class="n">obj</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert slightly mangled types back to more handy ones.</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">    :param obj: Input object.</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">    :return: Object</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="o">==</span> <span class="nb">bytes</span><span class="p">:</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;S&quot;</span><span class="p">:</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>    <span class="k">return</span> <span class="n">obj</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="labcore.data.datadict_storage.h5ify" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">h5ify</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Convert an object into something that we can assign to an HDF5 attribute.</p>
<p>Performs the following conversions:
- list/array of strings -&gt; numpy chararray of unicode type</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>obj</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Input object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Object, converted if necessary.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict_storage.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span>
<span class="normal"><a href="#__codelineno-0-89">89</a></span>
<span class="normal"><a href="#__codelineno-0-90">90</a></span>
<span class="normal"><a href="#__codelineno-0-91">91</a></span>
<span class="normal"><a href="#__codelineno-0-92">92</a></span>
<span class="normal"><a href="#__codelineno-0-93">93</a></span>
<span class="normal"><a href="#__codelineno-0-94">94</a></span>
<span class="normal"><a href="#__codelineno-0-95">95</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="k">def</span><span class="w"> </span><span class="nf">h5ify</span><span class="p">(</span><span class="n">obj</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">    Convert an object into something that we can assign to an HDF5 attribute.</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">    Performs the following conversions:</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">    - list/array of strings -&gt; numpy chararray of unicode type</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">    :param obj: Input object.</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">    :return: Object, converted if necessary.</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>        <span class="n">all_string</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>        <span class="k">for</span> <span class="n">elt</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">elt</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>                <span class="n">all_string</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>                <span class="k">break</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">all_string</span><span class="p">:</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>            <span class="n">obj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;U&quot;</span><span class="p">:</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="k">return</span> <span class="n">obj</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="labcore.data.datadict_storage.load_as_xr" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">load_as_xr</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">fn</span><span class="o">=</span><span class="s1">&#39;data.ddh5&#39;</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Load ddh5 data as xarray (only for gridable data).</p>
<h4 id="labcore.data.datadict_storage.load_as_xr--parameters">Parameters</h4>
<p>folder :
    data folder
fn : str, optional
    filename, by default 'data.ddh5'</p>
<h4 id="labcore.data.datadict_storage.load_as_xr--returns">Returns</h4>
<p><em>type</em>
    <em>description</em></p>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict_storage.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-861">861</a></span>
<span class="normal"><a href="#__codelineno-0-862">862</a></span>
<span class="normal"><a href="#__codelineno-0-863">863</a></span>
<span class="normal"><a href="#__codelineno-0-864">864</a></span>
<span class="normal"><a href="#__codelineno-0-865">865</a></span>
<span class="normal"><a href="#__codelineno-0-866">866</a></span>
<span class="normal"><a href="#__codelineno-0-867">867</a></span>
<span class="normal"><a href="#__codelineno-0-868">868</a></span>
<span class="normal"><a href="#__codelineno-0-869">869</a></span>
<span class="normal"><a href="#__codelineno-0-870">870</a></span>
<span class="normal"><a href="#__codelineno-0-871">871</a></span>
<span class="normal"><a href="#__codelineno-0-872">872</a></span>
<span class="normal"><a href="#__codelineno-0-873">873</a></span>
<span class="normal"><a href="#__codelineno-0-874">874</a></span>
<span class="normal"><a href="#__codelineno-0-875">875</a></span>
<span class="normal"><a href="#__codelineno-0-876">876</a></span>
<span class="normal"><a href="#__codelineno-0-877">877</a></span>
<span class="normal"><a href="#__codelineno-0-878">878</a></span>
<span class="normal"><a href="#__codelineno-0-879">879</a></span>
<span class="normal"><a href="#__codelineno-0-880">880</a></span>
<span class="normal"><a href="#__codelineno-0-881">881</a></span>
<span class="normal"><a href="#__codelineno-0-882">882</a></span>
<span class="normal"><a href="#__codelineno-0-883">883</a></span>
<span class="normal"><a href="#__codelineno-0-884">884</a></span>
<span class="normal"><a href="#__codelineno-0-885">885</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-861" name="__codelineno-0-861"></a><span class="k">def</span><span class="w"> </span><span class="nf">load_as_xr</span><span class="p">(</span>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a>    <span class="n">folder</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">fn</span><span class="o">=</span><span class="s2">&quot;data.ddh5&quot;</span><span class="p">,</span> <span class="n">fields</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Load ddh5 data as xarray (only for gridable data).</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a><span class="sd">    folder :</span>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a><span class="sd">        data folder</span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a><span class="sd">    fn : str, optional</span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a><span class="sd">        filename, by default &#39;data.ddh5&#39;</span>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a><span class="sd">    -------</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a><span class="sd">    _type_</span>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a><span class="sd">        _description_</span>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a>    <span class="n">fn</span> <span class="o">=</span> <span class="n">folder</span> <span class="o">/</span> <span class="n">fn</span>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a>    <span class="n">dd</span> <span class="o">=</span> <span class="n">datadict_from_hdf5</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a>    <span class="k">if</span> <span class="n">fields</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a>        <span class="n">dd</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a>    <span class="n">xrdata</span> <span class="o">=</span> <span class="n">split_complex</span><span class="p">(</span><span class="n">dd2xr</span><span class="p">(</span><span class="n">datadict_to_meshgrid</span><span class="p">(</span><span class="n">dd</span><span class="p">)))</span>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a>    <span class="n">xrdata</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;raw_data_folder&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">folder</span><span class="o">.</span><span class="n">resolve</span><span class="p">())</span>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a>    <span class="n">xrdata</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;raw_data_fn&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a>    <span class="k">return</span> <span class="n">xrdata</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="labcore.data.datadict_storage.reconstruct_safe_write_data" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">reconstruct_safe_write_data</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">unification_from_scratch</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">file_timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Creates a new DataDict from the data saved in the .tmp folder. This is used when the data is saved in the safe
writing mode. The data is saved in individual files in the .tmp folder. This function reconstructs the data from
these files and returns a DataDict with the data.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>path</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, <span title="pathlib.Path">Path</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the folder containing the .tmp path</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>unification_from_scratch</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, will reconstruct the data from scratch. If False, will try to load the data from the last reconstructed file.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>file_timeout</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[float]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>How long the function will wait for the ddh5 file to unlock. If none uses the default value</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict_storage.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-367" name="__codelineno-0-367"></a><span class="k">def</span><span class="w"> </span><span class="nf">reconstruct_safe_write_data</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>                          <span class="n">unification_from_scratch</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>                          <span class="n">file_timeout</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataDictBase</span><span class="p">:</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="sd">    Creates a new DataDict from the data saved in the .tmp folder. This is used when the data is saved in the safe</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a><span class="sd">    writing mode. The data is saved in individual files in the .tmp folder. This function reconstructs the data from</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="sd">    these files and returns a DataDict with the data.</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a><span class="sd">    :param path: The path to the folder containing the .tmp path</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a><span class="sd">    :param unification_from_scratch: If True, will reconstruct the data from scratch. If False, will try to load the</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a><span class="sd">        data from the last reconstructed file.</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a><span class="sd">    :param file_timeout: How long the function will wait for the ddh5 file to unlock. If none uses the default value</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>    <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>    <span class="n">tmp_path</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">&quot;.tmp&quot;</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>    <span class="c1"># FIXME: This should probably raise a warning more than a crash, but will leave it as crash for now</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">tmp_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Specified folder does not exist.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>    <span class="n">files</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>    <span class="k">for</span> <span class="n">dirpath</span><span class="p">,</span> <span class="n">dirnames</span><span class="p">,</span> <span class="n">filenames</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">tmp_path</span><span class="p">)):</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>        <span class="n">files</span><span class="o">.</span><span class="n">extend</span><span class="p">([(</span><span class="n">Path</span><span class="p">(</span><span class="n">dirpath</span><span class="p">)</span><span class="o">/</span><span class="n">file</span><span class="p">)</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">filenames</span> <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.ddh5&quot;</span><span class="p">)])</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>    <span class="n">files</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">stem</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>    <span class="c1"># Checks if data is already there.</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>    <span class="c1"># If there is, loads it from the latest loaded file not to have to load unnecessary data</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>    <span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">unification_from_scratch</span><span class="p">:</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>        <span class="n">dd</span> <span class="o">=</span> <span class="n">datadict_from_hdf5</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">file_timeout</span><span class="o">=</span><span class="n">file_timeout</span><span class="p">)</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">dd</span><span class="o">.</span><span class="n">has_meta</span><span class="p">(</span><span class="s2">&quot;last_reconstructed_file&quot;</span><span class="p">):</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The file does not have the meta data &#39;last_reconstructed_file&#39;, &quot;</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>                             <span class="s2">&quot;could not know where to reconstruct from.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>        <span class="n">last_reconstructed_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">dd</span><span class="o">.</span><span class="n">meta_val</span><span class="p">(</span><span class="s2">&quot;last_reconstructed_file&quot;</span><span class="p">))</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">last_reconstructed_file</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="ow">or</span> <span class="n">last_reconstructed_file</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;When reconstructing the data, could find the last reconstructed file. &quot;</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>                             <span class="s2">&quot;This indicates that something wrong happened in the tmp folder.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>        <span class="n">starting_index</span> <span class="o">=</span> <span class="n">files</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">last_reconstructed_file</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>        <span class="n">first</span> <span class="o">=</span> <span class="n">files</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>        <span class="n">dd</span> <span class="o">=</span> <span class="n">datadict_from_hdf5</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">file_timeout</span><span class="o">=</span><span class="n">file_timeout</span><span class="p">)</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>        <span class="n">starting_index</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">[</span><span class="n">starting_index</span><span class="p">:]:</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>        <span class="n">d</span> <span class="o">=</span> <span class="n">datadict_from_hdf5</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">file_timeout</span><span class="o">=</span><span class="n">file_timeout</span><span class="p">)</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>        <span class="c1"># Create a dictionary with just the keys and values to add to the original one.</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>        <span class="n">dd</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">d</span><span class="o">.</span><span class="n">data_vals</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">data_items</span><span class="p">()})</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>    <span class="c1"># Add shape to axes</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">datavals</span> <span class="ow">in</span> <span class="n">dd</span><span class="o">.</span><span class="n">data_items</span><span class="p">():</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>        <span class="n">datavals</span><span class="p">[</span><span class="s2">&quot;__shape__&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datavals</span><span class="p">[</span><span class="s2">&quot;values&quot;</span><span class="p">][:])</span><span class="o">.</span><span class="n">shape</span><span class="p">,)</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>    <span class="c1"># Catches the edge case where there is a single file in the .tmp folder.</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>    <span class="c1"># This will not happen other than the first time, so it is ok to have that first variable there.</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>        <span class="n">dd</span><span class="o">.</span><span class="n">add_meta</span><span class="p">(</span><span class="s2">&quot;last_reconstructed_file&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">files</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>        <span class="n">dd</span><span class="o">.</span><span class="n">add_meta</span><span class="p">(</span><span class="s2">&quot;last_reconstructed_file&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">first</span><span class="p">))</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>    <span class="k">return</span> <span class="n">dd</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="labcore.data.datadict_storage.set_attr" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">set_attr</span><span class="p">(</span><span class="n">h5obj</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Set attribute <code>name</code> of object <code>h5obj</code> to <code>val</code></p>
<p>Use :func:<code>h5ify</code> to convert the object, then try to set the attribute
to the returned value. If that does not succeed due to a HDF5 typing
restriction, set the attribute to the string representation of the value.</p>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict_storage.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_attr</span><span class="p">(</span><span class="n">h5obj</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">val</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set attribute `name` of object `h5obj` to `val`</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">    Use :func:`h5ify` to convert the object, then try to set the attribute</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">    to the returned value. If that does not succeed due to a HDF5 typing</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">    restriction, set the attribute to the string representation of the value.</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="n">h5obj</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">h5ify</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="n">newval</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>        <span class="n">h5obj</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">h5ify</span><span class="p">(</span><span class="n">newval</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="labcore.data.datadict_storage.timestamp_from_path" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">timestamp_from_path</span><span class="p">(</span><span class="n">p</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Return a <code>datetime</code> timestamp from a standard-formatted path.
Assumes that the path stem has a timestamp that begins in ISO-like format
<code>YYYY-mm-ddTHHMMSS</code>.</p>

          <details class="quote">
            <summary>Source code in <code>labcore/data/datadict_storage.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-816">816</a></span>
<span class="normal"><a href="#__codelineno-0-817">817</a></span>
<span class="normal"><a href="#__codelineno-0-818">818</a></span>
<span class="normal"><a href="#__codelineno-0-819">819</a></span>
<span class="normal"><a href="#__codelineno-0-820">820</a></span>
<span class="normal"><a href="#__codelineno-0-821">821</a></span>
<span class="normal"><a href="#__codelineno-0-822">822</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-816" name="__codelineno-0-816"></a><span class="k">def</span><span class="w"> </span><span class="nf">timestamp_from_path</span><span class="p">(</span><span class="n">p</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">:</span>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a `datetime` timestamp from a standard-formatted path.</span>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a><span class="sd">    Assumes that the path stem has a timestamp that begins in ISO-like format</span>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a><span class="sd">    ``YYYY-mm-ddTHHMMSS``.</span>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a>    <span class="n">timestring</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">stem</span><span class="p">)[:</span><span class="mi">13</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">stem</span><span class="p">)[</span><span class="mi">13</span><span class="p">:</span><span class="mi">15</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">stem</span><span class="p">)[</span><span class="mi">15</span><span class="p">:</span><span class="mi">17</span><span class="p">]</span>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a>    <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromisoformat</span><span class="p">(</span><span class="n">timestring</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div><h3 id="extra-tools">Extra Tools</h3>


<div class="doc doc-object doc-module">



<a id="labcore.data.tools"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">




<h2 id="labcore.data.tools.Data" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">Data</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h2>


  <div class="doc doc-contents ">
  
      <p>Type alias for valid data. Can be either a pandas DataFrame or an xarray Dataset.</p>
  </div>

</div>




<div class="doc doc-object doc-function">




<h2 id="labcore.data.tools.split_complex" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">split_complex</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Split complex dependents into real and imaginary parts.</p>
<p>TODO: should update units as well</p>
<h4 id="labcore.data.tools.split_complex--parameters">Parameters</h4>
<p>data
    input data.</p>
<h4 id="labcore.data.tools.split_complex--returns">Returns</h4>
<p>data with complex dependents split into real and imaginary parts.</p>
<h4 id="labcore.data.tools.split_complex--raises">Raises</h4>
<p>NotImplementedError
    if data is not a pandas DataFrame or an xarray Dataset.</p>

          <details class="quote">
            <summary>Source code in <code>labcore/data/tools.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="k">def</span><span class="w"> </span><span class="nf">split_complex</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">Data</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Data</span><span class="p">:</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Split complex dependents into real and imaginary parts.</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    TODO: should update units as well</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">    data</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">        input data.</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">    -------</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">    data with complex dependents split into real and imaginary parts.</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">    Raises</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">    ------</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">    NotImplementedError</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">        if data is not a pandas DataFrame or an xarray Dataset.</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>    <span class="n">indep</span><span class="p">,</span> <span class="n">dep</span> <span class="o">=</span> <span class="n">data_dims</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">):</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>    <span class="n">dropped</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dep</span><span class="p">:</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">iscomplexobj</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">d</span><span class="p">]):</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>            <span class="n">data</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s2">_Re&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">d</span><span class="p">])</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>            <span class="n">data</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s2">_Im&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">d</span><span class="p">])</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">):</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>                <span class="n">data</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s2">_Re&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">d</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>                <span class="n">data</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s2">_Im&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">d</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>            <span class="n">dropped</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>        <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">dropped</span><span class="p">)</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>        <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">drop_vars</span><span class="p">(</span><span class="n">dropped</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; 2025 Marcos Frenkel, Wolfgang Pfaff, Cynthia Nolan

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.instant", "navigation.sections", "navigation.tracking", "navigation.top", "search.suggest", "search.highlight", "permalink"], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.aecac24b.min.js"></script>
      
    
  </body>
</html>